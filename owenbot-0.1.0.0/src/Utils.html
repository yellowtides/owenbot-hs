<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{-|
    Module:     : Utils
    Description : A module containing all sorts of useful macros and functions. The Appendix of owenbot.
-}</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Utils</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Utils.html#emojiToUsableText"><span class="hs-identifier">emojiToUsableText</span></a></span><span>
</span><span id="line-8"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageChan"><span class="hs-identifier">sendMessageChan</span></a></span><span>
</span><span id="line-9"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendReply"><span class="hs-identifier">sendReply</span></a></span><span>
</span><span id="line-10"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageChanEmbed"><span class="hs-identifier">sendMessageChanEmbed</span></a></span><span>
</span><span id="line-11"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageChanPingsDisabled"><span class="hs-identifier">sendMessageChanPingsDisabled</span></a></span><span>
</span><span id="line-12"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageDM"><span class="hs-identifier">sendMessageDM</span></a></span><span>
</span><span id="line-13"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendFileChan"><span class="hs-identifier">sendFileChan</span></a></span><span>
</span><span id="line-14"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#addReaction"><span class="hs-identifier">addReaction</span></a></span><span>
</span><span id="line-15"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#messageFromReaction"><span class="hs-identifier">messageFromReaction</span></a></span><span>
</span><span id="line-16"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingUser"><span class="hs-identifier">pingUser</span></a></span><span>
</span><span id="line-17"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingRole"><span class="hs-identifier">pingRole</span></a></span><span>
</span><span id="line-18"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingAuthorOf"><span class="hs-identifier">pingAuthorOf</span></a></span><span>
</span><span id="line-19"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingWithUsername"><span class="hs-identifier">pingWithUsername</span></a></span><span>
</span><span id="line-20"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#stripAllPings"><span class="hs-identifier">stripAllPings</span></a></span><span>
</span><span id="line-21"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#newCommand"><span class="hs-identifier">newCommand</span></a></span><span>
</span><span id="line-22"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#newDevCommand"><span class="hs-identifier">newDevCommand</span></a></span><span>
</span><span id="line-23"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#newModCommand"><span class="hs-identifier">newModCommand</span></a></span><span>
</span><span id="line-24"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#linkChannel"><span class="hs-identifier">linkChannel</span></a></span><span>
</span><span id="line-25"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#getMessageLink"><span class="hs-identifier">getMessageLink</span></a></span><span>
</span><span id="line-26"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#hasRoleByName"><span class="hs-identifier">hasRoleByName</span></a></span><span>
</span><span id="line-27"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#hasRoleByID"><span class="hs-identifier">hasRoleByID</span></a></span><span>
</span><span id="line-28"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#isMod"><span class="hs-identifier">isMod</span></a></span><span>
</span><span id="line-29"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#devIDs"><span class="hs-identifier">devIDs</span></a></span><span>
</span><span id="line-30"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#assetDir"><span class="hs-identifier">assetDir</span></a></span><span>
</span><span id="line-31"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#%3D~%3D"><span class="hs-operator">(=~=)</span></a></span><span>
</span><span id="line-32"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#getTimestampFromMessage"><span class="hs-identifier">getTimestampFromMessage</span></a></span><span>
</span><span id="line-33"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#captureCommandOutput"><span class="hs-identifier">captureCommandOutput</span></a></span><span>
</span><span id="line-34"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#update"><span class="hs-identifier">update</span></a></span><span>
</span><span id="line-35"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#snowflakeToInt"><span class="hs-identifier">snowflakeToInt</span></a></span><span>
</span><span id="line-36"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#moveChannel"><span class="hs-identifier">moveChannel</span></a></span><span>
</span><span id="line-37"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#isEmojiValid"><span class="hs-identifier">isEmojiValid</span></a></span><span>
</span><span id="line-38"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#isRoleInGuild"><span class="hs-identifier">isRoleInGuild</span></a></span><span>
</span><span id="line-39"></span><span>             </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Discord.Requests</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Discord.Types</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Discord</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span>
</span><span id="line-45"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOException</span></span><span>
</span><span id="line-46"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span>
</span><span id="line-48"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">join</span></span><span>
</span><span id="line-49"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span>
</span><span id="line-50"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">on</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.Split</span></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">splitOn</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Format</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TF</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Process</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExitCode</span></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExitSuccess</span></span><span>
</span><span id="line-59"></span><span>                                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ExitFailure</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">UnliftIO</span></span><span>               </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Regex.TDFA</span></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(=~)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Owoifier.html"><span class="hs-identifier">Owoifier</span></a></span><span>               </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Owoifier.html#owoify"><span class="hs-identifier">owoify</span></a></span><span>
</span><span id="line-66"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Owoifier.html#weakOwoify"><span class="hs-identifier">weakOwoify</span></a></span><span>
</span><span id="line-67"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="TemplateRE.html"><span class="hs-identifier">TemplateRE</span></a></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="TemplateRE.html#trailingWS"><span class="hs-identifier">trailingWS</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="CSV.html"><span class="hs-identifier">CSV</span></a></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="CSV.html#readSingleColCSV"><span class="hs-identifier">readSingleColCSV</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">isDigit</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | The `FilePath` to the configuration file listing OwenDev role IDs.</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Utils.html#devIDs"><span class="hs-identifier hs-type">devIDs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-77"></span><span id="devIDs"><span class="annot"><span class="annottext">devIDs :: FilePath
</span><a href="Utils.html#devIDs"><span class="hs-identifier hs-var hs-var">devIDs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;devs.csv&quot;</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | The `FilePath` representing the repo for the bot.</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- TODO: chuck in a config file, handle not having a repo</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Utils.html#repoDir"><span class="hs-identifier hs-type">repoDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-82"></span><span id="repoDir"><span class="annot"><span class="annottext">repoDir :: FilePath
</span><a href="Utils.html#repoDir"><span class="hs-identifier hs-var hs-var">repoDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;$HOME/owenbot-hs/&quot;</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | The `FilePath` representing the location of the assets.</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- TODO: Move to configDir</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Utils.html#assetDir"><span class="hs-identifier hs-type">assetDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-87"></span><span id="assetDir"><span class="annot"><span class="annottext">assetDir :: FilePath
</span><a href="Utils.html#assetDir"><span class="hs-identifier hs-var hs-var">assetDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Utils.html#repoDir"><span class="hs-identifier hs-var">repoDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;src/assets/&quot;</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | The `(=~=)` function matches a given `Text` again a regex. Case-less in terms of owoifying.</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Utils.html#%3D~%3D"><span class="hs-operator hs-type">(=~=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-91"></span><span id="%3D~%3D"><span class="annot"><span class="annottext">=~= :: Text -&gt; Text -&gt; Bool
</span><a href="Utils.html#%3D~%3D"><span class="hs-operator hs-var hs-var">(=~=)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><span class="hs-operator hs-var">(=~)</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Bool) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#weakOwoify"><span class="hs-identifier hs-var">weakOwoify</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | `pingUser` constructs a minimal `Text` pinging the given user.</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Utils.html#pingUser"><span class="hs-identifier hs-type">pingUser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">User</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-95"></span><span id="pingUser"><span class="annot"><span class="annottext">pingUser :: User -&gt; Text
</span><a href="Utils.html#pingUser"><span class="hs-identifier hs-var hs-var">pingUser</span></a></span></span><span> </span><span id="local-6989586621679186138"><span class="annot"><span class="annottext">u :: User
</span><a href="#local-6989586621679186138"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="hs-string">&quot;&lt;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; FilePath) -&gt; UserId -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679186138"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | `pingRole` constructs a minimal `Text` pinging the given role id.</span><span>
</span><span id="line-98"></span><span class="annot"><a href="Utils.html#pingRole"><span class="hs-identifier hs-type">pingRole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-99"></span><span id="pingRole"><span class="annot"><span class="annottext">pingRole :: UserId -&gt; Text
</span><a href="Utils.html#pingRole"><span class="hs-identifier hs-var hs-var">pingRole</span></a></span></span><span> </span><span id="local-6989586621679186133"><span class="annot"><span class="annottext">r :: UserId
</span><a href="#local-6989586621679186133"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&lt;@&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186133"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | `pingAuthorOf` constructs a minimal `Text` pinging the author of a given message.</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Utils.html#pingAuthorOf"><span class="hs-identifier hs-type">pingAuthorOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-103"></span><span id="pingAuthorOf"><span class="annot"><span class="annottext">pingAuthorOf :: Message -&gt; Text
</span><a href="Utils.html#pingAuthorOf"><span class="hs-identifier hs-var hs-var">pingAuthorOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">User -&gt; Text
</span><a href="Utils.html#pingUser"><span class="hs-identifier hs-var">pingUser</span></a></span><span> </span><span class="annot"><span class="annottext">(User -&gt; Text) -&gt; (Message -&gt; User) -&gt; Message -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | `pingWithUsername` constructs a minimal `Text` pinging the the user with the given</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- username from the given guild. On failure, returns an empty Text. On multiple such</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- users, returns an empty Text.</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Utils.html#pingWithUsername"><span class="hs-identifier hs-type">pingWithUsername</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-109"></span><span id="pingWithUsername"><span class="annot"><span class="annottext">pingWithUsername :: Text -&gt; UserId -&gt; DiscordHandler Text
</span><a href="Utils.html#pingWithUsername"><span class="hs-identifier hs-var hs-var">pingWithUsername</span></a></span></span><span> </span><span id="local-6989586621679186129"><span class="annot"><span class="annottext">uname :: Text
</span><a href="#local-6989586621679186129"><span class="hs-identifier hs-var">uname</span></a></span></span><span> </span><span id="local-6989586621679186128"><span class="annot"><span class="annottext">gid :: UserId
</span><a href="#local-6989586621679186128"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186127"><span class="annot"><span class="annottext">timing :: GuildMembersTiming
</span><a href="#local-6989586621679186127"><span class="hs-identifier hs-var hs-var">timing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Maybe UserId -&gt; GuildMembersTiming
</span><span class="hs-identifier hs-var">R.GuildMembersTiming</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="hs-number">1000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe UserId
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">-- number of users to fetch, maximum is 1000</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- &quot;Nothing&quot; seems to default to (Just 1)</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679186125"><span class="annot"><span class="annottext">Either RestCallErrorCode [GuildMember]
</span><a href="#local-6989586621679186125"><span class="hs-identifier hs-var">membersM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GuildRequest [GuildMember]
-&gt; DiscordHandler (Either RestCallErrorCode [GuildMember])
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest [GuildMember]
 -&gt; DiscordHandler (Either RestCallErrorCode [GuildMember]))
-&gt; GuildRequest [GuildMember]
-&gt; DiscordHandler (Either RestCallErrorCode [GuildMember])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; GuildMembersTiming -&gt; GuildRequest [GuildMember]
</span><span class="hs-identifier hs-var">R.ListGuildMembers</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186128"><span class="hs-identifier hs-var">gid</span></a></span><span> </span><span class="annot"><span class="annottext">GuildMembersTiming
</span><a href="#local-6989586621679186127"><span class="hs-identifier hs-var">timing</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186122"><span class="annot"><span class="annottext">members :: [GuildMember]
</span><a href="#local-6989586621679186122"><span class="hs-identifier hs-var hs-var">members</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either RestCallErrorCode [GuildMember]
</span><a href="#local-6989586621679186125"><span class="hs-identifier hs-var">membersM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679186121"><span class="annot"><span class="annottext">success :: [GuildMember]
</span><a href="#local-6989586621679186121"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GuildMember]
</span><a href="#local-6989586621679186121"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-116"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186120"><span class="annot"><span class="annottext">users :: [User]
</span><a href="#local-6989586621679186120"><span class="hs-identifier hs-var hs-var">users</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GuildMember -&gt; User
</span><span class="hs-identifier hs-var hs-var">memberUser</span></span><span> </span><span class="annot"><span class="annottext">(GuildMember -&gt; User) -&gt; [GuildMember] -&gt; [User]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[GuildMember]
</span><a href="#local-6989586621679186122"><span class="hs-identifier hs-var">members</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">--_ &lt;- liftIO $ print (userName &lt;$&gt; users)</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186117"><span class="annot"><span class="annottext">usersWithUsername :: [User]
</span><a href="#local-6989586621679186117"><span class="hs-identifier hs-var hs-var">usersWithUsername</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(User -&gt; Bool) -&gt; [User] -&gt; [User]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679186116"><span class="annot"><span class="annottext">u :: User
</span><a href="#local-6989586621679186116"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">User -&gt; Text
</span><span class="hs-identifier hs-var hs-var">userName</span></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679186116"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186129"><span class="hs-identifier hs-var">uname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679186120"><span class="hs-identifier hs-var">users</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">--_ &lt;- liftIO $ print usersWithUsername</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; DiscordHandler Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler Text) -&gt; Text -&gt; DiscordHandler Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679186117"><span class="hs-identifier hs-var">usersWithUsername</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679186114"><span class="annot"><span class="annottext">u :: User
</span><a href="#local-6989586621679186114"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">User -&gt; Text
</span><a href="Utils.html#pingUser"><span class="hs-identifier hs-var">pingUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679186114"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | `isUnicodeEmoji` determines whether a provided character is a unicode emoji.</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- Really weak check.</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Utils.html#isUnicodeEmoji"><span class="hs-identifier hs-type">isUnicodeEmoji</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-129"></span><span id="isUnicodeEmoji"><span class="annot"><span class="annottext">isUnicodeEmoji :: Text -&gt; Bool
</span><a href="Utils.html#isUnicodeEmoji"><span class="hs-identifier hs-var hs-var">isUnicodeEmoji</span></a></span></span><span> </span><span id="local-6989586621679186112"><span class="annot"><span class="annottext">emojiT :: Text
</span><a href="#local-6989586621679186112"><span class="hs-identifier hs-var">emojiT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679186110"><span class="hs-identifier hs-var">isInEmojiBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186112"><span class="hs-identifier hs-var">emojiT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679186110"><span class="annot"><span class="annottext">isInEmojiBlock :: Char -&gt; Bool
</span><a href="#local-6989586621679186110"><span class="hs-identifier hs-var hs-var">isInEmojiBlock</span></a></span></span><span> </span><span id="local-6989586621679186107"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679186107"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679186107"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="hs-char">'\x00A9'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679186107"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-char">'\x1FADF'</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | `isRoleInGuild` determines whether a role containing the given text exists</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- in the guild (case insensitive). If it does, then it returns the role's ID.</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- Otherwise, `Nothing` is returned.</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Utils.html#isRoleInGuild"><span class="hs-identifier hs-type">isRoleInGuild</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="isRoleInGuild"><span class="annot"><span class="annottext">isRoleInGuild :: Text -&gt; UserId -&gt; DiscordHandler (Maybe UserId)
</span><a href="Utils.html#isRoleInGuild"><span class="hs-identifier hs-var hs-var">isRoleInGuild</span></a></span></span><span> </span><span id="local-6989586621679186104"><span class="annot"><span class="annottext">roleFragment :: Text
</span><a href="#local-6989586621679186104"><span class="hs-identifier hs-var">roleFragment</span></a></span></span><span> </span><span id="local-6989586621679186103"><span class="annot"><span class="annottext">gid :: UserId
</span><a href="#local-6989586621679186103"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679186102"><span class="annot"><span class="annottext">roles :: [Role]
</span><a href="#local-6989586621679186102"><span class="hs-identifier hs-var">roles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GuildRequest [Role]
-&gt; DiscordHandler (Either RestCallErrorCode [Role])
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest [Role]
 -&gt; DiscordHandler (Either RestCallErrorCode [Role]))
-&gt; GuildRequest [Role]
-&gt; DiscordHandler (Either RestCallErrorCode [Role])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; GuildRequest [Role]
</span><span class="hs-identifier hs-var">R.GetGuildRoles</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186103"><span class="hs-identifier hs-var">gid</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186100"><span class="annot"><span class="annottext">matchingRoles :: [Role]
</span><a href="#local-6989586621679186100"><span class="hs-identifier hs-var hs-var">matchingRoles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Role -&gt; Bool) -&gt; [Role] -&gt; [Role]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679186099"><span class="annot"><span class="annottext">role :: Role
</span><a href="#local-6989586621679186099"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186104"><span class="hs-identifier hs-var">roleFragment</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isInfixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Text
</span><span class="hs-identifier hs-var hs-var">roleName</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679186099"><span class="hs-keyword hs-var">role</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679186102"><span class="hs-identifier hs-var">roles</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">Maybe UserId -&gt; DiscordHandler (Maybe UserId)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe UserId -&gt; DiscordHandler (Maybe UserId))
-&gt; Maybe UserId -&gt; DiscordHandler (Maybe UserId)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679186100"><span class="hs-identifier hs-var">matchingRoles</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe UserId
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-142"></span><span>        </span><span id="local-6989586621679186095"><span class="annot"><span class="annottext">role :: Role
</span><a href="#local-6989586621679186095"><span class="hs-keyword hs-var">role</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679186094"><span class="annot"><span class="annottext">rs :: [Role]
</span><a href="#local-6989586621679186094"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Maybe UserId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Maybe UserId) -&gt; UserId -&gt; Maybe UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">roleId</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679186095"><span class="hs-keyword hs-var">role</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | `discordEmojiTextToId` takes a Discord &lt;::0-9&gt; formatted emoji string and extracts the ID.</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Utils.html#discordEmojiTextToId"><span class="hs-identifier hs-type">discordEmojiTextToId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmojiId</span></span><span>
</span><span id="line-146"></span><span id="discordEmojiTextToId"><span class="annot"><span class="annottext">discordEmojiTextToId :: Text -&gt; UserId
</span><a href="Utils.html#discordEmojiTextToId"><span class="hs-identifier hs-var hs-var">discordEmojiTextToId</span></a></span></span><span> </span><span id="local-6989586621679186090"><span class="annot"><span class="annottext">emojiT :: Text
</span><a href="#local-6989586621679186090"><span class="hs-identifier hs-var">emojiT</span></a></span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FilePath) -&gt; (Text -&gt; Text) -&gt; Text -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.takeWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-148"></span><span>                    </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FilePath) -&gt; Text -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186090"><span class="hs-identifier hs-var">emojiT</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-string">&quot;&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-150"></span><span>            </span><span id="local-6989586621679186085"><span class="annot"><span class="annottext">num :: FilePath
</span><a href="#local-6989586621679186085"><span class="hs-identifier hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; UserId
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186085"><span class="hs-identifier hs-var">num</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | `isEmojiValid` determines whether an emoji (provided in Discord &lt;::0-9&gt; format) exists in the</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- guild (or is a default emoji). Case insensitive.</span><span>
</span><span id="line-154"></span><span class="annot"><a href="Utils.html#isEmojiValid"><span class="hs-identifier hs-type">isEmojiValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-155"></span><span id="isEmojiValid"><span class="annot"><span class="annottext">isEmojiValid :: Text -&gt; UserId -&gt; DiscordHandler Bool
</span><a href="Utils.html#isEmojiValid"><span class="hs-identifier hs-var hs-var">isEmojiValid</span></a></span></span><span> </span><span id="local-6989586621679186083"><span class="annot"><span class="annottext">emojiT :: Text
</span><a href="#local-6989586621679186083"><span class="hs-identifier hs-var">emojiT</span></a></span></span><span> </span><span id="local-6989586621679186082"><span class="annot"><span class="annottext">gid :: UserId
</span><a href="#local-6989586621679186082"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679186081"><span class="annot"><span class="annottext">guild :: Guild
</span><a href="#local-6989586621679186081"><span class="hs-identifier hs-var">guild</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GuildRequest Guild
-&gt; DiscordHandler (Either RestCallErrorCode Guild)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest Guild
 -&gt; DiscordHandler (Either RestCallErrorCode Guild))
-&gt; GuildRequest Guild
-&gt; DiscordHandler (Either RestCallErrorCode Guild)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; GuildRequest Guild
</span><span class="hs-identifier hs-var">R.GetGuild</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186082"><span class="hs-identifier hs-var">gid</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186079"><span class="annot"><span class="annottext">emojis :: [Emoji]
</span><a href="#local-6989586621679186079"><span class="hs-identifier hs-var hs-var">emojis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Guild -&gt; [Emoji]
</span><span class="hs-identifier hs-var hs-var">guildEmojis</span></span><span> </span><span class="annot"><span class="annottext">Guild
</span><a href="#local-6989586621679186081"><span class="hs-identifier hs-var">guild</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186077"><span class="annot"><span class="annottext">emojiTID :: UserId
</span><a href="#local-6989586621679186077"><span class="hs-identifier hs-var hs-var">emojiTID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; UserId
</span><a href="Utils.html#discordEmojiTextToId"><span class="hs-identifier hs-var">discordEmojiTextToId</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186083"><span class="hs-identifier hs-var">emojiT</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186076"><span class="annot"><span class="annottext">matchingEmojis :: [Emoji]
</span><a href="#local-6989586621679186076"><span class="hs-identifier hs-var hs-var">matchingEmojis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Emoji -&gt; Bool) -&gt; [Emoji] -&gt; [Emoji]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679186075"><span class="annot"><span class="annottext">emoji :: Emoji
</span><a href="#local-6989586621679186075"><span class="hs-identifier hs-var">emoji</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186077"><span class="hs-identifier hs-var">emojiTID</span></a></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe UserId -&gt; UserId
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Emoji -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">emojiId</span></span><span> </span><span class="annot"><span class="annottext">Emoji
</span><a href="#local-6989586621679186075"><span class="hs-identifier hs-var">emoji</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Emoji]
</span><a href="#local-6989586621679186079"><span class="hs-identifier hs-var">emojis</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- _ &lt;- liftIO $ print matchingEmojis</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-comment">-- _ &lt;- liftIO $ print emojiTID</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186073"><span class="annot"><span class="annottext">isInvalid :: Bool
</span><a href="#local-6989586621679186073"><span class="hs-identifier hs-var hs-var">isInvalid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186083"><span class="hs-identifier hs-var">emojiT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Emoji]
</span><a href="#local-6989586621679186076"><span class="hs-identifier hs-var">matchingEmojis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>            </span><span class="hs-special">(</span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-164"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="Utils.html#isUnicodeEmoji"><span class="hs-identifier hs-var">isUnicodeEmoji</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186083"><span class="hs-identifier hs-var">emojiT</span></a></span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; DiscordHandler Bool)
-&gt; (Bool -&gt; Bool) -&gt; Bool -&gt; DiscordHandler Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; DiscordHandler Bool) -&gt; Bool -&gt; DiscordHandler Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679186073"><span class="hs-identifier hs-var">isInvalid</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | `converge` applies a function to a variable until the result converges.</span><span>
</span><span id="line-169"></span><span id="local-6989586621679186246"><span class="annot"><a href="Utils.html#converge"><span class="hs-identifier hs-type">converge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679186246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679186246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679186246"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679186246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679186246"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-170"></span><span id="converge"><span class="annot"><span class="annottext">converge :: (a -&gt; a) -&gt; a -&gt; a
</span><a href="Utils.html#converge"><span class="hs-identifier hs-var hs-var">converge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a -&gt; Bool) -&gt; a -&gt; Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; a -&gt; Bool)
-&gt; ((a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">until</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | `stripAllPings` removes all pings from a given `Text` message.</span><span>
</span><span id="line-173"></span><span class="annot"><a href="Utils.html#stripAllPings"><span class="hs-identifier hs-type">stripAllPings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-174"></span><span id="stripAllPings"><span class="annot"><span class="annottext">stripAllPings :: Text -&gt; Text
</span><a href="Utils.html#stripAllPings"><span class="hs-identifier hs-var hs-var">stripAllPings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (Text -&gt; FilePath) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a. Eq a =&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Utils.html#converge"><span class="hs-identifier hs-var">converge</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679186069"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; (Text -&gt; FilePath) -&gt; Text -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><a href="#local-6989586621679186068"><span class="hs-identifier hs-type">pingRE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-177"></span><span>        </span><span id="local-6989586621679186068"><span class="annot"><span class="annottext">pingRE :: FilePath
</span><a href="#local-6989586621679186068"><span class="hs-identifier hs-var hs-var">pingRE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;^@[&amp;!]?[0-9]{8,}&gt;&quot;</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="#local-6989586621679186069"><span class="hs-identifier hs-type">stripOnePing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-179"></span><span>        </span><span id="local-6989586621679186069"><span class="annot"><span class="annottext">stripOnePing :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679186069"><span class="hs-identifier hs-var hs-var">stripOnePing</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><a href="#local-6989586621679186069"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679186066"><span class="annot"><span class="annottext">ch :: Char
</span><a href="#local-6989586621679186066"><span class="hs-identifier hs-var">ch</span></a></span></span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679186066"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><a href="#local-6989586621679186069"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-char">'&lt;'</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679186065"><span class="annot"><span class="annottext">xs :: FilePath
</span><a href="#local-6989586621679186065"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186065"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><span class="hs-operator hs-var">=~</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186068"><span class="hs-identifier hs-var">pingRE</span></a></span><span>
</span><span id="line-182"></span><span>                                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath -&gt; FilePath
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-char">'&gt;'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186065"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-183"></span><span>                                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-char">'&lt;'</span></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186065"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="#local-6989586621679186069"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679186062"><span class="annot"><span class="annottext">x :: Char
</span><a href="#local-6989586621679186062"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679186061"><span class="annot"><span class="annottext">xs :: FilePath
</span><a href="#local-6989586621679186061"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679186062"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679186069"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186061"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | `linkChannel` constructs a minimal `Text` linking the channel with the provided ID.</span><span>
</span><span id="line-187"></span><span class="annot"><a href="Utils.html#linkChannel"><span class="hs-identifier hs-type">linkChannel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-188"></span><span id="linkChannel"><span class="annot"><span class="annottext">linkChannel :: UserId -&gt; Text
</span><a href="Utils.html#linkChannel"><span class="hs-identifier hs-var hs-var">linkChannel</span></a></span></span><span> </span><span id="local-6989586621679186059"><span class="annot"><span class="annottext">c :: UserId
</span><a href="#local-6989586621679186059"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&lt;#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186059"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | `getMessageLink` attempts to construct the Discord URL of the given message, as a `Text`.</span><span>
</span><span id="line-191"></span><span class="annot"><a href="Utils.html#getMessageLink"><span class="hs-identifier hs-type">getMessageLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RestCallErrorCode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span id="getMessageLink"><span class="annot"><span class="annottext">getMessageLink :: Message -&gt; DiscordHandler (Either RestCallErrorCode Text)
</span><a href="Utils.html#getMessageLink"><span class="hs-identifier hs-var hs-var">getMessageLink</span></a></span></span><span> </span><span id="local-6989586621679186058"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679186058"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679186057"><span class="annot"><span class="annottext">Either RestCallErrorCode Channel
</span><a href="#local-6989586621679186057"><span class="hs-identifier hs-var">chanM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ChannelRequest Channel
-&gt; DiscordHandler (Either RestCallErrorCode Channel)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(ChannelRequest Channel
 -&gt; DiscordHandler (Either RestCallErrorCode Channel))
-&gt; ChannelRequest Channel
-&gt; DiscordHandler (Either RestCallErrorCode Channel)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; ChannelRequest Channel
</span><span class="hs-identifier hs-var">R.GetChannel</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679186058"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either RestCallErrorCode Channel
</span><a href="#local-6989586621679186057"><span class="hs-identifier hs-var">chanM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679186054"><span class="annot"><span class="annottext">chan :: Channel
</span><a href="#local-6989586621679186054"><span class="hs-identifier hs-var">chan</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>            </span><span class="hs-comment">-- the ID of the server containing the channel, as a `Text`</span><span>
</span><span id="line-197"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186053"><span class="annot"><span class="annottext">serverIDT :: Text
</span><a href="#local-6989586621679186053"><span class="hs-identifier hs-var hs-var">serverIDT</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (UserId -&gt; FilePath) -&gt; UserId -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Text) -&gt; UserId -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Channel -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">channelGuild</span></span><span> </span><span class="annot"><span class="annottext">Channel
</span><a href="#local-6989586621679186054"><span class="hs-identifier hs-var">chan</span></a></span><span>
</span><span id="line-198"></span><span>            </span><span class="hs-comment">-- the ID of the channel the message was sent in, as a `Text`</span><span>
</span><span id="line-199"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186051"><span class="annot"><span class="annottext">channelIDT :: Text
</span><a href="#local-6989586621679186051"><span class="hs-identifier hs-var hs-var">channelIDT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (UserId -&gt; FilePath) -&gt; UserId -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Text) -&gt; UserId -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679186058"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-200"></span><span>            </span><span class="hs-comment">-- the messageID, as a `Text`</span><span>
</span><span id="line-201"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186050"><span class="annot"><span class="annottext">messageIDT :: Text
</span><a href="#local-6989586621679186050"><span class="hs-identifier hs-var hs-var">messageIDT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (UserId -&gt; FilePath) -&gt; UserId -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Text) -&gt; UserId -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageId</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679186058"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-202"></span><span>            </span><span class="annot"><span class="annottext">Either RestCallErrorCode Text
-&gt; DiscordHandler (Either RestCallErrorCode Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either RestCallErrorCode Text
 -&gt; DiscordHandler (Either RestCallErrorCode Text))
-&gt; (Text -&gt; Either RestCallErrorCode Text)
-&gt; Text
-&gt; DiscordHandler (Either RestCallErrorCode Text)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either RestCallErrorCode Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler (Either RestCallErrorCode Text))
-&gt; Text -&gt; DiscordHandler (Either RestCallErrorCode Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;https://discord.com/channels/&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-203"></span><span>                                      </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186053"><span class="hs-identifier hs-var">serverIDT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;/&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-204"></span><span>                                      </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186051"><span class="hs-identifier hs-var">channelIDT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;/&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>                                      </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186050"><span class="hs-identifier hs-var">messageIDT</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679186047"><span class="annot"><span class="annottext">err :: RestCallErrorCode
</span><a href="#local-6989586621679186047"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either RestCallErrorCode Text
-&gt; DiscordHandler (Either RestCallErrorCode Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either RestCallErrorCode Text
 -&gt; DiscordHandler (Either RestCallErrorCode Text))
-&gt; Either RestCallErrorCode Text
-&gt; DiscordHandler (Either RestCallErrorCode Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RestCallErrorCode -&gt; Either RestCallErrorCode Text
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">RestCallErrorCode
</span><a href="#local-6989586621679186047"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | `emojiToUsableText` converts a given emoji to a text which can be used to display it in Discord.</span><span>
</span><span id="line-209"></span><span class="annot"><a href="Utils.html#emojiToUsableText"><span class="hs-identifier hs-type">emojiToUsableText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Emoji</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-210"></span><span id="emojiToUsableText"><span class="annot"><span class="annottext">emojiToUsableText :: Emoji -&gt; Text
</span><a href="Utils.html#emojiToUsableText"><span class="hs-identifier hs-var hs-var">emojiToUsableText</span></a></span></span><span> </span><span id="local-6989586621679186046"><span class="annot"><span class="annottext">r :: Emoji
</span><a href="#local-6989586621679186046"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186045"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679186045"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Emoji -&gt; Text
</span><span class="hs-identifier hs-var hs-var">emojiName</span></span><span> </span><span class="annot"><span class="annottext">Emoji
</span><a href="#local-6989586621679186046"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Emoji -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">emojiId</span></span><span> </span><span class="annot"><span class="annottext">Emoji
</span><a href="#local-6989586621679186046"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186045"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679186043"><span class="annot"><span class="annottext">id :: UserId
</span><a href="#local-6989586621679186043"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;&lt;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186045"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186043"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | `sendMessageChan` attempts to send the given `Text` in the channel with the given</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- `channelID`. Surpesses any error message(s), returning `()`.</span><span>
</span><span id="line-218"></span><span class="annot"><a href="Utils.html#sendMessageChan"><span class="hs-identifier hs-type">sendMessageChan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span id="sendMessageChan"><span class="annot"><span class="annottext">sendMessageChan :: UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#sendMessageChan"><span class="hs-identifier hs-var hs-var">sendMessageChan</span></a></span></span><span> </span><span id="local-6989586621679186042"><span class="annot"><span class="annottext">c :: UserId
</span><a href="#local-6989586621679186042"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679186041"><span class="annot"><span class="annottext">xs :: Text
</span><a href="#local-6989586621679186041"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
 -&gt; DiscordHandler ())
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(ChannelRequest Message
 -&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message))
-&gt; ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; ChannelRequest Message
</span><span class="hs-identifier hs-var">R.CreateMessage</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186042"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186041"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | `sendMessageChanPingsDisabled` acts in the same way as `sendMessageChan`, but disables</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- all pings (@everyone, @user, @role) pings from the message.</span><span>
</span><span id="line-223"></span><span class="annot"><a href="Utils.html#sendMessageChanPingsDisabled"><span class="hs-identifier hs-type">sendMessageChanPingsDisabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span id="sendMessageChanPingsDisabled"><span class="annot"><span class="annottext">sendMessageChanPingsDisabled :: UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#sendMessageChanPingsDisabled"><span class="hs-identifier hs-var hs-var">sendMessageChanPingsDisabled</span></a></span></span><span> </span><span id="local-6989586621679186039"><span class="annot"><span class="annottext">cid :: UserId
</span><a href="#local-6989586621679186039"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679186038"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679186038"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679186037"><span class="annot"><span class="annottext">opts :: MessageDetailedOpts
</span><a href="#local-6989586621679186037"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageDetailedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">messageDetailedContent :: Text
</span><span class="hs-identifier hs-var">R.messageDetailedContent</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186038"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-226"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">messageDetailedAllowedMentions :: Maybe AllowedMentions
</span><span class="hs-identifier hs-var">R.messageDetailedAllowedMentions</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AllowedMentions -&gt; Maybe AllowedMentions
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-227"></span><span>                        </span><span class="annot"><span class="annottext">(AllowedMentions -&gt; Maybe AllowedMentions)
-&gt; AllowedMentions -&gt; Maybe AllowedMentions
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AllowedMentions
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mentionEveryone :: Bool
</span><span class="hs-identifier hs-var">R.mentionEveryone</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-228"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mentionUsers :: Bool
</span><span class="hs-identifier hs-var">R.mentionUsers</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-229"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mentionRoles :: Bool
</span><span class="hs-identifier hs-var">R.mentionRoles</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-230"></span><span>                              </span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
 -&gt; DiscordHandler ())
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; MessageDetailedOpts -&gt; ChannelRequest Message
</span><span class="hs-identifier hs-var">R.CreateMessageDetailed</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186039"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">MessageDetailedOpts
</span><a href="#local-6989586621679186037"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | `sendReply` attempts to send a reply to the given `Message`. Suppresses any error</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- message(s), returning `()`.</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Utils.html#sendReply"><span class="hs-identifier hs-type">sendReply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span id="sendReply"><span class="annot"><span class="annottext">sendReply :: Message -&gt; Bool -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#sendReply"><span class="hs-identifier hs-var hs-var">sendReply</span></a></span></span><span> </span><span id="local-6989586621679186029"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679186029"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679186028"><span class="annot"><span class="annottext">mention :: Bool
</span><a href="#local-6989586621679186028"><span class="hs-identifier hs-var">mention</span></a></span></span><span> </span><span id="local-6989586621679186027"><span class="annot"><span class="annottext">xs :: Text
</span><a href="#local-6989586621679186027"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
 -&gt; DiscordHandler ())
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(ChannelRequest Message
 -&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message))
-&gt; ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; MessageDetailedOpts -&gt; ChannelRequest Message
</span><span class="hs-identifier hs-var">R.CreateMessageDetailed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679186029"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>        </span><span class="annot"><span class="annottext">(MessageDetailedOpts -&gt; ChannelRequest Message)
-&gt; MessageDetailedOpts -&gt; ChannelRequest Message
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MessageDetailedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">messageDetailedContent :: Text
</span><span class="hs-identifier hs-var">R.messageDetailedContent</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186027"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-240"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">messageDetailedReference :: Maybe MessageReference
</span><span class="hs-identifier hs-var">R.messageDetailedReference</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageReference -&gt; Maybe MessageReference
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-241"></span><span>                </span><span class="annot"><span class="annottext">(MessageReference -&gt; Maybe MessageReference)
-&gt; MessageReference -&gt; Maybe MessageReference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MessageReference
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">referenceMessageId :: Maybe UserId
</span><span class="hs-identifier hs-var">referenceMessageId</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Maybe UserId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Maybe UserId) -&gt; UserId -&gt; Maybe UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageId</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679186029"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-242"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">messageDetailedAllowedMentions :: Maybe AllowedMentions
</span><span class="hs-identifier hs-var">R.messageDetailedAllowedMentions</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AllowedMentions -&gt; Maybe AllowedMentions
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-243"></span><span>                </span><span class="annot"><span class="annottext">(AllowedMentions -&gt; Maybe AllowedMentions)
-&gt; AllowedMentions -&gt; Maybe AllowedMentions
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AllowedMentions
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mentionRepliedUser :: Bool
</span><span class="hs-identifier hs-var">R.mentionRepliedUser</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679186028"><span class="hs-identifier hs-var">mention</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-244"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | `sendMessageChanEmbed` attempts to send the given embed with the given `Text` in the</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- channel with the given `channelID`. Surpesses any error message(s), returning `()`.</span><span>
</span><span id="line-248"></span><span class="annot"><a href="Utils.html#sendMessageChanEmbed"><span class="hs-identifier hs-type">sendMessageChanEmbed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CreateEmbed</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span id="sendMessageChanEmbed"><span class="annot"><span class="annottext">sendMessageChanEmbed :: UserId -&gt; Text -&gt; CreateEmbed -&gt; DiscordHandler ()
</span><a href="Utils.html#sendMessageChanEmbed"><span class="hs-identifier hs-var hs-var">sendMessageChanEmbed</span></a></span></span><span> </span><span id="local-6989586621679186023"><span class="annot"><span class="annottext">c :: UserId
</span><a href="#local-6989586621679186023"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679186022"><span class="annot"><span class="annottext">xs :: Text
</span><a href="#local-6989586621679186022"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679186021"><span class="annot"><span class="annottext">e :: CreateEmbed
</span><a href="#local-6989586621679186021"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
 -&gt; DiscordHandler ())
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(ChannelRequest Message
 -&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message))
-&gt; ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; CreateEmbed -&gt; ChannelRequest Message
</span><span class="hs-identifier hs-var">R.CreateMessageEmbed</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186023"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186022"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">CreateEmbed
</span><a href="#local-6989586621679186021"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | `sendMessageDM` attempts to send the given `Text` as a direct message to the user with the</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- given `UserId`. Surpresses any error message(s), returning `()`.</span><span>
</span><span id="line-253"></span><span class="annot"><a href="Utils.html#sendMessageDM"><span class="hs-identifier hs-type">sendMessageDM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UserId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span id="sendMessageDM"><span class="annot"><span class="annottext">sendMessageDM :: UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#sendMessageDM"><span class="hs-identifier hs-var hs-var">sendMessageDM</span></a></span></span><span> </span><span id="local-6989586621679186019"><span class="annot"><span class="annottext">u :: UserId
</span><a href="#local-6989586621679186019"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679186018"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679186018"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679186017"><span class="annot"><span class="annottext">Either RestCallErrorCode Channel
</span><a href="#local-6989586621679186017"><span class="hs-identifier hs-var">chanM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserRequest Channel
-&gt; DiscordHandler (Either RestCallErrorCode Channel)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(UserRequest Channel
 -&gt; DiscordHandler (Either RestCallErrorCode Channel))
-&gt; UserRequest Channel
-&gt; DiscordHandler (Either RestCallErrorCode Channel)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserRequest Channel
</span><span class="hs-identifier hs-var">R.CreateDM</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186019"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either RestCallErrorCode Channel
</span><a href="#local-6989586621679186017"><span class="hs-identifier hs-var">chanM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679186015"><span class="annot"><span class="annottext">chan :: Channel
</span><a href="#local-6989586621679186015"><span class="hs-identifier hs-var">chan</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#sendMessageChan"><span class="hs-identifier hs-var">sendMessageChan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Channel -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">channelId</span></span><span> </span><span class="annot"><span class="annottext">Channel
</span><a href="#local-6989586621679186015"><span class="hs-identifier hs-var">chan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186018"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679186013"><span class="annot"><span class="annottext">err :: RestCallErrorCode
</span><a href="#local-6989586621679186013"><span class="hs-identifier hs-var">err</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | `sendFileChan` attempts to send the file at the provided `FilePath` in the channel with the</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- provided `ChannelId`. The file attachment is annotated by the given `Text`. Surpresses any error</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- message(s), returning `()`.</span><span>
</span><span id="line-263"></span><span class="annot"><a href="Utils.html#sendFileChan"><span class="hs-identifier hs-type">sendFileChan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span id="sendFileChan"><span class="annot"><span class="annottext">sendFileChan :: UserId -&gt; Text -&gt; FilePath -&gt; DiscordHandler ()
</span><a href="Utils.html#sendFileChan"><span class="hs-identifier hs-var hs-var">sendFileChan</span></a></span></span><span> </span><span id="local-6989586621679186012"><span class="annot"><span class="annottext">c :: UserId
</span><a href="#local-6989586621679186012"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679186011"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679186011"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679186010"><span class="annot"><span class="annottext">fp :: FilePath
</span><a href="#local-6989586621679186010"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621679186009"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679186009"><span class="hs-identifier hs-var">mFileContent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; ReaderT DiscordHandle IO (Maybe ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe ByteString)
 -&gt; ReaderT DiscordHandle IO (Maybe ByteString))
-&gt; IO (Maybe ByteString)
-&gt; ReaderT DiscordHandle IO (Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe ByteString)
</span><a href="Utils.html#safeReadFile"><span class="hs-identifier hs-var">safeReadFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186010"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679186009"><span class="hs-identifier hs-var">mFileContent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>              </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; DiscordHandler ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; DiscordHandler ()) -&gt; IO () -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[WARN] Couldn't load file: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186010"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-269"></span><span>              </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#sendMessageChan"><span class="hs-identifier hs-var">sendMessageChan</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186012"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler ()) -&gt; Text -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#owoify"><span class="hs-identifier hs-var">owoify</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;The file cannot be found!&quot;</span></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679186006"><span class="annot"><span class="annottext">fileContent :: ByteString
</span><a href="#local-6989586621679186006"><span class="hs-identifier hs-var">fileContent</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
 -&gt; DiscordHandler ())
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
-&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(ChannelRequest Message
 -&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message))
-&gt; ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; ByteString -&gt; ChannelRequest Message
</span><span class="hs-identifier hs-var">R.CreateMessageUploadFile</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679186012"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679186011"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679186006"><span class="hs-identifier hs-var">fileContent</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | `safeReadFile` attempts to convert the file at the provided `FilePath` into a `ByteString`,</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- wrapped in a `Maybe` monad. On reading failure, this function returns `Nothing`.</span><span>
</span><span id="line-274"></span><span class="annot"><a href="Utils.html#safeReadFile"><span class="hs-identifier hs-type">safeReadFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="safeReadFile"><span class="annot"><span class="annottext">safeReadFile :: FilePath -&gt; IO (Maybe ByteString)
</span><a href="Utils.html#safeReadFile"><span class="hs-identifier hs-var hs-var">safeReadFile</span></a></span></span><span> </span><span id="local-6989586621679186004"><span class="annot"><span class="annottext">path :: FilePath
</span><a href="#local-6989586621679186004"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; (IOException -&gt; IO (Maybe ByteString)) -&gt; IO (Maybe ByteString)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; IO ByteString -&gt; IO (Maybe ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ByteString
</span><span class="hs-identifier hs-var">B.readFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679186004"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IOException -&gt; IO (Maybe ByteString)
</span><a href="#local-6989586621679186002"><span class="hs-identifier hs-var">putNothing</span></a></span><span>
</span><span id="line-276"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>                </span><span class="annot"><a href="#local-6989586621679186002"><span class="hs-identifier hs-type">putNothing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>                </span><span id="local-6989586621679186002"><span class="annot"><span class="annottext">putNothing :: IOException -&gt; IO (Maybe ByteString)
</span><a href="#local-6989586621679186002"><span class="hs-identifier hs-var hs-var">putNothing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString) -&gt; IOException -&gt; IO (Maybe ByteString)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe ByteString) -&gt; IOException -&gt; IO (Maybe ByteString))
-&gt; IO (Maybe ByteString) -&gt; IOException -&gt; IO (Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; IO (Maybe ByteString)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- | `messageFromReaction` attempts to get the Message instance from a reaction.</span><span>
</span><span id="line-281"></span><span class="annot"><a href="Utils.html#messageFromReaction"><span class="hs-identifier hs-type">messageFromReaction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReactionInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RestCallErrorCode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span id="messageFromReaction"><span class="annot"><span class="annottext">messageFromReaction :: ReactionInfo
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
</span><a href="Utils.html#messageFromReaction"><span class="hs-identifier hs-var hs-var">messageFromReaction</span></a></span></span><span> </span><span id="local-6989586621679186000"><span class="annot"><span class="annottext">r :: ReactionInfo
</span><a href="#local-6989586621679186000"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">(ChannelRequest Message
 -&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message))
-&gt; ChannelRequest Message
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode Message)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UserId, UserId) -&gt; ChannelRequest Message
</span><span class="hs-identifier hs-var">R.GetChannelMessage</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReactionInfo -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">reactionChannelId</span></span><span> </span><span class="annot"><span class="annottext">ReactionInfo
</span><a href="#local-6989586621679186000"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReactionInfo -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">reactionMessageId</span></span><span> </span><span class="annot"><span class="annottext">ReactionInfo
</span><a href="#local-6989586621679186000"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | `addReaction` attempts to add a reaction to the given message ID. Supresses any</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- error message(s), returning `()`.</span><span>
</span><span id="line-287"></span><span class="annot"><a href="Utils.html#addReaction"><span class="hs-identifier hs-type">addReaction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MessageId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span id="addReaction"><span class="annot"><span class="annottext">addReaction :: UserId -&gt; UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#addReaction"><span class="hs-identifier hs-var hs-var">addReaction</span></a></span></span><span> </span><span id="local-6989586621679185995"><span class="annot"><span class="annottext">c :: UserId
</span><a href="#local-6989586621679185995"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679185994"><span class="annot"><span class="annottext">m :: UserId
</span><a href="#local-6989586621679185994"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679185993"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679185993"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChannelRequest () -&gt; DiscordHandler (Either RestCallErrorCode ())
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UserId, UserId) -&gt; Text -&gt; ChannelRequest ()
</span><span class="hs-identifier hs-var">R.CreateReaction</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185995"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185994"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185993"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DiscordHandler (Either RestCallErrorCode ())
-&gt; DiscordHandler () -&gt; DiscordHandler ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | `isMod` checks whether the provided message was sent by a user with the `Moderator` role.</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Utils.html#isMod"><span class="hs-identifier hs-type">isMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-293"></span><span id="isMod"><span class="annot"><span class="annottext">isMod :: Message -&gt; DiscordHandler Bool
</span><a href="Utils.html#isMod"><span class="hs-identifier hs-var hs-var">isMod</span></a></span></span><span> </span><span id="local-6989586621679185991"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679185991"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool)
-&gt; ReaderT DiscordHandle IO [Bool] -&gt; DiscordHandler Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler Bool)
-&gt; [Text] -&gt; ReaderT DiscordHandle IO [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; Text -&gt; DiscordHandler Bool
</span><a href="Utils.html#hasRoleByName"><span class="hs-identifier hs-var">hasRoleByName</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185991"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;Mod&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Moderator&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | `hasRoleByName` checks whether the provided message was sent by a user that has a role matching</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- the provided `Text` exactly.</span><span>
</span><span id="line-297"></span><span class="annot"><a href="Utils.html#hasRoleByName"><span class="hs-identifier hs-type">hasRoleByName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-298"></span><span id="hasRoleByName"><span class="annot"><span class="annottext">hasRoleByName :: Message -&gt; Text -&gt; DiscordHandler Bool
</span><a href="Utils.html#hasRoleByName"><span class="hs-identifier hs-var hs-var">hasRoleByName</span></a></span></span><span> </span><span id="local-6989586621679185988"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679185988"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679185987"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679185987"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">messageGuild</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185988"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679185985"><span class="annot"><span class="annottext">g :: UserId
</span><a href="#local-6989586621679185985"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621679185984"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679185984"><span class="hs-identifier hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; DiscordHandler [Role]
</span><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-var">getRolesOfUserInGuild</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">(User -&gt; UserId) -&gt; User -&gt; UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185988"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185985"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; DiscordHandler Bool) -&gt; Bool -&gt; DiscordHandler Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185987"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Role -&gt; Text) -&gt; [Role] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Text
</span><span class="hs-identifier hs-var hs-var">roleName</span></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679185984"><span class="hs-identifier hs-var">filtered</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | `isNotMutExWith` checks whether the two given lists are not mutually exclusive. That is, if the</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- two given lists contain at least one common element (with equality being determined by their `Eq`</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- class instantiation).</span><span>
</span><span id="line-307"></span><span id="local-6989586621679185981"><span class="annot"><a href="Utils.html#isNotMutExWith"><span class="hs-identifier hs-type">isNotMutExWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679185981"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679185981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679185981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-308"></span><span id="isNotMutExWith"><span class="annot"><span class="annottext">isNotMutExWith :: [a] -&gt; [a] -&gt; Bool
</span><a href="Utils.html#isNotMutExWith"><span class="hs-identifier hs-var hs-var">isNotMutExWith</span></a></span></span><span> </span><span id="local-6989586621679185979"><span class="annot"><span class="annottext">x :: [a]
</span><a href="#local-6989586621679185979"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679185978"><span class="annot"><span class="annottext">y :: [a]
</span><a href="#local-6989586621679185978"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a -&gt; Bool]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679185979"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a -&gt; Bool] -&gt; [a] -&gt; [Bool]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679185978"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- the cartesian product of two lists, but constructed with pairwise `(==)` instead of `(,)`.</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | `hasRoleByID` checks whether the provided message was sent by a user that has a role matching</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- the provided `RoleId`.</span><span>
</span><span id="line-313"></span><span class="annot"><a href="Utils.html#hasRoleByID"><span class="hs-identifier hs-type">hasRoleByID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-314"></span><span id="hasRoleByID"><span class="annot"><span class="annottext">hasRoleByID :: Message -&gt; UserId -&gt; DiscordHandler Bool
</span><a href="Utils.html#hasRoleByID"><span class="hs-identifier hs-var hs-var">hasRoleByID</span></a></span></span><span> </span><span id="local-6989586621679185977"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679185977"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679185976"><span class="annot"><span class="annottext">r :: UserId
</span><a href="#local-6989586621679185976"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">messageGuild</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185977"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679185975"><span class="annot"><span class="annottext">g :: UserId
</span><a href="#local-6989586621679185975"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621679185974"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679185974"><span class="hs-identifier hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; DiscordHandler [Role]
</span><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-var">getRolesOfUserInGuild</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">(User -&gt; UserId) -&gt; User -&gt; UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185977"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185975"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; DiscordHandler Bool) -&gt; Bool -&gt; DiscordHandler Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185976"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; [UserId] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Role -&gt; UserId) -&gt; [Role] -&gt; [UserId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">roleId</span></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679185974"><span class="hs-identifier hs-var">filtered</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- | `checkAllIDs` checks every role of the provided message's author against every role in the</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- global `devIDs` file, returning an exhaustive list of booleans as a result.</span><span>
</span><span id="line-322"></span><span class="annot"><a href="Utils.html#checkAllIDs"><span class="hs-identifier hs-type">checkAllIDs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span id="checkAllIDs"><span class="annot"><span class="annottext">checkAllIDs :: Message -&gt; IO [DiscordHandler Bool]
</span><a href="Utils.html#checkAllIDs"><span class="hs-identifier hs-var hs-var">checkAllIDs</span></a></span></span><span> </span><span id="local-6989586621679185972"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679185972"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679185971"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679185971"><span class="hs-identifier hs-var">devFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [Text]
</span><a href="CSV.html#readSingleColCSV"><span class="hs-identifier hs-var">readSingleColCSV</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Utils.html#devIDs"><span class="hs-identifier hs-var">devIDs</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185970"><span class="annot"><span class="annottext">devRoleIDs :: [UserId]
</span><a href="#local-6989586621679185970"><span class="hs-identifier hs-var hs-var">devRoleIDs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; UserId
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; UserId) -&gt; (Text -&gt; FilePath) -&gt; Text -&gt; UserId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; UserId) -&gt; [Text] -&gt; [UserId]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679185971"><span class="hs-identifier hs-var">devFile</span></a></span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="annottext">[DiscordHandler Bool] -&gt; IO [DiscordHandler Bool]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([DiscordHandler Bool] -&gt; IO [DiscordHandler Bool])
-&gt; [DiscordHandler Bool] -&gt; IO [DiscordHandler Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; DiscordHandler Bool)
-&gt; [UserId] -&gt; [DiscordHandler Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UserId -&gt; DiscordHandler Bool
</span><a href="Utils.html#hasRoleByID"><span class="hs-identifier hs-var">hasRoleByID</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185972"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UserId]
</span><a href="#local-6989586621679185970"><span class="hs-identifier hs-var">devRoleIDs</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | `isSenderDeveloper` checks whether the provided message's author is a developer.</span><span>
</span><span id="line-329"></span><span class="annot"><a href="Utils.html#isSenderDeveloper"><span class="hs-identifier hs-type">isSenderDeveloper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-330"></span><span id="isSenderDeveloper"><span class="annot"><span class="annottext">isSenderDeveloper :: Message -&gt; DiscordHandler Bool
</span><a href="Utils.html#isSenderDeveloper"><span class="hs-identifier hs-var hs-var">isSenderDeveloper</span></a></span></span><span> </span><span id="local-6989586621679185968"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679185968"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool)
-&gt; ReaderT DiscordHandle IO [Bool] -&gt; DiscordHandler Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO [Bool] -&gt; DiscordHandler Bool)
-&gt; (IO (ReaderT DiscordHandle IO [Bool])
    -&gt; ReaderT DiscordHandle IO [Bool])
-&gt; IO (ReaderT DiscordHandle IO [Bool])
-&gt; DiscordHandler Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (ReaderT DiscordHandle IO [Bool])
-&gt; ReaderT DiscordHandle IO [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (ReaderT DiscordHandle IO [Bool])
 -&gt; ReaderT DiscordHandle IO [Bool])
-&gt; (IO (ReaderT DiscordHandle IO [Bool])
    -&gt; ReaderT DiscordHandle IO (ReaderT DiscordHandle IO [Bool]))
-&gt; IO (ReaderT DiscordHandle IO [Bool])
-&gt; ReaderT DiscordHandle IO [Bool]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (ReaderT DiscordHandle IO [Bool])
-&gt; ReaderT DiscordHandle IO (ReaderT DiscordHandle IO [Bool])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (ReaderT DiscordHandle IO [Bool]) -&gt; DiscordHandler Bool)
-&gt; IO (ReaderT DiscordHandle IO [Bool]) -&gt; DiscordHandler Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DiscordHandler Bool] -&gt; ReaderT DiscordHandle IO [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([DiscordHandler Bool] -&gt; ReaderT DiscordHandle IO [Bool])
-&gt; IO [DiscordHandler Bool] -&gt; IO (ReaderT DiscordHandle IO [Bool])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; IO [DiscordHandler Bool]
</span><a href="Utils.html#checkAllIDs"><span class="hs-identifier hs-var">checkAllIDs</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185968"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | `getRolesOfUserInGuild` fetches a list of roles partaining to the user with the given `UserId`</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- within the guild with the given `GuildId`.</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-type">getRolesOfUserInGuild</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UserId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Role</span></span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span id="getRolesOfUserInGuild"><span class="annot"><span class="annottext">getRolesOfUserInGuild :: UserId -&gt; UserId -&gt; DiscordHandler [Role]
</span><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-var hs-var">getRolesOfUserInGuild</span></a></span></span><span> </span><span id="local-6989586621679185966"><span class="annot"><span class="annottext">uid :: UserId
</span><a href="#local-6989586621679185966"><span class="hs-identifier hs-var">uid</span></a></span></span><span> </span><span id="local-6989586621679185965"><span class="annot"><span class="annottext">g :: UserId
</span><a href="#local-6989586621679185965"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679185964"><span class="annot"><span class="annottext">allGuildRoles :: [Role]
</span><a href="#local-6989586621679185964"><span class="hs-identifier hs-var">allGuildRoles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GuildRequest [Role]
-&gt; DiscordHandler (Either RestCallErrorCode [Role])
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest [Role]
 -&gt; DiscordHandler (Either RestCallErrorCode [Role]))
-&gt; GuildRequest [Role]
-&gt; DiscordHandler (Either RestCallErrorCode [Role])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; GuildRequest [Role]
</span><span class="hs-identifier hs-var">R.GetGuildRoles</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185965"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679185963"><span class="annot"><span class="annottext">user :: GuildMember
</span><a href="#local-6989586621679185963"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GuildRequest GuildMember
-&gt; DiscordHandler (Either RestCallErrorCode GuildMember)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest GuildMember
 -&gt; DiscordHandler (Either RestCallErrorCode GuildMember))
-&gt; GuildRequest GuildMember
-&gt; DiscordHandler (Either RestCallErrorCode GuildMember)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; GuildRequest GuildMember
</span><span class="hs-identifier hs-var">R.GetGuildMember</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185965"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185966"><span class="hs-identifier hs-var">uid</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185961"><span class="annot"><span class="annottext">userRolesInGuild :: [Role]
</span><a href="#local-6989586621679185961"><span class="hs-identifier hs-var hs-var">userRolesInGuild</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Role -&gt; Bool) -&gt; [Role] -&gt; [Role]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185960"><span class="annot"><span class="annottext">x :: Role
</span><a href="#local-6989586621679185960"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Role -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">roleId</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185960"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; [UserId] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">GuildMember -&gt; [UserId]
</span><span class="hs-identifier hs-var hs-var">memberRoles</span></span><span> </span><span class="annot"><span class="annottext">GuildMember
</span><a href="#local-6989586621679185963"><span class="hs-identifier hs-var">user</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679185964"><span class="hs-identifier hs-var">allGuildRoles</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">[Role] -&gt; DiscordHandler [Role]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679185961"><span class="hs-identifier hs-var">userRolesInGuild</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | `getTimestampFromMessages` returns the given message's timestamp as `Text`, in the format</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- `yyyy-mm-dd | hh:mm:ss`.</span><span>
</span><span id="line-343"></span><span class="annot"><a href="Utils.html#getTimestampFromMessage"><span class="hs-identifier hs-type">getTimestampFromMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-344"></span><span id="getTimestampFromMessage"><span class="annot"><span class="annottext">getTimestampFromMessage :: Message -&gt; Text
</span><a href="Utils.html#getTimestampFromMessage"><span class="hs-identifier hs-var hs-var">getTimestampFromMessage</span></a></span></span><span> </span><span id="local-6989586621679185958"><span class="annot"><span class="annottext">m :: Message
</span><a href="#local-6989586621679185958"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; FilePath -&gt; UTCTime -&gt; FilePath
forall t. FormatTime t =&gt; TimeLocale -&gt; FilePath -&gt; t -&gt; FilePath
</span><span class="hs-identifier hs-var">TF.formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">TF.defaultTimeLocale</span></span><span> </span><span class="annot"><span class="hs-string">&quot;%Y-%m-%d %H:%M:%S %Z&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UTCTime
</span><span class="hs-identifier hs-var hs-var">messageTimestamp</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185958"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | `captureCommandOutput` creates a new process from the desired command provided as a `String`.</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- Then, it waits for the command to finish executing, returning its output as a `Text`.</span><span>
</span><span id="line-348"></span><span class="annot"><a href="Utils.html#captureCommandOutput"><span class="hs-identifier hs-type">captureCommandOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-349"></span><span id="captureCommandOutput"><span class="annot"><span class="annottext">captureCommandOutput :: FilePath -&gt; IO Text
</span><a href="Utils.html#captureCommandOutput"><span class="hs-identifier hs-var hs-var">captureCommandOutput</span></a></span></span><span> </span><span id="local-6989586621679185954"><span class="annot"><span class="annottext">command :: FilePath
</span><a href="#local-6989586621679185954"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185953"><span class="annot"><span class="annottext">executable :: FilePath
</span><a href="#local-6989586621679185953"><span class="hs-identifier hs-var">executable</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679185952"><span class="annot"><span class="annottext">args :: [FilePath]
</span><a href="#local-6989586621679185952"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; [FilePath]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">splitOn</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679185954"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679185951"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679185951"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess -&gt; FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">Process.readCreateProcess</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">Process.proc</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679185953"><span class="hs-identifier hs-var">executable</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679185952"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">cwd :: Maybe FilePath
</span><span class="hs-identifier hs-var">cwd</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO Text) -&gt; Text -&gt; IO Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679185951"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | `update` calls a shell script that updates the bot's repo</span><span>
</span><span id="line-357"></span><span class="annot"><a href="Utils.html#update"><span class="hs-identifier hs-type">update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-358"></span><span id="update"><span class="annot"><span class="annottext">update :: IO Bool
</span><a href="Utils.html#update"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679185947"><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679185947"><span class="hs-identifier hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ProcessHandle
</span><span class="hs-identifier hs-var">Process.spawnCommand</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;cd &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Utils.html#repoDir"><span class="hs-identifier hs-var">repoDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &amp;&amp; git reset --hard @{u} &amp;&amp; git pull &amp;&amp; stack install&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679185945"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621679185945"><span class="hs-identifier hs-var">exitcode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProcessHandle -&gt; IO ExitCode
</span><span class="hs-identifier hs-var">Process.waitForProcess</span></span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679185947"><span class="hs-identifier hs-var">process</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO Bool) -&gt; Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621679185945"><span class="hs-identifier hs-var">exitcode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-362"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">ExitSuccess</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-363"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">ExitFailure</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- | `newCommand` should be used in the creation of a new Owen command. Given a `T.Text` command regex</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- (lacking the `:` prefix and the trailing whitespace), along with a function that can handle the</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- regex captures, the command can be used to create `Message -&gt; DiscordHandler ()` message receivers.</span><span>
</span><span id="line-368"></span><span class="annot"><a href="Utils.html#newCommand"><span class="hs-identifier hs-type">newCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>                               </span><span class="hs-comment">-- ^ a message that needs to be handled</span><span>
</span><span id="line-369"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>                             </span><span class="hs-comment">-- ^ the new command regex</span><span>
</span><span id="line-370"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ a function used to handle each message portion</span><span>
</span><span id="line-371"></span><span>                                                    </span><span class="hs-comment">-- captured by the command regex</span><span>
</span><span id="line-372"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>                  </span><span class="hs-comment">-- ^ the over-all result of handling the message</span><span>
</span><span id="line-373"></span><span id="newCommand"><span class="annot"><span class="annottext">newCommand :: Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newCommand"><span class="hs-identifier hs-var hs-var">newCommand</span></a></span></span><span> </span><span id="local-6989586621679185943"><span class="annot"><span class="annottext">msg :: Message
</span><a href="#local-6989586621679185943"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679185942"><span class="annot"><span class="annottext">cmd :: Text
</span><a href="#local-6989586621679185942"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679185941"><span class="annot"><span class="annottext">funct :: [Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679185941"><span class="hs-identifier hs-var">funct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler () -&gt; DiscordHandler ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185940"><span class="hs-identifier hs-var">shouldNotBeEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DiscordHandler () -&gt; DiscordHandler ())
-&gt; DiscordHandler () -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679185941"><span class="hs-identifier hs-var">funct</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679185939"><span class="hs-identifier hs-var">captures</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="#local-6989586621679185938"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-376"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>   </span><span class="hs-comment">-- the first match of the regex against the message</span><span>
</span><span id="line-377"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-378"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- every message portion identified by the regex capture groups</span><span>
</span><span id="line-379"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span id="local-6989586621679185938"><span class="annot"><span class="annottext">match :: (Text, Text, Text, [Text])
</span><a href="#local-6989586621679185938"><span class="hs-identifier hs-var">match</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185940"><span class="annot"><span class="annottext">shouldNotBeEmpty :: Text
</span><a href="#local-6989586621679185940"><span class="hs-identifier hs-var">shouldNotBeEmpty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185939"><span class="annot"><span class="annottext">captures :: [Text]
</span><a href="#local-6989586621679185939"><span class="hs-identifier hs-var">captures</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Text
</span><span class="hs-identifier hs-var hs-var">messageText</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185943"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text, Text, [Text])
forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><span class="hs-operator hs-var">=~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;^:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185942"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="TemplateRE.html#trailingWS"><span class="hs-identifier hs-var">trailingWS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | `newDevCommand` should be used in the creation of a new Owen dev command. Acts in the same way as `newCommand`,</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- with the distinction that it constructs handlers that require the message author to be a developer. If they</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- are not, the message author is messaged directly and reprimanded so harshly that they will never attempt to use a</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- dev command ever again.</span><span>
</span><span id="line-386"></span><span class="annot"><a href="Utils.html#newDevCommand"><span class="hs-identifier hs-type">newDevCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>
</span><span id="line-387"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-388"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span id="newDevCommand"><span class="annot"><span class="annottext">newDevCommand :: Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newDevCommand"><span class="hs-identifier hs-var hs-var">newDevCommand</span></a></span></span><span> </span><span id="local-6989586621679185936"><span class="annot"><span class="annottext">msg :: Message
</span><a href="#local-6989586621679185936"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679185935"><span class="annot"><span class="annottext">cmd :: Text
</span><a href="#local-6989586621679185935"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679185934"><span class="annot"><span class="annottext">fun :: [Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679185934"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newCommand"><span class="hs-identifier hs-var">newCommand</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185936"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185935"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">(([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ())
-&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679185933"><span class="annot"><span class="annottext">captures :: [Text]
</span><a href="#local-6989586621679185933"><span class="hs-identifier hs-var">captures</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679185932"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185932"><span class="hs-identifier hs-var">isDev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler Bool
</span><a href="Utils.html#isSenderDeveloper"><span class="hs-identifier hs-var">isSenderDeveloper</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185936"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185932"><span class="hs-identifier hs-var">isDev</span></a></span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679185934"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679185933"><span class="hs-identifier hs-var">captures</span></a></span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler ()
</span><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-var">sendPrivError</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185936"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><a href="Utils.html#newModCommand"><span class="hs-identifier hs-type">newModCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>
</span><span id="line-398"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-399"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span id="newModCommand"><span class="annot"><span class="annottext">newModCommand :: Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newModCommand"><span class="hs-identifier hs-var hs-var">newModCommand</span></a></span></span><span> </span><span id="local-6989586621679185930"><span class="annot"><span class="annottext">msg :: Message
</span><a href="#local-6989586621679185930"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679185929"><span class="annot"><span class="annottext">cmd :: Text
</span><a href="#local-6989586621679185929"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679185928"><span class="annot"><span class="annottext">fun :: [Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679185928"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newCommand"><span class="hs-identifier hs-var">newCommand</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185930"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185929"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">(([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ())
-&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679185927"><span class="annot"><span class="annottext">captures :: [Text]
</span><a href="#local-6989586621679185927"><span class="hs-identifier hs-var">captures</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679185926"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185926"><span class="hs-identifier hs-var">isMod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler Bool
</span><a href="Utils.html#isMod"><span class="hs-identifier hs-var">isMod</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185930"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185926"><span class="hs-identifier hs-var">isMod</span></a></span><span>
</span><span id="line-404"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679185928"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679185927"><span class="hs-identifier hs-var">captures</span></a></span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler ()
</span><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-var">sendPrivError</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185930"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-type">sendPrivError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span id="sendPrivError"><span class="annot"><span class="annottext">sendPrivError :: Message -&gt; DiscordHandler ()
</span><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-var hs-var">sendPrivError</span></a></span></span><span> </span><span id="local-6989586621679185925"><span class="annot"><span class="annottext">msg :: Message
</span><a href="#local-6989586621679185925"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#sendMessageDM"><span class="hs-identifier hs-var">sendMessageDM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">(User -&gt; UserId) -&gt; User -&gt; UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679185925"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler ()) -&gt; Text -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#owoify"><span class="hs-identifier hs-var">owoify</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Insufficient privileges!&quot;</span></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><a href="Utils.html#snowflakeToInt"><span class="hs-identifier hs-type">snowflakeToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snowflake</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-411"></span><span id="snowflakeToInt"><span class="annot"><span class="annottext">snowflakeToInt :: UserId -&gt; Integer
</span><a href="Utils.html#snowflakeToInt"><span class="hs-identifier hs-var hs-var">snowflakeToInt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Snowflake</span></span><span> </span><span id="local-6989586621679185922"><span class="annot"><span class="annottext">w :: Word64
</span><a href="#local-6989586621679185922"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679185922"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="annot"><a href="Utils.html#moveChannel"><span class="hs-identifier hs-type">moveChannel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span id="moveChannel"><span class="annot"><span class="annottext">moveChannel :: UserId -&gt; UserId -&gt; Int -&gt; DiscordHandler ()
</span><a href="Utils.html#moveChannel"><span class="hs-identifier hs-var hs-var">moveChannel</span></a></span></span><span> </span><span id="local-6989586621679185921"><span class="annot"><span class="annottext">guild :: UserId
</span><a href="#local-6989586621679185921"><span class="hs-identifier hs-var">guild</span></a></span></span><span> </span><span id="local-6989586621679185920"><span class="annot"><span class="annottext">chan :: UserId
</span><a href="#local-6989586621679185920"><span class="hs-identifier hs-var">chan</span></a></span></span><span> </span><span id="local-6989586621679185919"><span class="annot"><span class="annottext">location :: Int
</span><a href="#local-6989586621679185919"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
-&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
 -&gt; DiscordHandler ())
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
-&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GuildRequest [Channel]
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest [Channel]
 -&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel]))
-&gt; GuildRequest [Channel]
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; [(UserId, Int)] -&gt; GuildRequest [Channel]
</span><span class="hs-identifier hs-var">R.ModifyGuildChannelPositions</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185921"><span class="hs-identifier hs-var">guild</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679185920"><span class="hs-identifier hs-var">chan</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185919"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-415"></span></pre></body></html>