<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_C53iBaG3zC387sCOR5EFVb"><span id="%24tag2con_C53iBaG3zC387sCOR5EFVb"><span id="%24con2tag_C53iBaG3zC387sCOR5EFVb"></span></span></span><span class="hs-pragma">{-# OPTIONS -funbox-strict-fields #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- | Common provides simple functions to the backend.  It defines most</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- of the data types.  All modules should call error via the</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- common_error function below.</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Regex.TDFA.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Regex.Base</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RegexOptions</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">{- By Chris Kuklewicz, 2007-2009. BSD License, see the LICENSE file. -}</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.IArray</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IntSet.EnumSet2.html"><span class="hs-identifier">Data.IntSet.EnumSet2</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Data.IntSet.EnumSet2.html#EnumSet"><span class="hs-identifier">EnumSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.IntSet.EnumSet2.html"><span class="hs-identifier">Data.IntSet.EnumSet2</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">(</span><span class="annot"><a href="Data.IntSet.EnumSet2.html#toList"><span class="hs-identifier">toList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IntMap.CharMap2.html"><span class="hs-identifier">Data.IntMap.CharMap2</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier">CharMap</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">findWithDefault</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">assocs</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">size</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">toAscList</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntSet</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntSet</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.IntMap.CharMap2.html"><span class="hs-identifier">Data.IntMap.CharMap2</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntMap.CharMap2.html#assocs"><span class="hs-identifier">assocs</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.IntMap.CharMap2.html#toAscList"><span class="hs-identifier">toAscList</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.IntMap.CharMap2.html#null"><span class="hs-identifier">null</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-comment">--import Debug.Trace</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.IntArrTrieSet.html"><span class="hs-identifier">Text.Regex.TDFA.IntArrTrieSet</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.IntArrTrieSet.html#TrieSet"><span class="hs-identifier">TrieSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#look"><span class="hs-pragma hs-type">look</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-24"></span><span id="local-6989586621679120553"><span class="annot"><a href="Text.Regex.TDFA.Common.html#look"><span class="hs-identifier hs-type">look</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679120553"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120553"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-25"></span><span id="look"><span class="annot"><span class="annottext">look :: Int -&gt; IntMap a -&gt; a
</span><a href="Text.Regex.TDFA.Common.html#look"><span class="hs-identifier hs-var hs-var">look</span></a></span></span><span> </span><span id="local-6989586621679120552"><span class="annot"><span class="annottext">key :: Int
</span><a href="#local-6989586621679120552"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679120551"><span class="annot"><span class="annottext">imap :: IntMap a
</span><a href="#local-6989586621679120551"><span class="hs-identifier hs-var">imap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; IntMap a -&gt; a
forall a. a -&gt; Int -&gt; IntMap a -&gt; a
</span><span class="hs-identifier hs-var">IMap.findWithDefault</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; a
forall a. String -&gt; String -&gt; a
</span><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-var">common_error</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Text.Regex.DFA.Common&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;key &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120552"><span class="hs-identifier hs-var">key</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot; not found in look&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120552"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679120551"><span class="hs-identifier hs-var">imap</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span id="local-6989586621679120675"><span class="annot"><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-type">common_error</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120675"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-28"></span><span id="common_error"><span class="annot"><span class="annottext">common_error :: String -&gt; String -&gt; a
</span><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-var hs-var">common_error</span></a></span></span><span> </span><span id="local-6989586621679120548"><span class="annot"><span class="annottext">moduleName :: String
</span><a href="#local-6989586621679120548"><span class="hs-identifier hs-var">moduleName</span></a></span></span><span> </span><span id="local-6989586621679120547"><span class="annot"><span class="annottext">message :: String
</span><a href="#local-6989586621679120547"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Explict error in module &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120548"><span class="hs-identifier hs-var">moduleName</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot; : &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120547"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span id="local-6989586621679120543"><span id="local-6989586621679120544"><span id="local-6989586621679120545"><span class="annot"><a href="Text.Regex.TDFA.Common.html#on"><span class="hs-identifier hs-type">on</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120545"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120545"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120544"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120543"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120545"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120543"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120543"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120544"><span class="hs-identifier hs-type">t2</span></a></span></span></span></span><span>
</span><span id="line-32"></span><span id="local-6989586621679120541"><span class="annot"><span class="annottext">f :: t1 -&gt; t1 -&gt; t2
</span><a href="#local-6989586621679120541"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="on"><span class="annot"><span class="annottext">on :: (t1 -&gt; t1 -&gt; t2) -&gt; (t -&gt; t1) -&gt; t -&gt; t -&gt; t2
</span><a href="Text.Regex.TDFA.Common.html#on"><span class="hs-operator hs-var hs-var">`on`</span></a></span></span><span> </span><span id="local-6989586621679120540"><span class="annot"><span class="annottext">g :: t -&gt; t1
</span><a href="#local-6989586621679120540"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120539"><span class="annot"><span class="annottext">x :: t
</span><a href="#local-6989586621679120539"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679120538"><span class="annot"><span class="annottext">y :: t
</span><a href="#local-6989586621679120538"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t1
</span><a href="#local-6989586621679120540"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679120539"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t1 -&gt; t1 -&gt; t2
</span><a href="#local-6989586621679120541"><span class="hs-operator hs-var">`f`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t1
</span><a href="#local-6989586621679120540"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679120538"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | after 'sort' or 'sortBy' the use of 'nub'\/'nubBy' can be replaced by 'norep'\/'norepBy'</span><span>
</span><span id="line-35"></span><span id="local-6989586621679120663"><span class="annot"><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-type">norep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679120663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-36"></span><span id="norep"><span class="annot"><span class="annottext">norep :: [a] -&gt; [a]
</span><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-var hs-var">norep</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-var">norep</span></a></span><span> </span><span id="local-6989586621679120536"><span class="annot"><span class="annottext">x :: [a]
</span><a href="#local-6989586621679120536"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679120536"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-var">norep</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120535"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679120535"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679120534"><span class="annot"><span class="annottext">bs :: [a]
</span><a href="#local-6989586621679120534"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679120533"><span class="annot"><span class="annottext">c :: a
</span><a href="#local-6989586621679120533"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679120532"><span class="annot"><span class="annottext">cs :: [a]
</span><a href="#local-6989586621679120532"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120535"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120533"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-var">norep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120535"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679120532"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120535"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-var">norep</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679120534"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | after 'sort' or 'sortBy' the use of 'nub'\/'nubBy' can be replaced by 'norep'\/'norepBy'</span><span>
</span><span id="line-42"></span><span id="local-6989586621679120660"><span class="annot"><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-type">norepBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120660"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120660"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120660"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120660"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-43"></span><span id="norepBy"><span class="annot"><span class="annottext">norepBy :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-var hs-var">norepBy</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-var">norepBy</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679120530"><span class="annot"><span class="annottext">x :: [a]
</span><a href="#local-6989586621679120530"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679120530"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-45"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-var">norepBy</span></a></span><span> </span><span id="local-6989586621679120529"><span class="annot"><span class="annottext">eqF :: a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679120529"><span class="hs-identifier hs-var">eqF</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120528"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679120528"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679120527"><span class="annot"><span class="annottext">bs :: [a]
</span><a href="#local-6989586621679120527"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679120526"><span class="annot"><span class="annottext">c :: a
</span><a href="#local-6989586621679120526"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679120525"><span class="annot"><span class="annottext">cs :: [a]
</span><a href="#local-6989586621679120525"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120528"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679120529"><span class="hs-operator hs-var">`eqF`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120526"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-var">norepBy</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679120529"><span class="hs-identifier hs-var">eqF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120528"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679120525"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120528"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-var">norepBy</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679120529"><span class="hs-identifier hs-var">eqF</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679120527"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span id="local-6989586621679120521"><span id="local-6989586621679120522"><span id="local-6989586621679120523"><span id="local-6989586621679120524"><span class="annot"><a href="Text.Regex.TDFA.Common.html#mapFst"><span class="hs-identifier hs-type">mapFst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679120524"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120523"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120522"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120524"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120523"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679120521"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120524"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120522"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679120521"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-49"></span><span id="mapFst"><span class="annot"><span class="annottext">mapFst :: (t -&gt; t2) -&gt; f (t, t1) -&gt; f (t2, t1)
</span><a href="Text.Regex.TDFA.Common.html#mapFst"><span class="hs-identifier hs-var hs-var">mapFst</span></a></span></span><span> </span><span id="local-6989586621679120519"><span class="annot"><span class="annottext">f :: t -&gt; t2
</span><a href="#local-6989586621679120519"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((t, t1) -&gt; (t2, t1)) -&gt; f (t, t1) -&gt; f (t2, t1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120518"><span class="annot"><span class="annottext">a :: t
</span><a href="#local-6989586621679120518"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679120517"><span class="annot"><span class="annottext">b :: t1
</span><a href="#local-6989586621679120517"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t2
</span><a href="#local-6989586621679120519"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679120518"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679120517"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621679120591"><span id="local-6989586621679120592"><span id="local-6989586621679120593"><span id="local-6989586621679120594"><span class="annot"><a href="Text.Regex.TDFA.Common.html#mapSnd"><span class="hs-identifier hs-type">mapSnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679120594"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120593"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120592"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120594"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120591"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679120593"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120594"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120591"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679120592"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-52"></span><span id="mapSnd"><span class="annot"><span class="annottext">mapSnd :: (t1 -&gt; t2) -&gt; f (t, t1) -&gt; f (t, t2)
</span><a href="Text.Regex.TDFA.Common.html#mapSnd"><span class="hs-identifier hs-var hs-var">mapSnd</span></a></span></span><span> </span><span id="local-6989586621679120515"><span class="annot"><span class="annottext">f :: t1 -&gt; t2
</span><a href="#local-6989586621679120515"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((t, t1) -&gt; (t, t2)) -&gt; f (t, t1) -&gt; f (t, t2)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120514"><span class="annot"><span class="annottext">a :: t
</span><a href="#local-6989586621679120514"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679120513"><span class="annot"><span class="annottext">b :: t1
</span><a href="#local-6989586621679120513"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679120514"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t1 -&gt; t2
</span><a href="#local-6989586621679120515"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679120513"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621679120510"><span id="local-6989586621679120511"><span id="local-6989586621679120512"><span class="annot"><a href="Text.Regex.TDFA.Common.html#fst3"><span class="hs-identifier hs-type">fst3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679120511"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679120510"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120512"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-55"></span><span id="fst3"><span class="annot"><span class="annottext">fst3 :: (a, b, c) -&gt; a
</span><a href="Text.Regex.TDFA.Common.html#fst3"><span class="hs-identifier hs-var hs-var">fst3</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120508"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679120508"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120508"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span id="local-6989586621679120505"><span id="local-6989586621679120506"><span id="local-6989586621679120507"><span class="annot"><a href="Text.Regex.TDFA.Common.html#snd3"><span class="hs-identifier hs-type">snd3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120507"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679120506"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679120505"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120506"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-58"></span><span id="snd3"><span class="annot"><span class="annottext">snd3 :: (a, b, c) -&gt; b
</span><a href="Text.Regex.TDFA.Common.html#snd3"><span class="hs-identifier hs-var hs-var">snd3</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span id="local-6989586621679120503"><span class="annot"><span class="annottext">x :: b
</span><a href="#local-6989586621679120503"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120503"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span id="local-6989586621679120500"><span id="local-6989586621679120501"><span id="local-6989586621679120502"><span class="annot"><a href="Text.Regex.TDFA.Common.html#thd3"><span class="hs-identifier hs-type">thd3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679120501"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679120500"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120500"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-61"></span><span id="thd3"><span class="annot"><span class="annottext">thd3 :: (a, b, c) -&gt; c
</span><a href="Text.Regex.TDFA.Common.html#thd3"><span class="hs-identifier hs-var hs-var">thd3</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span id="local-6989586621679120498"><span class="annot"><span class="annottext">x :: c
</span><a href="#local-6989586621679120498"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679120498"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#flipOrder"><span class="hs-identifier hs-type">flipOrder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-64"></span><span id="flipOrder"><span class="annot"><span class="annottext">flipOrder :: Ordering -&gt; Ordering
</span><a href="Text.Regex.TDFA.Common.html#flipOrder"><span class="hs-identifier hs-var hs-var">flipOrder</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#flipOrder"><span class="hs-identifier hs-var">flipOrder</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#flipOrder"><span class="hs-identifier hs-var">flipOrder</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EQ</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#noWin"><span class="hs-identifier hs-type">noWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinTags"><span class="hs-identifier hs-type">WinTags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-69"></span><span id="noWin"><span class="annot"><span class="annottext">noWin :: WinTags -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#noWin"><span class="hs-identifier hs-var hs-var">noWin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WinTags -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Used to track elements of the pattern that accept characters or </span><span>
</span><span id="line-72"></span><span class="hs-comment">-- are anchors</span><span>
</span><span id="line-73"></span><span class="hs-keyword">newtype</span><span> </span><span id="DoPa"><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-var">DoPa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DoPa"><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-var">DoPa</span></a></span></span><span> </span><span class="hs-special">{</span><span id="dopaIndex"><span class="annot"><span class="annottext">DoPa -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#dopaIndex"><span class="hs-identifier hs-var hs-var">dopaIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120489"><span id="local-6989586621679120491"><span class="annot"><span class="annottext">DoPa -&gt; DoPa -&gt; Bool
(DoPa -&gt; DoPa -&gt; Bool) -&gt; (DoPa -&gt; DoPa -&gt; Bool) -&gt; Eq DoPa
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DoPa -&gt; DoPa -&gt; Bool
$c/= :: DoPa -&gt; DoPa -&gt; Bool
== :: DoPa -&gt; DoPa -&gt; Bool
$c== :: DoPa -&gt; DoPa -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120473"><span id="local-6989586621679120475"><span id="local-6989586621679120477"><span id="local-6989586621679120479"><span id="local-6989586621679120481"><span id="local-6989586621679120483"><span id="local-6989586621679120485"><span class="annot"><span class="annottext">Eq DoPa
Eq DoPa =&gt;
(DoPa -&gt; DoPa -&gt; Ordering)
-&gt; (DoPa -&gt; DoPa -&gt; Bool)
-&gt; (DoPa -&gt; DoPa -&gt; Bool)
-&gt; (DoPa -&gt; DoPa -&gt; Bool)
-&gt; (DoPa -&gt; DoPa -&gt; Bool)
-&gt; (DoPa -&gt; DoPa -&gt; DoPa)
-&gt; (DoPa -&gt; DoPa -&gt; DoPa)
-&gt; Ord DoPa
DoPa -&gt; DoPa -&gt; Bool
DoPa -&gt; DoPa -&gt; Ordering
DoPa -&gt; DoPa -&gt; DoPa
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: DoPa -&gt; DoPa -&gt; DoPa
$cmin :: DoPa -&gt; DoPa -&gt; DoPa
max :: DoPa -&gt; DoPa -&gt; DoPa
$cmax :: DoPa -&gt; DoPa -&gt; DoPa
&gt;= :: DoPa -&gt; DoPa -&gt; Bool
$c&gt;= :: DoPa -&gt; DoPa -&gt; Bool
&gt; :: DoPa -&gt; DoPa -&gt; Bool
$c&gt; :: DoPa -&gt; DoPa -&gt; Bool
&lt;= :: DoPa -&gt; DoPa -&gt; Bool
$c&lt;= :: DoPa -&gt; DoPa -&gt; Bool
&lt; :: DoPa -&gt; DoPa -&gt; Bool
$c&lt; :: DoPa -&gt; DoPa -&gt; Bool
compare :: DoPa -&gt; DoPa -&gt; Ordering
$ccompare :: DoPa -&gt; DoPa -&gt; Ordering
$cp1Ord :: Eq DoPa
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120458"><span id="local-6989586621679120460"><span id="local-6989586621679120462"><span id="local-6989586621679120464"><span id="local-6989586621679120468"><span id="local-6989586621679120470"><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679120456"><span class="annot"><span class="annottext">toEnum :: Int -&gt; DoPa
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEnum</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; DoPa
</span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-var">DoPa</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621679120454"><span class="annot"><span class="annottext">fromEnum :: DoPa -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromEnum</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DoPa -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#dopaIndex"><span class="hs-identifier hs-var hs-var">dopaIndex</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120448"><span id="local-6989586621679120450"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679120446"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; DoPa -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679120444"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679120444"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">dopaIndex :: DoPa -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#dopaIndex"><span class="hs-identifier hs-var">dopaIndex</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621679120443"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120443"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-char">'#'</span></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String -&gt; String
forall a. Show a =&gt; Int -&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120444"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120443"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Control whether the pattern is multiline or case-sensitive like Text.Regex and whether to</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- capture the subgroups (\\1, \\2, etc).  Controls enabling extra anchor syntax.</span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="CompOption"><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CompOption"><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-85"></span><span>    </span><span id="caseSensitive"><span class="annot"><span class="annottext">CompOption -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#caseSensitive"><span class="hs-identifier hs-var hs-var">caseSensitive</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>    </span><span class="hs-comment">-- ^ True in blankCompOpt and defaultCompOpt</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="multiline"><span class="annot"><span class="annottext">CompOption -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#multiline"><span class="hs-identifier hs-var hs-var">multiline</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">{- ^ False in blankCompOpt, True in defaultCompOpt. Compile for
                      newline-sensitive matching.  &quot;By default, newline is a completely ordinary
                      character with no special meaning in either REs or strings.  With this flag,
                      inverted bracket expressions and . never match newline, a ^ anchor matches the
                      null string after any newline in the string in addition to its normal
                      function, and the $ anchor matches the null string before any newline in the
                      string in addition to its normal function.&quot; -}</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="rightAssoc"><span class="annot"><span class="annottext">CompOption -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#rightAssoc"><span class="hs-identifier hs-var hs-var">rightAssoc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>       </span><span class="hs-comment">-- ^ True (and therefore Right associative) in blankCompOpt and defaultCompOpt</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="newSyntax"><span class="annot"><span class="annottext">CompOption -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#newSyntax"><span class="hs-identifier hs-var hs-var">newSyntax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>        </span><span class="hs-comment">-- ^ False in blankCompOpt, True in defaultCompOpt. Add the extended non-POSIX syntax described in &quot;Text.Regex.TDFA&quot; haddock documentation.</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lastStarGreedy"><span class="annot"><span class="annottext">CompOption -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#lastStarGreedy"><span class="hs-identifier hs-var hs-var">lastStarGreedy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ False by default.  This is POSIX correct but it takes space and is slower.</span><span>
</span><span id="line-96"></span><span>                            </span><span class="hs-comment">-- Setting this to true will improve performance, and should be done</span><span>
</span><span id="line-97"></span><span>                            </span><span class="hs-comment">-- if you plan to set the captureGroups execoption to False.</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120428"><span id="local-6989586621679120430"><span id="local-6989586621679120432"><span id="local-6989586621679120434"><span class="annot"><span class="annottext">ReadPrec [CompOption]
ReadPrec CompOption
Int -&gt; ReadS CompOption
ReadS [CompOption]
(Int -&gt; ReadS CompOption)
-&gt; ReadS [CompOption]
-&gt; ReadPrec CompOption
-&gt; ReadPrec [CompOption]
-&gt; Read CompOption
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [CompOption]
$creadListPrec :: ReadPrec [CompOption]
readPrec :: ReadPrec CompOption
$creadPrec :: ReadPrec CompOption
readList :: ReadS [CompOption]
$creadList :: ReadS [CompOption]
readsPrec :: Int -&gt; ReadS CompOption
$creadsPrec :: Int -&gt; ReadS CompOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120421"><span id="local-6989586621679120423"><span id="local-6989586621679120425"><span class="annot"><span class="annottext">Int -&gt; CompOption -&gt; String -&gt; String
[CompOption] -&gt; String -&gt; String
CompOption -&gt; String
(Int -&gt; CompOption -&gt; String -&gt; String)
-&gt; (CompOption -&gt; String)
-&gt; ([CompOption] -&gt; String -&gt; String)
-&gt; Show CompOption
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [CompOption] -&gt; String -&gt; String
$cshowList :: [CompOption] -&gt; String -&gt; String
show :: CompOption -&gt; String
$cshow :: CompOption -&gt; String
showsPrec :: Int -&gt; CompOption -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; CompOption -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">data</span><span> </span><span id="ExecOption"><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExecOption"><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-101"></span><span>    </span><span id="captureGroups"><span class="annot"><span class="annottext">ExecOption -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#captureGroups"><span class="hs-identifier hs-var hs-var">captureGroups</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>    </span><span class="hs-comment">-- ^ True by default.  Set to False to improve speed (and space).</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120411"><span id="local-6989586621679120413"><span id="local-6989586621679120415"><span id="local-6989586621679120417"><span class="annot"><span class="annottext">ReadPrec [ExecOption]
ReadPrec ExecOption
Int -&gt; ReadS ExecOption
ReadS [ExecOption]
(Int -&gt; ReadS ExecOption)
-&gt; ReadS [ExecOption]
-&gt; ReadPrec ExecOption
-&gt; ReadPrec [ExecOption]
-&gt; Read ExecOption
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [ExecOption]
$creadListPrec :: ReadPrec [ExecOption]
readPrec :: ReadPrec ExecOption
$creadPrec :: ReadPrec ExecOption
readList :: ReadS [ExecOption]
$creadList :: ReadS [ExecOption]
readsPrec :: Int -&gt; ReadS ExecOption
$creadsPrec :: Int -&gt; ReadS ExecOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120405"><span id="local-6989586621679120407"><span id="local-6989586621679120409"><span class="annot"><span class="annottext">Int -&gt; ExecOption -&gt; String -&gt; String
[ExecOption] -&gt; String -&gt; String
ExecOption -&gt; String
(Int -&gt; ExecOption -&gt; String -&gt; String)
-&gt; (ExecOption -&gt; String)
-&gt; ([ExecOption] -&gt; String -&gt; String)
-&gt; Show ExecOption
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [ExecOption] -&gt; String -&gt; String
$cshowList :: [ExecOption] -&gt; String -&gt; String
show :: ExecOption -&gt; String
$cshow :: ExecOption -&gt; String
showsPrec :: Int -&gt; ExecOption -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; ExecOption -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Used by implementation to name certain Postions during</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- matching. Identity of Position tag to set during a transition</span><span>
</span><span id="line-106"></span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | Internal use to indicate type of tag and preference for larger or smaller Positions</span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="OP"><span class="annot"><a href="Text.Regex.TDFA.Common.html#OP"><span class="hs-identifier hs-var">OP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Maximize"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Maximize"><span class="hs-identifier hs-var">Maximize</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Minimize"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Minimize"><span class="hs-identifier hs-var">Minimize</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Orbit"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Orbit"><span class="hs-identifier hs-var">Orbit</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Ignore"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Ignore"><span class="hs-identifier hs-var">Ignore</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120396"><span id="local-6989586621679120398"><span class="annot"><span class="annottext">OP -&gt; OP -&gt; Bool
(OP -&gt; OP -&gt; Bool) -&gt; (OP -&gt; OP -&gt; Bool) -&gt; Eq OP
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OP -&gt; OP -&gt; Bool
$c/= :: OP -&gt; OP -&gt; Bool
== :: OP -&gt; OP -&gt; Bool
$c== :: OP -&gt; OP -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120390"><span id="local-6989586621679120392"><span id="local-6989586621679120394"><span class="annot"><span class="annottext">Int -&gt; OP -&gt; String -&gt; String
[OP] -&gt; String -&gt; String
OP -&gt; String
(Int -&gt; OP -&gt; String -&gt; String)
-&gt; (OP -&gt; String) -&gt; ([OP] -&gt; String -&gt; String) -&gt; Show OP
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [OP] -&gt; String -&gt; String
$cshowList :: [OP] -&gt; String -&gt; String
show :: OP -&gt; String
$cshow :: OP -&gt; String
showsPrec :: Int -&gt; OP -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; OP -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Internal NFA node identity number</span><span>
</span><span id="line-110"></span><span class="hs-keyword">type</span><span> </span><span id="Index"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-var">Index</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Internal DFA identity is this Set of NFA Index</span><span>
</span><span id="line-112"></span><span class="hs-keyword">type</span><span> </span><span id="SetIndex"><span class="annot"><a href="Text.Regex.TDFA.Common.html#SetIndex"><span class="hs-identifier hs-var">SetIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntSet</span></span><span> </span><span class="hs-comment">{- Index -}</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Index into the text being searched</span><span>
</span><span id="line-114"></span><span class="hs-keyword">type</span><span> </span><span id="Position"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-var">Position</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | GroupIndex is for indexing submatches from capturing</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- parenthesized groups (PGroup\/Group)</span><span>
</span><span id="line-118"></span><span class="hs-keyword">type</span><span> </span><span id="GroupIndex"><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier hs-var">GroupIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | GroupInfo collects the parent and tag information for an instance </span><span>
</span><span id="line-120"></span><span class="hs-comment">-- of a group</span><span>
</span><span id="line-121"></span><span class="hs-keyword">data</span><span> </span><span id="GroupInfo"><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupInfo"><span class="hs-identifier hs-var">GroupInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GroupInfo"><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupInfo"><span class="hs-identifier hs-var">GroupInfo</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-122"></span><span>    </span><span id="thisIndex"><span class="annot"><span class="annottext">GroupInfo -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#thisIndex"><span class="hs-identifier hs-var hs-var">thisIndex</span></a></span></span><span class="hs-special">,</span><span> </span><span id="parentIndex"><span class="annot"><span class="annottext">GroupInfo -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#parentIndex"><span class="hs-identifier hs-var hs-var">parentIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier hs-type">GroupIndex</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="startTag"><span class="annot"><span class="annottext">GroupInfo -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#startTag"><span class="hs-identifier hs-var hs-var">startTag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="stopTag"><span class="annot"><span class="annottext">GroupInfo -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#stopTag"><span class="hs-identifier hs-var hs-var">stopTag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="flagTag"><span class="annot"><span class="annottext">GroupInfo -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#flagTag"><span class="hs-identifier hs-var hs-var">flagTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679120375"><span id="local-6989586621679120377"><span id="local-6989586621679120379"><span class="annot"><span class="annottext">Int -&gt; GroupInfo -&gt; String -&gt; String
[GroupInfo] -&gt; String -&gt; String
GroupInfo -&gt; String
(Int -&gt; GroupInfo -&gt; String -&gt; String)
-&gt; (GroupInfo -&gt; String)
-&gt; ([GroupInfo] -&gt; String -&gt; String)
-&gt; Show GroupInfo
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [GroupInfo] -&gt; String -&gt; String
$cshowList :: [GroupInfo] -&gt; String -&gt; String
show :: GroupInfo -&gt; String
$cshow :: GroupInfo -&gt; String
showsPrec :: Int -&gt; GroupInfo -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; GroupInfo -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | The TDFA backend specific 'Regex' type, used by this module's RegexOptions and RegexMaker</span><span>
</span><span id="line-127"></span><span class="hs-keyword">data</span><span> </span><span id="Regex"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-var">Regex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Regex"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-var">Regex</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-128"></span><span>    </span><span id="regex_dfa"><span class="annot"><span class="annottext">Regex -&gt; DFA
</span><a href="Text.Regex.TDFA.Common.html#regex_dfa"><span class="hs-identifier hs-var hs-var">regex_dfa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a></span><span>                             </span><span class="hs-comment">-- ^ starting DFA state</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_init"><span class="annot"><span class="annottext">Regex -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#regex_init"><span class="hs-identifier hs-var hs-var">regex_init</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span>                          </span><span class="hs-comment">-- ^ index of starting state</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_b_index"><span class="annot"><span class="annottext">Regex -&gt; (Int, Int)
</span><a href="Text.Regex.TDFA.Common.html#regex_b_index"><span class="hs-identifier hs-var hs-var">regex_b_index</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span class="hs-special">)</span><span>               </span><span class="hs-comment">-- ^ indexes of smallest and largest states</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_b_tags"><span class="annot"><span class="annottext">Regex -&gt; (Int, Int)
</span><a href="Text.Regex.TDFA.Common.html#regex_b_tags"><span class="hs-identifier hs-var hs-var">regex_b_tags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">)</span><span>                    </span><span class="hs-comment">-- ^ indexes of smallest and largest tags</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_trie"><span class="annot"><span class="annottext">Regex -&gt; TrieSet DFA
</span><a href="Text.Regex.TDFA.Common.html#regex_trie"><span class="hs-identifier hs-var hs-var">regex_trie</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.IntArrTrieSet.html#TrieSet"><span class="hs-identifier hs-type">TrieSet</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a></span><span>                    </span><span class="hs-comment">-- ^ All DFA states</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_tags"><span class="annot"><span class="annottext">Regex -&gt; Array Int OP
</span><a href="Text.Regex.TDFA.Common.html#regex_tags"><span class="hs-identifier hs-var hs-var">regex_tags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#OP"><span class="hs-identifier hs-type">OP</span></a></span><span>                   </span><span class="hs-comment">-- ^ information about each tag</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_groups"><span class="annot"><span class="annottext">Regex -&gt; Array Int [GroupInfo]
</span><a href="Text.Regex.TDFA.Common.html#regex_groups"><span class="hs-identifier hs-var hs-var">regex_groups</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier hs-type">GroupIndex</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupInfo"><span class="hs-identifier hs-type">GroupInfo</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ information about each group</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_isFrontAnchored"><span class="annot"><span class="annottext">Regex -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#regex_isFrontAnchored"><span class="hs-identifier hs-var hs-var">regex_isFrontAnchored</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                </span><span class="hs-comment">-- ^ used for optimizing execution</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_compOptions"><span class="annot"><span class="annottext">Regex -&gt; CompOption
</span><a href="Text.Regex.TDFA.Common.html#regex_compOptions"><span class="hs-identifier hs-var hs-var">regex_compOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regex_execOptions"><span class="annot"><span class="annottext">Regex -&gt; ExecOption
</span><a href="Text.Regex.TDFA.Common.html#regex_execOptions"><span class="hs-identifier hs-var hs-var">regex_execOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- no deriving at all, the DFA may be too big to ever traverse!</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RegexOptions</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679120356"><span class="annot"><span class="annottext">blankCompOpt :: CompOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">blankCompOpt</span></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">CompOption :: Bool -&gt; Bool -&gt; Bool -&gt; Bool -&gt; Bool -&gt; CompOption
</span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type hs-type">CompOption</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">caseSensitive :: Bool
</span><a href="Text.Regex.TDFA.Common.html#caseSensitive"><span class="hs-identifier hs-var">caseSensitive</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-143"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">multiline :: Bool
</span><a href="Text.Regex.TDFA.Common.html#multiline"><span class="hs-identifier hs-var">multiline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-144"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rightAssoc :: Bool
</span><a href="Text.Regex.TDFA.Common.html#rightAssoc"><span class="hs-identifier hs-var">rightAssoc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-145"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">newSyntax :: Bool
</span><a href="Text.Regex.TDFA.Common.html#newSyntax"><span class="hs-identifier hs-var">newSyntax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-146"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lastStarGreedy :: Bool
</span><a href="Text.Regex.TDFA.Common.html#lastStarGreedy"><span class="hs-identifier hs-var">lastStarGreedy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-147"></span><span>                             </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679120353"><span class="annot"><span class="annottext">blankExecOpt :: ExecOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">blankExecOpt</span></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">ExecOption :: Bool -&gt; ExecOption
</span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type hs-type">ExecOption</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">captureGroups :: Bool
</span><a href="Text.Regex.TDFA.Common.html#captureGroups"><span class="hs-identifier hs-var">captureGroups</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679120350"><span class="annot"><span class="annottext">defaultCompOpt :: CompOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultCompOpt</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOption :: Bool -&gt; Bool -&gt; Bool -&gt; Bool -&gt; Bool -&gt; CompOption
</span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type hs-type">CompOption</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">caseSensitive :: Bool
</span><a href="Text.Regex.TDFA.Common.html#caseSensitive"><span class="hs-identifier hs-var">caseSensitive</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-150"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">multiline :: Bool
</span><a href="Text.Regex.TDFA.Common.html#multiline"><span class="hs-identifier hs-var">multiline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-151"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rightAssoc :: Bool
</span><a href="Text.Regex.TDFA.Common.html#rightAssoc"><span class="hs-identifier hs-var">rightAssoc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-152"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">newSyntax :: Bool
</span><a href="Text.Regex.TDFA.Common.html#newSyntax"><span class="hs-identifier hs-var">newSyntax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-153"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lastStarGreedy :: Bool
</span><a href="Text.Regex.TDFA.Common.html#lastStarGreedy"><span class="hs-identifier hs-var">lastStarGreedy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-154"></span><span>                              </span><span class="hs-special">}</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679120348"><span class="annot"><span class="annottext">defaultExecOpt :: ExecOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultExecOpt</span></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">ExecOption :: Bool -&gt; ExecOption
</span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type hs-type">ExecOption</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">captureGroups :: Bool
</span><a href="Text.Regex.TDFA.Common.html#captureGroups"><span class="hs-identifier hs-var">captureGroups</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679120346"><span class="annot"><span class="annottext">setExecOpts :: ExecOption -&gt; Regex -&gt; Regex
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">setExecOpts</span></span></span><span> </span><span id="local-6989586621679120344"><span class="annot"><span class="annottext">e :: ExecOption
</span><a href="#local-6989586621679120344"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679120343"><span class="annot"><span class="annottext">r :: Regex
</span><a href="#local-6989586621679120343"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679120343"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">regex_execOptions :: ExecOption
</span><a href="Text.Regex.TDFA.Common.html#regex_execOptions"><span class="hs-identifier hs-var">regex_execOptions</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679120344"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679120342"><span class="annot"><span class="annottext">getExecOpts :: Regex -&gt; ExecOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">getExecOpts</span></span></span><span> </span><span id="local-6989586621679120340"><span class="annot"><span class="annottext">r :: Regex
</span><a href="#local-6989586621679120340"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; ExecOption
</span><a href="Text.Regex.TDFA.Common.html#regex_execOptions"><span class="hs-identifier hs-var hs-var">regex_execOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679120340"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-keyword">data</span><span> </span><span id="WinEmpty"><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier hs-var">WinEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WinEmpty"><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier hs-var">WinEmpty</span></a></span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a></span><span>
</span><span id="line-161"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="WinTest"><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinTest"><span class="hs-identifier hs-var">WinTest</span></a></span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier hs-type">WhichTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier hs-type">WinEmpty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier hs-type">WinEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679120332"><span id="local-6989586621679120334"><span id="local-6989586621679120336"><span class="annot"><span class="annottext">Int -&gt; WinEmpty -&gt; String -&gt; String
[WinEmpty] -&gt; String -&gt; String
WinEmpty -&gt; String
(Int -&gt; WinEmpty -&gt; String -&gt; String)
-&gt; (WinEmpty -&gt; String)
-&gt; ([WinEmpty] -&gt; String -&gt; String)
-&gt; Show WinEmpty
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [WinEmpty] -&gt; String -&gt; String
$cshowList :: [WinEmpty] -&gt; String -&gt; String
show :: WinEmpty -&gt; String
$cshow :: WinEmpty -&gt; String
showsPrec :: Int -&gt; WinEmpty -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; WinEmpty -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Internal NFA node type</span><span>
</span><span id="line-165"></span><span class="hs-keyword">data</span><span> </span><span id="QNFA"><span class="annot"><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier hs-var">QNFA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QNFA"><span class="annot"><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier hs-var">QNFA</span></a></span></span><span> </span><span class="hs-special">{</span><span id="q_id"><span class="annot"><span class="annottext">QNFA -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#q_id"><span class="hs-identifier hs-var hs-var">q_id</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span class="hs-special">,</span><span> </span><span id="q_qt"><span class="annot"><span class="annottext">QNFA -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#q_qt"><span class="hs-identifier hs-var hs-var">q_qt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Internal to QNFA type.</span><span>
</span><span id="line-168"></span><span class="hs-keyword">data</span><span> </span><span id="QT"><span class="annot"><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-var">QT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Simple"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier hs-var">Simple</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="qt_win"><span class="annot"><span class="annottext">QT -&gt; WinTags
</span><a href="Text.Regex.TDFA.Common.html#qt_win"><span class="hs-identifier hs-var hs-var">qt_win</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinTags"><span class="hs-identifier hs-type">WinTags</span></a></span><span> </span><span class="hs-comment">-- ^ empty transitions to the virtual winning state</span><span>
</span><span id="line-169"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="qt_trans"><span class="annot"><span class="annottext">QT -&gt; CharMap QTrans
</span><a href="Text.Regex.TDFA.Common.html#qt_trans"><span class="hs-identifier hs-var hs-var">qt_trans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a></span><span> </span><span class="hs-comment">-- ^ all ways to leave this QNFA to other or the same QNFA</span><span>
</span><span id="line-170"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="qt_other"><span class="annot"><span class="annottext">QT -&gt; QTrans
</span><a href="Text.Regex.TDFA.Common.html#qt_other"><span class="hs-identifier hs-var hs-var">qt_other</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a></span><span> </span><span class="hs-comment">-- ^ default ways to leave this QNFA to other or the same QNFA</span><span>
</span><span id="line-171"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="Testing"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier hs-var">Testing</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="qt_test"><span class="annot"><span class="annottext">QT -&gt; WhichTest
</span><a href="Text.Regex.TDFA.Common.html#qt_test"><span class="hs-identifier hs-var hs-var">qt_test</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier hs-type">WhichTest</span></a></span><span> </span><span class="hs-comment">-- ^ The test to perform</span><span>
</span><span id="line-173"></span><span>                  </span><span class="hs-special">,</span><span> </span><span id="qt_dopas"><span class="annot"><span class="annottext">QT -&gt; EnumSet DoPa
</span><a href="Text.Regex.TDFA.Common.html#qt_dopas"><span class="hs-identifier hs-var hs-var">qt_dopas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntSet.EnumSet2.html#EnumSet"><span class="hs-identifier hs-type">EnumSet</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span>  </span><span class="hs-comment">-- ^ location(s) of the anchor(s) in the original regexp</span><span>
</span><span id="line-174"></span><span>                  </span><span class="hs-special">,</span><span> </span><span id="qt_a"><span class="annot"><span class="annottext">QT -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#qt_a"><span class="hs-identifier hs-var hs-var">qt_a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="qt_b"><span class="annot"><span class="annottext">QT -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#qt_b"><span class="hs-identifier hs-var hs-var">qt_b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a></span><span> </span><span class="hs-comment">-- ^ use qt_a if test is True, else use qt_b</span><span>
</span><span id="line-175"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Internal type to represent the tagged transition from one QNFA to</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- another (or itself).  The key is the Index of the destination QNFA.</span><span>
</span><span id="line-179"></span><span class="hs-keyword">type</span><span> </span><span id="QTrans"><span class="annot"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-var">QTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-comment">{- Destination Index -}</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier hs-type">TagCommand</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Known predicates, just Beginning of Line (^) and End of Line ($).</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- Also support for GNU extensions is being added: \\\` beginning of</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- buffer, \\\' end of buffer, \\\&lt; and \\\&gt; for begin and end of words, \\b</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- and \\B for word boundary and not word boundary.</span><span>
</span><span id="line-185"></span><span class="hs-keyword">data</span><span> </span><span id="WhichTest"><span class="annot"><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier hs-var">WhichTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Test_BOL"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_BOL"><span class="hs-identifier hs-var">Test_BOL</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Test_EOL"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_EOL"><span class="hs-identifier hs-var">Test_EOL</span></a></span></span><span> </span><span class="hs-comment">-- '^' and '$' (affected by multiline option)</span><span>
</span><span id="line-186"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Test_BOB"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_BOB"><span class="hs-identifier hs-var">Test_BOB</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Test_EOB"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_EOB"><span class="hs-identifier hs-var">Test_EOB</span></a></span></span><span> </span><span class="hs-comment">-- \` and \' begin and end buffer</span><span>
</span><span id="line-187"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Test_BOW"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_BOW"><span class="hs-identifier hs-var">Test_BOW</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Test_EOW"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_EOW"><span class="hs-identifier hs-var">Test_EOW</span></a></span></span><span> </span><span class="hs-comment">-- \&lt; and \&gt; begin and end word</span><span>
</span><span id="line-188"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Test_EdgeWord"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_EdgeWord"><span class="hs-identifier hs-var">Test_EdgeWord</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Test_NotEdgeWord"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Test_NotEdgeWord"><span class="hs-identifier hs-var">Test_NotEdgeWord</span></a></span></span><span> </span><span class="hs-comment">-- \b and \B word boundaries</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120306"><span id="local-6989586621679120308"><span id="local-6989586621679120310"><span class="annot"><span class="annottext">Int -&gt; WhichTest -&gt; String -&gt; String
[WhichTest] -&gt; String -&gt; String
WhichTest -&gt; String
(Int -&gt; WhichTest -&gt; String -&gt; String)
-&gt; (WhichTest -&gt; String)
-&gt; ([WhichTest] -&gt; String -&gt; String)
-&gt; Show WhichTest
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [WhichTest] -&gt; String -&gt; String
$cshowList :: [WhichTest] -&gt; String -&gt; String
show :: WhichTest -&gt; String
$cshow :: WhichTest -&gt; String
showsPrec :: Int -&gt; WhichTest -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; WhichTest -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120302"><span id="local-6989586621679120304"><span class="annot"><span class="annottext">WhichTest -&gt; WhichTest -&gt; Bool
(WhichTest -&gt; WhichTest -&gt; Bool)
-&gt; (WhichTest -&gt; WhichTest -&gt; Bool) -&gt; Eq WhichTest
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: WhichTest -&gt; WhichTest -&gt; Bool
$c/= :: WhichTest -&gt; WhichTest -&gt; Bool
== :: WhichTest -&gt; WhichTest -&gt; Bool
$c== :: WhichTest -&gt; WhichTest -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120287"><span id="local-6989586621679120289"><span id="local-6989586621679120291"><span id="local-6989586621679120293"><span id="local-6989586621679120295"><span id="local-6989586621679120297"><span id="local-6989586621679120299"><span class="annot"><span class="annottext">Eq WhichTest
Eq WhichTest =&gt;
(WhichTest -&gt; WhichTest -&gt; Ordering)
-&gt; (WhichTest -&gt; WhichTest -&gt; Bool)
-&gt; (WhichTest -&gt; WhichTest -&gt; Bool)
-&gt; (WhichTest -&gt; WhichTest -&gt; Bool)
-&gt; (WhichTest -&gt; WhichTest -&gt; Bool)
-&gt; (WhichTest -&gt; WhichTest -&gt; WhichTest)
-&gt; (WhichTest -&gt; WhichTest -&gt; WhichTest)
-&gt; Ord WhichTest
WhichTest -&gt; WhichTest -&gt; Bool
WhichTest -&gt; WhichTest -&gt; Ordering
WhichTest -&gt; WhichTest -&gt; WhichTest
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: WhichTest -&gt; WhichTest -&gt; WhichTest
$cmin :: WhichTest -&gt; WhichTest -&gt; WhichTest
max :: WhichTest -&gt; WhichTest -&gt; WhichTest
$cmax :: WhichTest -&gt; WhichTest -&gt; WhichTest
&gt;= :: WhichTest -&gt; WhichTest -&gt; Bool
$c&gt;= :: WhichTest -&gt; WhichTest -&gt; Bool
&gt; :: WhichTest -&gt; WhichTest -&gt; Bool
$c&gt; :: WhichTest -&gt; WhichTest -&gt; Bool
&lt;= :: WhichTest -&gt; WhichTest -&gt; Bool
$c&lt;= :: WhichTest -&gt; WhichTest -&gt; Bool
&lt; :: WhichTest -&gt; WhichTest -&gt; Bool
$c&lt; :: WhichTest -&gt; WhichTest -&gt; Bool
compare :: WhichTest -&gt; WhichTest -&gt; Ordering
$ccompare :: WhichTest -&gt; WhichTest -&gt; Ordering
$cp1Ord :: Eq WhichTest
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120271"><span id="local-6989586621679120273"><span id="local-6989586621679120275"><span id="local-6989586621679120277"><span id="local-6989586621679120279"><span id="local-6989586621679120281"><span id="local-6989586621679120283"><span id="local-6989586621679120285"><span class="annot"><span class="annottext">Int -&gt; WhichTest
WhichTest -&gt; Int
WhichTest -&gt; [WhichTest]
WhichTest -&gt; WhichTest
WhichTest -&gt; WhichTest -&gt; [WhichTest]
WhichTest -&gt; WhichTest -&gt; WhichTest -&gt; [WhichTest]
(WhichTest -&gt; WhichTest)
-&gt; (WhichTest -&gt; WhichTest)
-&gt; (Int -&gt; WhichTest)
-&gt; (WhichTest -&gt; Int)
-&gt; (WhichTest -&gt; [WhichTest])
-&gt; (WhichTest -&gt; WhichTest -&gt; [WhichTest])
-&gt; (WhichTest -&gt; WhichTest -&gt; [WhichTest])
-&gt; (WhichTest -&gt; WhichTest -&gt; WhichTest -&gt; [WhichTest])
-&gt; Enum WhichTest
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: WhichTest -&gt; WhichTest -&gt; WhichTest -&gt; [WhichTest]
$cenumFromThenTo :: WhichTest -&gt; WhichTest -&gt; WhichTest -&gt; [WhichTest]
enumFromTo :: WhichTest -&gt; WhichTest -&gt; [WhichTest]
$cenumFromTo :: WhichTest -&gt; WhichTest -&gt; [WhichTest]
enumFromThen :: WhichTest -&gt; WhichTest -&gt; [WhichTest]
$cenumFromThen :: WhichTest -&gt; WhichTest -&gt; [WhichTest]
enumFrom :: WhichTest -&gt; [WhichTest]
$cenumFrom :: WhichTest -&gt; [WhichTest]
fromEnum :: WhichTest -&gt; Int
$cfromEnum :: WhichTest -&gt; Int
toEnum :: Int -&gt; WhichTest
$ctoEnum :: Int -&gt; WhichTest
pred :: WhichTest -&gt; WhichTest
$cpred :: WhichTest -&gt; WhichTest
succ :: WhichTest -&gt; WhichTest
$csucc :: WhichTest -&gt; WhichTest
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | The things that can be done with a Tag.  TagTask and</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- ResetGroupStopTask are for tags with Maximize or Minimize OP</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- values.  ResetOrbitTask and EnterOrbitTask and LeaveOrbitTask are</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- for tags with Orbit OP value.</span><span>
</span><span id="line-195"></span><span class="hs-keyword">data</span><span> </span><span id="TagTask"><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-var">TagTask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TagTask"><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-var">TagTask</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="ResetGroupStopTask"><span class="annot"><a href="Text.Regex.TDFA.Common.html#ResetGroupStopTask"><span class="hs-identifier hs-var">ResetGroupStopTask</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SetGroupStopTask"><span class="annot"><a href="Text.Regex.TDFA.Common.html#SetGroupStopTask"><span class="hs-identifier hs-var">SetGroupStopTask</span></a></span></span><span>
</span><span id="line-196"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="ResetOrbitTask"><span class="annot"><a href="Text.Regex.TDFA.Common.html#ResetOrbitTask"><span class="hs-identifier hs-var">ResetOrbitTask</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="EnterOrbitTask"><span class="annot"><a href="Text.Regex.TDFA.Common.html#EnterOrbitTask"><span class="hs-identifier hs-var">EnterOrbitTask</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="LeaveOrbitTask"><span class="annot"><a href="Text.Regex.TDFA.Common.html#LeaveOrbitTask"><span class="hs-identifier hs-var">LeaveOrbitTask</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120259"><span id="local-6989586621679120261"><span id="local-6989586621679120263"><span class="annot"><span class="annottext">Int -&gt; TagTask -&gt; String -&gt; String
[TagTask] -&gt; String -&gt; String
TagTask -&gt; String
(Int -&gt; TagTask -&gt; String -&gt; String)
-&gt; (TagTask -&gt; String)
-&gt; ([TagTask] -&gt; String -&gt; String)
-&gt; Show TagTask
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [TagTask] -&gt; String -&gt; String
$cshowList :: [TagTask] -&gt; String -&gt; String
show :: TagTask -&gt; String
$cshow :: TagTask -&gt; String
showsPrec :: Int -&gt; TagTask -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; TagTask -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120255"><span id="local-6989586621679120257"><span class="annot"><span class="annottext">TagTask -&gt; TagTask -&gt; Bool
(TagTask -&gt; TagTask -&gt; Bool)
-&gt; (TagTask -&gt; TagTask -&gt; Bool) -&gt; Eq TagTask
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TagTask -&gt; TagTask -&gt; Bool
$c/= :: TagTask -&gt; TagTask -&gt; Bool
== :: TagTask -&gt; TagTask -&gt; Bool
$c== :: TagTask -&gt; TagTask -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Ordered list of tags and their associated Task</span><span>
</span><span id="line-199"></span><span class="hs-keyword">type</span><span> </span><span id="TagTasks"><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagTasks"><span class="hs-identifier hs-var">TagTasks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-type">TagTask</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | When attached to a QTrans the TagTask can be done before or after</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- accepting the character.</span><span>
</span><span id="line-202"></span><span class="hs-keyword">data</span><span> </span><span id="TagUpdate"><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagUpdate"><span class="hs-identifier hs-var">TagUpdate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PreUpdate"><span class="annot"><a href="Text.Regex.TDFA.Common.html#PreUpdate"><span class="hs-identifier hs-var">PreUpdate</span></a></span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-type">TagTask</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="PostUpdate"><span class="annot"><a href="Text.Regex.TDFA.Common.html#PostUpdate"><span class="hs-identifier hs-var">PostUpdate</span></a></span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-type">TagTask</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120246"><span id="local-6989586621679120248"><span id="local-6989586621679120250"><span class="annot"><span class="annottext">Int -&gt; TagUpdate -&gt; String -&gt; String
[TagUpdate] -&gt; String -&gt; String
TagUpdate -&gt; String
(Int -&gt; TagUpdate -&gt; String -&gt; String)
-&gt; (TagUpdate -&gt; String)
-&gt; ([TagUpdate] -&gt; String -&gt; String)
-&gt; Show TagUpdate
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [TagUpdate] -&gt; String -&gt; String
$cshowList :: [TagUpdate] -&gt; String -&gt; String
show :: TagUpdate -&gt; String
$cshow :: TagUpdate -&gt; String
showsPrec :: Int -&gt; TagUpdate -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; TagUpdate -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120242"><span id="local-6989586621679120244"><span class="annot"><span class="annottext">TagUpdate -&gt; TagUpdate -&gt; Bool
(TagUpdate -&gt; TagUpdate -&gt; Bool)
-&gt; (TagUpdate -&gt; TagUpdate -&gt; Bool) -&gt; Eq TagUpdate
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TagUpdate -&gt; TagUpdate -&gt; Bool
$c/= :: TagUpdate -&gt; TagUpdate -&gt; Bool
== :: TagUpdate -&gt; TagUpdate -&gt; Bool
$c== :: TagUpdate -&gt; TagUpdate -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Ordered list of tags and their associated update operation.</span><span>
</span><span id="line-204"></span><span class="hs-keyword">type</span><span> </span><span id="TagList"><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagList"><span class="hs-identifier hs-var">TagList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagUpdate"><span class="hs-identifier hs-type">TagUpdate</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | A TagList and the location of the item in the original pattern</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- that is being accepted.</span><span>
</span><span id="line-207"></span><span class="hs-keyword">type</span><span> </span><span id="TagCommand"><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier hs-var">TagCommand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagList"><span class="hs-identifier hs-type">TagList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Ordered list of tags and their associated update operation to</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- perform on an empty transition to the virtual winning state.</span><span>
</span><span id="line-210"></span><span class="hs-keyword">type</span><span> </span><span id="WinTags"><span class="annot"><a href="Text.Regex.TDFA.Common.html#WinTags"><span class="hs-identifier hs-var">WinTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagList"><span class="hs-identifier hs-type">TagList</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">-- | Internal DFA node, identified by the Set of indices of the QNFA</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- nodes it represents.</span><span>
</span><span id="line-214"></span><span class="hs-keyword">data</span><span> </span><span id="DFA"><span class="annot"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-var">DFA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DFA"><span class="annot"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-var">DFA</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="d_id"><span class="annot"><span class="annottext">DFA -&gt; SetIndex
</span><a href="Text.Regex.TDFA.Common.html#d_id"><span class="hs-identifier hs-var hs-var">d_id</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#SetIndex"><span class="hs-identifier hs-type">SetIndex</span></a></span><span class="hs-special">,</span><span> </span><span id="d_dt"><span class="annot"><span class="annottext">DFA -&gt; DT
</span><a href="Text.Regex.TDFA.Common.html#d_dt"><span class="hs-identifier hs-var hs-var">d_dt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span id="local-6989586621679120232"><span id="local-6989586621679120234"><span id="local-6989586621679120236"><span class="annot"><span class="annottext">Int -&gt; DFA -&gt; String -&gt; String
[DFA] -&gt; String -&gt; String
DFA -&gt; String
(Int -&gt; DFA -&gt; String -&gt; String)
-&gt; (DFA -&gt; String) -&gt; ([DFA] -&gt; String -&gt; String) -&gt; Show DFA
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [DFA] -&gt; String -&gt; String
$cshowList :: [DFA] -&gt; String -&gt; String
show :: DFA -&gt; String
$cshow :: DFA -&gt; String
showsPrec :: Int -&gt; DFA -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; DFA -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span class="hs-keyword">data</span><span> </span><span id="Transition"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-var">Transition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Transition"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-var">Transition</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="trans_many"><span class="annot"><span class="annottext">Transition -&gt; DFA
</span><a href="Text.Regex.TDFA.Common.html#trans_many"><span class="hs-identifier hs-var hs-var">trans_many</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a></span><span>    </span><span class="hs-comment">-- ^ where to go (maximal), including respawning</span><span>
</span><span id="line-216"></span><span>                             </span><span class="hs-special">,</span><span> </span><span id="trans_single"><span class="annot"><span class="annottext">Transition -&gt; DFA
</span><a href="Text.Regex.TDFA.Common.html#trans_single"><span class="hs-identifier hs-var hs-var">trans_single</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a></span><span>  </span><span class="hs-comment">-- ^ where to go, not including respawning</span><span>
</span><span id="line-217"></span><span>                             </span><span class="hs-special">,</span><span> </span><span id="trans_how"><span class="annot"><span class="annottext">Transition -&gt; DTrans
</span><a href="Text.Regex.TDFA.Common.html#trans_how"><span class="hs-identifier hs-var hs-var">trans_how</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DTrans"><span class="hs-identifier hs-type">DTrans</span></a></span><span>    </span><span class="hs-comment">-- ^ how to go, including respawning</span><span>
</span><span id="line-218"></span><span>                             </span><span class="hs-special">}</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Internal to the DFA node</span><span>
</span><span id="line-220"></span><span class="hs-keyword">data</span><span> </span><span id="DT"><span class="annot"><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-var">DT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Simple%27"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Simple%27"><span class="hs-identifier hs-var">Simple'</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="dt_win"><span class="annot"><span class="annottext">DT -&gt; IntMap Instructions
</span><a href="Text.Regex.TDFA.Common.html#dt_win"><span class="hs-identifier hs-var hs-var">dt_win</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-comment">{- Source Index -}</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a></span><span> </span><span class="hs-comment">-- ^ Actions to perform to win</span><span>
</span><span id="line-221"></span><span>                  </span><span class="hs-special">,</span><span> </span><span id="dt_trans"><span class="annot"><span class="annottext">DT -&gt; CharMap Transition
</span><a href="Text.Regex.TDFA.Common.html#dt_trans"><span class="hs-identifier hs-var hs-var">dt_trans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="hs-comment">-- ^ Transition to accept Char</span><span>
</span><span id="line-222"></span><span>                  </span><span class="hs-special">,</span><span> </span><span id="dt_other"><span class="annot"><span class="annottext">DT -&gt; Transition
</span><a href="Text.Regex.TDFA.Common.html#dt_other"><span class="hs-identifier hs-var hs-var">dt_other</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="hs-comment">-- ^ default accepting transition</span><span>
</span><span id="line-223"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="Testing%27"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Testing%27"><span class="hs-identifier hs-var">Testing'</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="dt_test"><span class="annot"><span class="annottext">DT -&gt; WhichTest
</span><a href="Text.Regex.TDFA.Common.html#dt_test"><span class="hs-identifier hs-var hs-var">dt_test</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier hs-type">WhichTest</span></a></span><span> </span><span class="hs-comment">-- ^ The test to perform</span><span>
</span><span id="line-225"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="dt_dopas"><span class="annot"><span class="annottext">DT -&gt; EnumSet DoPa
</span><a href="Text.Regex.TDFA.Common.html#dt_dopas"><span class="hs-identifier hs-var hs-var">dt_dopas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntSet.EnumSet2.html#EnumSet"><span class="hs-identifier hs-type">EnumSet</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span> </span><span class="hs-comment">-- ^ location(s) of the anchor(s) in the original regexp</span><span>
</span><span id="line-226"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="dt_a"><span class="annot"><span class="annottext">DT -&gt; DT
</span><a href="Text.Regex.TDFA.Common.html#dt_a"><span class="hs-identifier hs-var hs-var">dt_a</span></a></span></span><span class="hs-special">,</span><span id="dt_b"><span class="annot"><span class="annottext">DT -&gt; DT
</span><a href="Text.Regex.TDFA.Common.html#dt_b"><span class="hs-identifier hs-var hs-var">dt_b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a></span><span>      </span><span class="hs-comment">-- ^ use dt_a if test is True else use dt_b</span><span>
</span><span id="line-227"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | Internal type to repesent the commands for the tagged transition.</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- The outer IntMap is for the destination Index and the inner IntMap</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- is for the Source Index.  This is convenient since all runtime data</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- going to the same destination must be compared to find the best.</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- A Destination IntMap entry may have an empty Source IntMap if and</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- only if the destination is the starting index and the NFA\/DFA.</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- This instructs the matching engine to spawn a new entry starting at</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- the post-update position.</span><span>
</span><span id="line-238"></span><span class="hs-keyword">type</span><span> </span><span id="DTrans"><span class="annot"><a href="Text.Regex.TDFA.Common.html#DTrans"><span class="hs-identifier hs-var">DTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-comment">{- Index of Destination -}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-comment">{- Index of Source -}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- type DTrans = IntMap {- Index of Destination -} (IntMap {- Index of Source -} (DoPa,RunState ()))</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | Internal convenience type for the text display code</span><span>
</span><span id="line-241"></span><span class="hs-keyword">type</span><span> </span><span id="DTrans%27"><span class="annot"><a href="Text.Regex.TDFA.Common.html#DTrans%27"><span class="hs-identifier hs-var">DTrans'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Positions for which a * was re-started while looping.  Need to</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- append locations at back but compare starting with front, so use</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- Seq as a Queue.  The initial position is saved in basePos (and a</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- Maximize Tag), the middle positions in the Seq, and the final</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- position is NOT saved in the Orbits (only in a Maximize Tag).</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- The orderinal code is being written XXX TODO document it.</span><span>
</span><span id="line-250"></span><span class="hs-keyword">data</span><span> </span><span id="Orbits"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Orbits"><span class="hs-identifier hs-var">Orbits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Orbits"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Orbits"><span class="hs-identifier hs-var">Orbits</span></a></span></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="inOrbit"><span class="annot"><span class="annottext">Orbits -&gt; Bool
</span><a href="Text.Regex.TDFA.Common.html#inOrbit"><span class="hs-identifier hs-var hs-var">inOrbit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>        </span><span class="hs-comment">-- True if enterOrbit, False if LeaveOrbit</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="basePos"><span class="annot"><span class="annottext">Orbits -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#basePos"><span class="hs-identifier hs-var hs-var">basePos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ordinal"><span class="annot"><span class="annottext">Orbits -&gt; Maybe Int
</span><a href="Text.Regex.TDFA.Common.html#ordinal"><span class="hs-identifier hs-var hs-var">ordinal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="getOrbits"><span class="annot"><span class="annottext">Orbits -&gt; Seq Int
</span><a href="Text.Regex.TDFA.Common.html#getOrbits"><span class="hs-identifier hs-var hs-var">getOrbits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120207"><span id="local-6989586621679120209"><span id="local-6989586621679120211"><span class="annot"><span class="annottext">Int -&gt; Orbits -&gt; String -&gt; String
[Orbits] -&gt; String -&gt; String
Orbits -&gt; String
(Int -&gt; Orbits -&gt; String -&gt; String)
-&gt; (Orbits -&gt; String)
-&gt; ([Orbits] -&gt; String -&gt; String)
-&gt; Show Orbits
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Orbits] -&gt; String -&gt; String
$cshowList :: [Orbits] -&gt; String -&gt; String
show :: Orbits -&gt; String
$cshow :: Orbits -&gt; String
showsPrec :: Int -&gt; Orbits -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; Orbits -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | The 'newPos' and 'newFlags' lists in Instructions are sorted by, and unique in, the Tag values</span><span>
</span><span id="line-258"></span><span class="hs-keyword">data</span><span> </span><span id="Instructions"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-var">Instructions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Instructions"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-var">Instructions</span></a></span></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="newPos"><span class="annot"><span class="annottext">Instructions -&gt; [(Int, Action)]
</span><a href="Text.Regex.TDFA.Common.html#newPos"><span class="hs-identifier hs-var hs-var">newPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- False is preUpdate, True is postUpdate (there are no Orbit tags here) -- 2009 : Change to enum from bool?</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="newOrbits"><span class="annot"><span class="annottext">Instructions -&gt; Maybe (Int -&gt; OrbitTransformer)
</span><a href="Text.Regex.TDFA.Common.html#newOrbits"><span class="hs-identifier hs-var hs-var">newOrbits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#OrbitTransformer"><span class="hs-identifier hs-type">OrbitTransformer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120199"><span id="local-6989586621679120201"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679120198"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Instructions -&gt; String -&gt; String
</span><a href="#local-6989586621679120198"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679120197"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679120197"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a></span><span> </span><span id="local-6989586621679120196"><span class="annot"><span class="annottext">pos :: [(Int, Action)]
</span><a href="#local-6989586621679120196"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (String -&gt; String) -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120197"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">11</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((String -&gt; String) -&gt; String -&gt; String)
-&gt; (String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Instructions {&quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="hs-string">&quot;newPos = &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; [(Int, Action)] -&gt; String -&gt; String
forall a. Show a =&gt; Int -&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Action)]
</span><a href="#local-6989586621679120196"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="hs-string">&quot;newOrbits = &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&lt;function&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">data</span><span> </span><span id="Action"><span class="annot"><a href="Text.Regex.TDFA.Common.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SetPre"><span class="annot"><a href="Text.Regex.TDFA.Common.html#SetPre"><span class="hs-identifier hs-var">SetPre</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SetPost"><span class="annot"><a href="Text.Regex.TDFA.Common.html#SetPost"><span class="hs-identifier hs-var">SetPost</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SetVal"><span class="annot"><a href="Text.Regex.TDFA.Common.html#SetVal"><span class="hs-identifier hs-var">SetVal</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120185"><span id="local-6989586621679120187"><span id="local-6989586621679120189"><span class="annot"><span class="annottext">Int -&gt; Action -&gt; String -&gt; String
[Action] -&gt; String -&gt; String
Action -&gt; String
(Int -&gt; Action -&gt; String -&gt; String)
-&gt; (Action -&gt; String)
-&gt; ([Action] -&gt; String -&gt; String)
-&gt; Show Action
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Action] -&gt; String -&gt; String
$cshowList :: [Action] -&gt; String -&gt; String
show :: Action -&gt; String
$cshow :: Action -&gt; String
showsPrec :: Int -&gt; Action -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; Action -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679120181"><span id="local-6989586621679120183"><span class="annot"><span class="annottext">Action -&gt; Action -&gt; Bool
(Action -&gt; Action -&gt; Bool)
-&gt; (Action -&gt; Action -&gt; Bool) -&gt; Eq Action
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Action -&gt; Action -&gt; Bool
$c/= :: Action -&gt; Action -&gt; Bool
== :: Action -&gt; Action -&gt; Bool
$c== :: Action -&gt; Action -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span class="hs-keyword">type</span><span> </span><span id="OrbitTransformer"><span class="annot"><a href="Text.Regex.TDFA.Common.html#OrbitTransformer"><span class="hs-identifier hs-var">OrbitTransformer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#OrbitLog"><span class="hs-identifier hs-type">OrbitLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#OrbitLog"><span class="hs-identifier hs-type">OrbitLog</span></a></span><span>
</span><span id="line-276"></span><span class="hs-keyword">type</span><span> </span><span id="OrbitLog"><span class="annot"><a href="Text.Regex.TDFA.Common.html#OrbitLog"><span class="hs-identifier hs-var">OrbitLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Orbits"><span class="hs-identifier hs-type">Orbits</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120175"><span id="local-6989586621679120178"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier hs-type">QNFA</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621679120174"><span class="annot"><span class="annottext">show :: QNFA -&gt; String
</span><a href="#local-6989586621679120174"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier hs-type">QNFA</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">q_id :: QNFA -&gt; Int
</span><a href="Text.Regex.TDFA.Common.html#q_id"><span class="hs-identifier hs-var">q_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679120173"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120173"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">q_qt :: QNFA -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#q_qt"><span class="hs-identifier hs-var">q_qt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679120172"><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120172"><span class="hs-identifier hs-var">qt</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;QNFA {q_id = &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120173"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-280"></span><span>                                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;\n     ,q_qt = &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QT -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120172"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-281"></span><span>                                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;\n}&quot;</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120167"><span id="local-6989586621679120170"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679120166"><span class="annot"><span class="annottext">show :: QT -&gt; String
</span><a href="#local-6989586621679120166"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QT -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier hs-var">showQT</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier hs-type">showQT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-287"></span><span id="showQT"><span class="annot"><span class="annottext">showQT :: QT -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier hs-var hs-var">showQT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier hs-type">Simple</span></a></span><span> </span><span id="local-6989586621679120164"><span class="annot"><span class="annottext">win :: WinTags
</span><a href="#local-6989586621679120164"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span id="local-6989586621679120163"><span class="annot"><span class="annottext">trans :: CharMap QTrans
</span><a href="#local-6989586621679120163"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span id="local-6989586621679120162"><span class="annot"><span class="annottext">other :: QTrans
</span><a href="#local-6989586621679120162"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;{qt_win=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">WinTags -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">WinTags
</span><a href="#local-6989586621679120164"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-288"></span><span>                             </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n, qt_trans=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Char, [(Int, [TagCommand])])] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CharMap QTrans -&gt; [(Char, [(Int, [TagCommand])])]
</span><a href="#local-6989586621679120161"><span class="hs-identifier hs-var">foo</span></a></span><span> </span><span class="annot"><span class="annottext">CharMap QTrans
</span><a href="#local-6989586621679120163"><span class="hs-identifier hs-var">trans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>                             </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n, qt_other=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Int, [TagCommand])] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QTrans -&gt; [(Int, [TagCommand])]
</span><a href="#local-6989586621679120160"><span class="hs-identifier hs-var">foo'</span></a></span><span> </span><span class="annot"><span class="annottext">QTrans
</span><a href="#local-6989586621679120162"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621679120161"><span class="hs-identifier hs-type">foo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier hs-type">TagCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>        </span><span id="local-6989586621679120161"><span class="annot"><span class="annottext">foo :: CharMap QTrans -&gt; [(Char, [(Int, [TagCommand])])]
</span><a href="#local-6989586621679120161"><span class="hs-identifier hs-var hs-var">foo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(QTrans -&gt; [(Int, [TagCommand])])
-&gt; [(Char, QTrans)] -&gt; [(Char, [(Int, [TagCommand])])]
forall (f :: * -&gt; *) t1 t2 t.
Functor f =&gt;
(t1 -&gt; t2) -&gt; f (t, t1) -&gt; f (t, t2)
</span><a href="Text.Regex.TDFA.Common.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="annot"><span class="annottext">QTrans -&gt; [(Int, [TagCommand])]
</span><a href="#local-6989586621679120160"><span class="hs-identifier hs-var">foo'</span></a></span><span> </span><span class="annot"><span class="annottext">([(Char, QTrans)] -&gt; [(Char, [(Int, [TagCommand])])])
-&gt; (CharMap QTrans -&gt; [(Char, QTrans)])
-&gt; CharMap QTrans
-&gt; [(Char, [(Int, [TagCommand])])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CharMap QTrans -&gt; [(Char, QTrans)]
forall a. CharMap a -&gt; [(Char, a)]
</span><a href="Data.IntMap.CharMap2.html#toAscList"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><a href="#local-6989586621679120160"><span class="hs-identifier hs-type">foo'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier hs-type">TagCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>        </span><span id="local-6989586621679120160"><span class="annot"><span class="annottext">foo' :: QTrans -&gt; [(Int, [TagCommand])]
</span><a href="#local-6989586621679120160"><span class="hs-identifier hs-var hs-var">foo'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QTrans -&gt; [(Int, [TagCommand])]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IMap.toList</span></span><span> </span><span>
</span><span id="line-294"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier hs-var">showQT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier hs-type">Testing</span></a></span><span> </span><span id="local-6989586621679120159"><span class="annot"><span class="annottext">test :: WhichTest
</span><a href="#local-6989586621679120159"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679120158"><span class="annot"><span class="annottext">dopas :: EnumSet DoPa
</span><a href="#local-6989586621679120158"><span class="hs-identifier hs-var">dopas</span></a></span></span><span> </span><span id="local-6989586621679120157"><span class="annot"><span class="annottext">a :: QT
</span><a href="#local-6989586621679120157"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679120156"><span class="annot"><span class="annottext">b :: QT
</span><a href="#local-6989586621679120156"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;{Testing &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">WhichTest -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">WhichTest
</span><a href="#local-6989586621679120159"><span class="hs-identifier hs-var">test</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[DoPa] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EnumSet DoPa -&gt; [DoPa]
forall e. Enum e =&gt; EnumSet e -&gt; [e]
</span><a href="Data.IntSet.EnumSet2.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">EnumSet DoPa
</span><a href="#local-6989586621679120158"><span class="hs-identifier hs-var">dopas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>                              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">QT -&gt; String
</span><a href="#local-6989586621679120155"><span class="hs-identifier hs-var">indent'</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120157"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-296"></span><span>                              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">QT -&gt; String
</span><a href="#local-6989586621679120155"><span class="hs-identifier hs-var">indent'</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120156"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120155"><span class="annot"><span class="annottext">indent' :: QT -&gt; String
</span><a href="#local-6989586621679120155"><span class="hs-identifier hs-var hs-var">indent'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (QT -&gt; String) -&gt; QT -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; (QT -&gt; [String]) -&gt; QT -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120152"><span class="hs-identifier hs-var">spaces</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; (QT -&gt; [String]) -&gt; QT -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; (QT -&gt; String) -&gt; QT -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QT -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier hs-var">showQT</span></a></span><span>
</span><span id="line-298"></span><span>          </span><span id="local-6989586621679120152"><span class="annot"><span class="annottext">spaces :: String
</span><a href="#local-6989586621679120152"><span class="hs-identifier hs-var hs-var">spaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120145"><span id="local-6989586621679120148"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120144"><span class="annot"><span class="annottext">show :: DT -&gt; String
</span><a href="#local-6989586621679120144"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DT -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier hs-var">showDT</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-type">indent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-303"></span><span id="indent"><span class="annot"><span class="annottext">indent :: [String] -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; ([String] -&gt; [String]) -&gt; [String] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120141"><span class="annot"><span class="annottext">x :: String
</span><a href="#local-6989586621679120141"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="hs-char">' '</span></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120141"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier hs-type">showDT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-306"></span><span id="showDT"><span class="annot"><span class="annottext">showDT :: DT -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier hs-var hs-var">showDT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Simple%27"><span class="hs-identifier hs-type">Simple'</span></a></span><span> </span><span id="local-6989586621679120140"><span class="annot"><span class="annottext">w :: IntMap Instructions
</span><a href="#local-6989586621679120140"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679120139"><span class="annot"><span class="annottext">t :: CharMap Transition
</span><a href="#local-6989586621679120139"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679120138"><span class="annot"><span class="annottext">o :: Transition
</span><a href="#local-6989586621679120138"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>       </span><span class="annot"><span class="hs-string">&quot;Simple' { dt_win = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120137"><span class="hs-identifier hs-var">seeWin1</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n        , dt_trans = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120136"><span class="hs-identifier hs-var">seeTrans1</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n        , dt_other = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Transition -&gt; String
</span><a href="#local-6989586621679120135"><span class="hs-identifier hs-var">seeOther1</span></a></span><span> </span><span class="annot"><span class="annottext">Transition
</span><a href="#local-6989586621679120138"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-310"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n        }&quot;</span></span><span>
</span><span id="line-311"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679120137"><span class="annot"><span class="annottext">seeWin1 :: String
</span><a href="#local-6989586621679120137"><span class="hs-identifier hs-var hs-var">seeWin1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IntMap Instructions -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><span class="hs-identifier hs-var">IMap.null</span></span><span> </span><span class="annot"><span class="annottext">IntMap Instructions
</span><a href="#local-6989586621679120140"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;No win&quot;</span></span><span>
</span><span id="line-313"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (IntMap Instructions -&gt; [String])
-&gt; IntMap Instructions
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, Instructions) -&gt; String)
-&gt; [(Int, Instructions)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Instructions) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Instructions)] -&gt; [String])
-&gt; (IntMap Instructions -&gt; [(Int, Instructions)])
-&gt; IntMap Instructions
-&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntMap Instructions -&gt; [(Int, Instructions)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IMap.assocs</span></span><span> </span><span class="annot"><span class="annottext">(IntMap Instructions -&gt; String) -&gt; IntMap Instructions -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap Instructions
</span><a href="#local-6989586621679120140"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><a href="#local-6989586621679120136"><span class="hs-identifier hs-type">seeTrans1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679120136"><span class="annot"><span class="annottext">seeTrans1 :: String
</span><a href="#local-6989586621679120136"><span class="hs-identifier hs-var hs-var">seeTrans1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CharMap Transition -&gt; Bool
forall a. CharMap a -&gt; Bool
</span><a href="Data.IntMap.CharMap2.html#null"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">CharMap Transition
</span><a href="#local-6989586621679120139"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;No (Char,Transition)&quot;</span></span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-char">'\n'</span></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-318"></span><span>     </span><span class="annot"><span class="annottext">((Char, Transition) -&gt; String) -&gt; [(Char, Transition)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679120134"><span class="annot"><span class="annottext">char :: Char
</span><a href="#local-6989586621679120134"><span class="hs-identifier hs-var">char</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">trans_many :: Transition -&gt; DFA
</span><a href="Text.Regex.TDFA.Common.html#trans_many"><span class="hs-identifier hs-var">trans_many</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621679120133"><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120133"><span class="hs-identifier hs-var">dfa</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">trans_single :: Transition -&gt; DFA
</span><a href="Text.Regex.TDFA.Common.html#trans_single"><span class="hs-identifier hs-var">trans_single</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621679120132"><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120132"><span class="hs-identifier hs-var">dfa2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">trans_how :: Transition -&gt; DTrans
</span><a href="Text.Regex.TDFA.Common.html#trans_how"><span class="hs-identifier hs-var">trans_how</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621679120131"><span class="annot"><span class="annottext">DTrans
</span><a href="#local-6989586621679120131"><span class="hs-identifier hs-var">dtrans</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-319"></span><span>                           </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;(&quot;</span></span><span>
</span><span id="line-320"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679120134"><span class="hs-identifier hs-var">char</span></a></span><span>
</span><span id="line-321"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;, MANY &quot;</span></span><span>
</span><span id="line-322"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">SetIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFA -&gt; SetIndex
</span><a href="Text.Regex.TDFA.Common.html#d_id"><span class="hs-identifier hs-var hs-var">d_id</span></a></span><span> </span><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120133"><span class="hs-identifier hs-var">dfa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;, SINGLE &quot;</span></span><span>
</span><span id="line-324"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">SetIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFA -&gt; SetIndex
</span><a href="Text.Regex.TDFA.Common.html#d_id"><span class="hs-identifier hs-var hs-var">d_id</span></a></span><span> </span><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120132"><span class="hs-identifier hs-var">dfa2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;, \n&quot;</span></span><span>
</span><span id="line-326"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">DTrans -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier hs-var">seeDTrans</span></a></span><span> </span><span class="annot"><span class="annottext">DTrans
</span><a href="#local-6989586621679120131"><span class="hs-identifier hs-var">dtrans</span></a></span><span>
</span><span id="line-327"></span><span>                                  </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CharMap Transition -&gt; [(Char, Transition)]
forall a. CharMap a -&gt; [(Char, a)]
</span><a href="Data.IntMap.CharMap2.html#assocs"><span class="hs-identifier hs-var">Map.assocs</span></a></span><span> </span><span class="annot"><span class="annottext">CharMap Transition
</span><a href="#local-6989586621679120139"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621679120135"><span class="annot"><span class="annottext">seeOther1 :: Transition -&gt; String
</span><a href="#local-6989586621679120135"><span class="hs-identifier hs-var hs-var">seeOther1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">trans_many :: Transition -&gt; DFA
</span><a href="Text.Regex.TDFA.Common.html#trans_many"><span class="hs-identifier hs-var">trans_many</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621679120128"><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120128"><span class="hs-identifier hs-var">dfa</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">trans_single :: Transition -&gt; DFA
</span><a href="Text.Regex.TDFA.Common.html#trans_single"><span class="hs-identifier hs-var">trans_single</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621679120127"><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120127"><span class="hs-identifier hs-var">dfa2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">trans_how :: Transition -&gt; DTrans
</span><a href="Text.Regex.TDFA.Common.html#trans_how"><span class="hs-identifier hs-var">trans_how</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621679120126"><span class="annot"><span class="annottext">DTrans
</span><a href="#local-6989586621679120126"><span class="hs-identifier hs-var">dtrans</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;(MANY &quot;</span></span><span>
</span><span id="line-331"></span><span>           </span><span class="hs-special">,</span><span class="annot"><span class="annottext">SetIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFA -&gt; SetIndex
</span><a href="Text.Regex.TDFA.Common.html#d_id"><span class="hs-identifier hs-var hs-var">d_id</span></a></span><span> </span><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120128"><span class="hs-identifier hs-var">dfa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>           </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;, SINGLE &quot;</span></span><span>
</span><span id="line-333"></span><span>           </span><span class="hs-special">,</span><span class="annot"><span class="annottext">SetIndex -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFA -&gt; SetIndex
</span><a href="Text.Regex.TDFA.Common.html#d_id"><span class="hs-identifier hs-var hs-var">d_id</span></a></span><span> </span><span class="annot"><span class="annottext">DFA
</span><a href="#local-6989586621679120127"><span class="hs-identifier hs-var">dfa2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>           </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;, \n&quot;</span></span><span>
</span><span id="line-335"></span><span>           </span><span class="hs-special">,</span><span class="annot"><span class="annottext">DTrans -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier hs-var">seeDTrans</span></a></span><span> </span><span class="annot"><span class="annottext">DTrans
</span><a href="#local-6989586621679120126"><span class="hs-identifier hs-var">dtrans</span></a></span><span>
</span><span id="line-336"></span><span>           </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier hs-var">showDT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Testing%27"><span class="hs-identifier hs-type">Testing'</span></a></span><span> </span><span id="local-6989586621679120125"><span class="annot"><span class="annottext">wt :: WhichTest
</span><a href="#local-6989586621679120125"><span class="hs-identifier hs-var">wt</span></a></span></span><span> </span><span id="local-6989586621679120124"><span class="annot"><span class="annottext">d :: EnumSet DoPa
</span><a href="#local-6989586621679120124"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679120123"><span class="annot"><span class="annottext">a :: DT
</span><a href="#local-6989586621679120123"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679120122"><span class="annot"><span class="annottext">b :: DT
</span><a href="#local-6989586621679120122"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Testing' { dt_test = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">WhichTest -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">WhichTest
</span><a href="#local-6989586621679120125"><span class="hs-identifier hs-var">wt</span></a></span><span>
</span><span id="line-339"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n         , dt_dopas = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">EnumSet DoPa -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">EnumSet DoPa
</span><a href="#local-6989586621679120124"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-340"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n         , dt_a = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">DT -&gt; String
</span><a href="#local-6989586621679120121"><span class="hs-identifier hs-var">indent'</span></a></span><span> </span><span class="annot"><span class="annottext">DT
</span><a href="#local-6989586621679120123"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-341"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n         , dt_b = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">DT -&gt; String
</span><a href="#local-6989586621679120121"><span class="hs-identifier hs-var">indent'</span></a></span><span> </span><span class="annot"><span class="annottext">DT
</span><a href="#local-6989586621679120122"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-342"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n         }&quot;</span></span><span>
</span><span id="line-343"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120121"><span class="annot"><span class="annottext">indent' :: DT -&gt; String
</span><a href="#local-6989586621679120121"><span class="hs-identifier hs-var hs-var">indent'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (DT -&gt; String) -&gt; DT -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; (DT -&gt; [String]) -&gt; DT -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120120"><span class="annot"><span class="annottext">s :: [String]
</span><a href="#local-6989586621679120120"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679120120"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-344"></span><span>                                           </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-345"></span><span>                                           </span><span class="hs-special">(</span><span id="local-6989586621679120119"><span class="annot"><span class="annottext">h :: String
</span><a href="#local-6989586621679120119"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679120118"><span class="annot"><span class="annottext">t :: [String]
</span><a href="#local-6989586621679120118"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120119"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679120117"><span class="hs-identifier hs-var">spaces</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679120118"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; (DT -&gt; [String]) -&gt; DT -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; (DT -&gt; String) -&gt; DT -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DT -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier hs-var">showDT</span></a></span><span>
</span><span id="line-346"></span><span>       </span><span id="local-6989586621679120117"><span class="annot"><span class="annottext">spaces :: String
</span><a href="#local-6989586621679120117"><span class="hs-identifier hs-var hs-var">spaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier hs-type">seeDTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DTrans"><span class="hs-identifier hs-type">DTrans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-350"></span><span class="hs-comment">--seeDTrans x = concatMap (\(dest,y) -&gt; unlines . map (\(source,ins) -&gt; show (dest,source,ins) ) . IMap.assocs $ y) (IMap.assocs x)</span><span>
</span><span id="line-351"></span><span id="seeDTrans"><span class="annot"><span class="annottext">seeDTrans :: DTrans -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier hs-var hs-var">seeDTrans</span></a></span></span><span> </span><span id="local-6989586621679120116"><span class="annot"><span class="annottext">x :: DTrans
</span><a href="#local-6989586621679120116"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DTrans -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><span class="hs-identifier hs-var">IMap.null</span></span><span> </span><span class="annot"><span class="annottext">DTrans
</span><a href="#local-6989586621679120116"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;No DTrans&quot;</span></span><span>
</span><span id="line-352"></span><span class="annot"><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier hs-var">seeDTrans</span></a></span><span> </span><span id="local-6989586621679120115"><span class="annot"><span class="annottext">x :: DTrans
</span><a href="#local-6989586621679120115"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, IntMap (DoPa, Instructions)) -&gt; String)
-&gt; [(Int, IntMap (DoPa, Instructions))] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(Int, IntMap (DoPa, Instructions)) -&gt; String
forall a c. (Show a, Show c) =&gt; (a, IntMap c) -&gt; String
</span><a href="#local-6989586621679120113"><span class="hs-identifier hs-var">seeSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTrans -&gt; [(Int, IntMap (DoPa, Instructions))]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IMap.assocs</span></span><span> </span><span class="annot"><span class="annottext">DTrans
</span><a href="#local-6989586621679120115"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120113"><span class="annot"><span class="annottext">seeSource :: (a, IntMap c) -&gt; String
</span><a href="#local-6989586621679120113"><span class="hs-identifier hs-var hs-var">seeSource</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120112"><span class="annot"><span class="annottext">dest :: a
</span><a href="#local-6989586621679120112"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679120111"><span class="annot"><span class="annottext">srcMap :: IntMap c
</span><a href="#local-6989586621679120111"><span class="hs-identifier hs-var">srcMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IntMap c -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><span class="hs-identifier hs-var">IMap.null</span></span><span> </span><span class="annot"><span class="annottext">IntMap c
</span><a href="#local-6989586621679120111"><span class="hs-identifier hs-var">srcMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(a, String) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120112"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;SPAWN&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-354"></span><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (IntMap c -&gt; [String]) -&gt; IntMap c -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, c) -&gt; String) -&gt; [(Int, c)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679120110"><span class="annot"><span class="annottext">source :: Int
</span><a href="#local-6989586621679120110"><span class="hs-identifier hs-var">source</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679120109"><span class="annot"><span class="annottext">ins :: c
</span><a href="#local-6989586621679120109"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, Int, c) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120112"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679120110"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679120109"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, c)] -&gt; [String])
-&gt; (IntMap c -&gt; [(Int, c)]) -&gt; IntMap c -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntMap c -&gt; [(Int, c)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IMap.assocs</span></span><span> </span><span class="annot"><span class="annottext">(IntMap c -&gt; String) -&gt; IntMap c -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntMap c
</span><a href="#local-6989586621679120111"><span class="hs-identifier hs-var">srcMap</span></a></span><span>
</span><span id="line-355"></span><span class="hs-comment">--        spawnIns = Instructions { newPos = [(0,SetPost)], newOrbits = Nothing }</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120106"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621679120105"><span class="annot"><span class="annottext">t1 :: QT
</span><a href="#local-6989586621679120105"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier hs-type">Testing</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120104"><span class="annot"><span class="annottext">== :: QT -&gt; QT -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679120103"><span class="annot"><span class="annottext">t2 :: QT
</span><a href="#local-6989586621679120103"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier hs-type">Testing</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QT -&gt; WhichTest
</span><a href="Text.Regex.TDFA.Common.html#qt_test"><span class="hs-identifier hs-var hs-var">qt_test</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120105"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WhichTest -&gt; WhichTest -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QT -&gt; WhichTest
</span><a href="Text.Regex.TDFA.Common.html#qt_test"><span class="hs-identifier hs-var hs-var">qt_test</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120103"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QT -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#qt_a"><span class="hs-identifier hs-var hs-var">qt_a</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120105"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QT -&gt; QT -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QT -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#qt_a"><span class="hs-identifier hs-var hs-var">qt_a</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120103"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QT -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#qt_b"><span class="hs-identifier hs-var hs-var">qt_b</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120105"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QT -&gt; QT -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QT -&gt; QT
</span><a href="Text.Regex.TDFA.Common.html#qt_b"><span class="hs-identifier hs-var hs-var">qt_b</span></a></span><span> </span><span class="annot"><span class="annottext">QT
</span><a href="#local-6989586621679120103"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier hs-type">Simple</span></a></span><span> </span><span id="local-6989586621679120101"><span class="annot"><span class="annottext">w1 :: WinTags
</span><a href="#local-6989586621679120101"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a></span><span> </span><span id="local-6989586621679120099"><span class="annot"><span class="annottext">t1 :: IntMap QTrans
</span><a href="#local-6989586621679120099"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120098"><span class="annot"><span class="annottext">o1 :: QTrans
</span><a href="#local-6989586621679120098"><span class="hs-identifier hs-var">o1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier hs-type">Simple</span></a></span><span> </span><span id="local-6989586621679120097"><span class="annot"><span class="annottext">w2 :: WinTags
</span><a href="#local-6989586621679120097"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a></span><span> </span><span id="local-6989586621679120096"><span class="annot"><span class="annottext">t2 :: IntMap QTrans
</span><a href="#local-6989586621679120096"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120095"><span class="annot"><span class="annottext">o2 :: QTrans
</span><a href="#local-6989586621679120095"><span class="hs-identifier hs-var">o2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><span class="annottext">WinTags
</span><a href="#local-6989586621679120101"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">WinTags -&gt; WinTags -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WinTags
</span><a href="#local-6989586621679120097"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679120094"><span class="hs-identifier hs-var">eqTrans</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">QTrans -&gt; QTrans -&gt; Bool
</span><a href="#local-6989586621679120093"><span class="hs-identifier hs-var">eqQTrans</span></a></span><span> </span><span class="annot"><span class="annottext">QTrans
</span><a href="#local-6989586621679120098"><span class="hs-identifier hs-var">o1</span></a></span><span> </span><span class="annot"><span class="annottext">QTrans
</span><a href="#local-6989586621679120095"><span class="hs-identifier hs-var">o2</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621679120094"><span class="hs-identifier hs-type">eqTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-364"></span><span>          </span><span id="local-6989586621679120094"><span class="annot"><span class="annottext">eqTrans :: Bool
</span><a href="#local-6989586621679120094"><span class="hs-identifier hs-var hs-var">eqTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap QTrans -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IMap.size</span></span><span> </span><span class="annot"><span class="annottext">IntMap QTrans
</span><a href="#local-6989586621679120099"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IntMap QTrans -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IMap.size</span></span><span> </span><span class="annot"><span class="annottext">IntMap QTrans
</span><a href="#local-6989586621679120096"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, QTrans) -&gt; (Int, QTrans) -&gt; Bool)
-&gt; [(Int, QTrans)] -&gt; [(Int, QTrans)] -&gt; [Bool]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">(Int, QTrans) -&gt; (Int, QTrans) -&gt; Bool
forall a. Eq a =&gt; (a, QTrans) -&gt; (a, QTrans) -&gt; Bool
</span><a href="#local-6989586621679120090"><span class="hs-identifier hs-var">together</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap QTrans -&gt; [(Int, QTrans)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IMap.toAscList</span></span><span> </span><span class="annot"><span class="annottext">IntMap QTrans
</span><a href="#local-6989586621679120099"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap QTrans -&gt; [(Int, QTrans)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IMap.toAscList</span></span><span> </span><span class="annot"><span class="annottext">IntMap QTrans
</span><a href="#local-6989586621679120096"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679120090"><span class="annot"><span class="annottext">together :: (a, QTrans) -&gt; (a, QTrans) -&gt; Bool
</span><a href="#local-6989586621679120090"><span class="hs-identifier hs-var hs-var">together</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120089"><span class="annot"><span class="annottext">c1 :: a
</span><a href="#local-6989586621679120089"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679120088"><span class="annot"><span class="annottext">qtrans1 :: QTrans
</span><a href="#local-6989586621679120088"><span class="hs-identifier hs-var">qtrans1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120087"><span class="annot"><span class="annottext">c2 :: a
</span><a href="#local-6989586621679120087"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679120086"><span class="annot"><span class="annottext">qtrans2 :: QTrans
</span><a href="#local-6989586621679120086"><span class="hs-identifier hs-var">qtrans2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120089"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120087"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">QTrans -&gt; QTrans -&gt; Bool
</span><a href="#local-6989586621679120093"><span class="hs-identifier hs-var">eqQTrans</span></a></span><span> </span><span class="annot"><span class="annottext">QTrans
</span><a href="#local-6989586621679120088"><span class="hs-identifier hs-var">qtrans1</span></a></span><span> </span><span class="annot"><span class="annottext">QTrans
</span><a href="#local-6989586621679120086"><span class="hs-identifier hs-var">qtrans2</span></a></span><span>
</span><span id="line-367"></span><span>          </span><span class="annot"><a href="#local-6989586621679120093"><span class="hs-identifier hs-type">eqQTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-368"></span><span>          </span><span id="local-6989586621679120093"><span class="annot"><span class="annottext">eqQTrans :: QTrans -&gt; QTrans -&gt; Bool
</span><a href="#local-6989586621679120093"><span class="hs-identifier hs-var hs-var">eqQTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QTrans -&gt; QTrans -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-370"></span></pre></body></html>