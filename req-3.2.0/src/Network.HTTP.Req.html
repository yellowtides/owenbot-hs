<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_Lq0Tl28TKYVASXvcSVnndt"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE DeriveLift #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE RoleAnnotations #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskellQuotes #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- Module      :  Network.HTTP.Req</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Copyright   :  &#169; 2016&#8211;present Mark Karpov</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- License     :  BSD 3 clause</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- Maintainer  :  Mark Karpov &lt;markkarpov92@gmail.com&gt;</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- The documentation below is structured in such a way that the most</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- important information is presented first: you learn how to do HTTP</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- requests, how to embed them in any monad you have, and then it gives you</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- details about less-common things you may want to know about. The</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- documentation is written with sufficient coverage of details and</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- examples, and it's designed to be a complete tutorial on its own.</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- /(A modest intro goes here, click on 'req' to start making requests.)/</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- === About the library</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- Req is an easy-to-use, type-safe, expandable, high-level HTTP client</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- library that just works without any fooling around.</span><span>
</span><span id="line-43"></span><span class="hs-comment">--</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- What does the phrase &#8220;easy-to-use&#8221; mean? It means that the library is</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- designed to be beginner-friendly so it's simple to add to your monad</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- stack, intuitive to work with, well-documented, and does not get in your</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- way. Doing HTTP requests is a common task and Haskell library for this</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- should be very approachable and clear to beginners, thus certain</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- compromises were made. For example, one cannot currently modify</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- 'L.ManagerSettings' of the default manager because the library always</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- uses the same implicit global manager for simplicity and maximal</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- connection sharing. There is a way to use your own manager with different</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- settings, but it requires a bit more typing.</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- &#8220;Type-safe&#8221; means that the library is protective and eliminates certain</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- classes of errors. For example, we have correct-by-construction 'Url's,</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- it's guaranteed that the user does not send the request body when using</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- methods like 'GET' or 'OPTIONS', and the amount of implicit assumptions</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- is minimized by making the user specify his\/her intentions in an</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- explicit form (for example, it's not possible to avoid specifying the</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- body or method of request). Authentication methods that assume HTTPS</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- force the user to use HTTPS at the type level. The library also carefully</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- hides underlying types from the lower-level @http-client@ package because</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- those types are not safe enough (for example 'L.Request' is an instance</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- of 'Data.String.IsString' and, if it's malformed, it will blow up at</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- run-time).</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &#8220;Expandable&#8221; refers to the ability of the library to be expanded without</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- having to resort to ugly hacking. For example, it's possible to define</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- your own HTTP methods, create new ways to construct the body of a</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- request, create new authorization options, perform a request in a</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- different way, and create your own methods to parse and represent a</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- response. As the user extends the library to satisfy his\/her special</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- needs, the new solutions will work just like the built-ins. However, all</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- of the common cases are also covered by the library out-of-the-box.</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &#8220;High-level&#8221; means that there are less details to worry about. The</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- library is a result of my experiences as a Haskell consultant. Working</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- for several clients, who had very different projects, showed me that the</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- library should adapt easily to any particular style of writing Haskell</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- applications. For example, some people prefer throwing exceptions, while</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- others are concerned with purity. Just define 'handleHttpException'</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- accordingly when making your monad instance of 'MonadHttp' and it will</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- play together seamlessly. Finally, the library cuts down boilerplate</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- considerably, and helps you write concise, easy to read, and maintainable</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- code.</span><span>
</span><span id="line-87"></span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- === Using with other libraries</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">--     * You won't need the low-level interface of @http-client@ most of the</span><span>
</span><span id="line-91"></span><span class="hs-comment">--       time, but when you do, it's better to do a qualified import,</span><span>
</span><span id="line-92"></span><span class="hs-comment">--       because @http-client@ has naming conflicts with @req@.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--     * For streaming of large request bodies see the companion package</span><span>
</span><span id="line-94"></span><span class="hs-comment">--       @req-conduit@: &lt;https://hackage.haskell.org/package/req-conduit&gt;.</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- === Lightweight, no risk solution</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- The library uses the following mature packages under the hood to</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- guarantee you the best experience:</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">--     * &lt;https://hackage.haskell.org/package/http-client&gt;&#8212;low level HTTP</span><span>
</span><span id="line-102"></span><span class="hs-comment">--       client used everywhere in Haskell.</span><span>
</span><span id="line-103"></span><span class="hs-comment">--     * &lt;https://hackage.haskell.org/package/http-client-tls&gt;&#8212;TLS (HTTPS)</span><span>
</span><span id="line-104"></span><span class="hs-comment">--       support for @http-client@.</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- It's important to note that since we leverage well-known libraries that</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- the whole Haskell ecosystem uses, there is no risk in using @req@. The</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- machinery for performing requests is the same as with @http-conduit@ and</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- @wreq@. The only difference is the API.</span><span>
</span><span id="line-110"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.HTTP.Req</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Making a request</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="hs-comment">-- $making-a-request</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#req"><span class="hs-identifier">req</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#reqBr"><span class="hs-identifier">reqBr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#req%27"><span class="hs-identifier">req'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#withReqManager"><span class="hs-identifier">withReqManager</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Embedding requests in your monad</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-comment">-- $embedding-requests</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#MonadHttp"><span class="hs-identifier">MonadHttp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier">HttpConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#defaultHttpConfig"><span class="hs-identifier">defaultHttpConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier">Req</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#runReq"><span class="hs-identifier">runReq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Request</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Method</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="hs-comment">-- $method</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#GET"><span class="hs-identifier">GET</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#POST"><span class="hs-identifier">POST</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HEAD"><span class="hs-identifier">HEAD</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#PUT"><span class="hs-identifier">PUT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#DELETE"><span class="hs-identifier">DELETE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#TRACE"><span class="hs-identifier">TRACE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#CONNECT"><span class="hs-identifier">CONNECT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#OPTIONS"><span class="hs-identifier">OPTIONS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#PATCH"><span class="hs-identifier">PATCH</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier">HttpMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** URL</span></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="hs-comment">-- $url</span></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier">Url</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#http"><span class="hs-identifier">http</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#https"><span class="hs-identifier">https</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#%2F~"><span class="hs-operator">(/~)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#%2F%3A"><span class="hs-operator">(/:)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#useHttpURI"><span class="hs-identifier">useHttpURI</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#useHttpsURI"><span class="hs-identifier">useHttpsURI</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#useURI"><span class="hs-identifier">useURI</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#urlQ"><span class="hs-identifier">urlQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Body</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="hs-comment">-- $body</span></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#NoReqBody"><span class="hs-identifier">NoReqBody</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyJson"><span class="hs-identifier">ReqBodyJson</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyFile"><span class="hs-identifier">ReqBodyFile</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyBs"><span class="hs-identifier">ReqBodyBs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyLbs"><span class="hs-identifier">ReqBodyLbs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyUrlEnc"><span class="hs-identifier">ReqBodyUrlEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#FormUrlEncodedParam"><span class="hs-identifier">FormUrlEncodedParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier">ReqBodyMultipart</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#reqBodyMultipart"><span class="hs-identifier">reqBodyMultipart</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier">HttpBody</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ProvidesBody"><span class="hs-identifier">ProvidesBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier">HttpBodyAllowed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Optional parameters</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="hs-comment">-- $optional-parameters</span></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier">Option</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Query parameters</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="hs-comment">-- $query-parameters</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#%3D%3A"><span class="hs-operator">(=:)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#queryFlag"><span class="hs-identifier">queryFlag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#QueryParam"><span class="hs-identifier">QueryParam</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Headers</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#header"><span class="hs-identifier">header</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#attachHeader"><span class="hs-identifier">attachHeader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Cookies</span></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="hs-comment">-- $cookies</span></span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#cookieJar"><span class="hs-identifier">cookieJar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Authentication</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="hs-comment">-- $authentication</span></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#basicAuth"><span class="hs-identifier">basicAuth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#basicAuthUnsafe"><span class="hs-identifier">basicAuthUnsafe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#basicProxyAuth"><span class="hs-identifier">basicProxyAuth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#oAuth1"><span class="hs-identifier">oAuth1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#oAuth2Bearer"><span class="hs-identifier">oAuth2Bearer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#oAuth2Token"><span class="hs-identifier">oAuth2Token</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#customAuth"><span class="hs-identifier">customAuth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Other</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#port"><span class="hs-identifier">port</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#decompress"><span class="hs-identifier">decompress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#responseTimeout"><span class="hs-identifier">responseTimeout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#httpVersion"><span class="hs-identifier">httpVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Response</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Response interpretations</span></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier">IgnoreResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#ignoreResponse"><span class="hs-identifier">ignoreResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier">JsonResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#jsonResponse"><span class="hs-identifier">jsonResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier">BsResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#bsResponse"><span class="hs-identifier">bsResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier">LbsResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#lbsResponse"><span class="hs-identifier">lbsResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Inspecting a response</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#responseBody"><span class="hs-identifier">responseBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#responseStatusCode"><span class="hs-identifier">responseStatusCode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#responseStatusMessage"><span class="hs-identifier">responseStatusMessage</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#responseHeader"><span class="hs-identifier">responseHeader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#responseCookieJar"><span class="hs-identifier">responseCookieJar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Defining your own interpretation</span></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="hs-comment">-- $new-response-interpretation</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Other</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpException"><span class="hs-identifier">HttpException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier">CanHaveBody</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#Scheme"><span class="hs-identifier">Scheme</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BB</span></span><span>
</span><span id="line-233"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-234"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TypeError</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Base</span></span><span>
</span><span id="line-237"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-238"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-239"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span>
</span><span id="line-240"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Retry</span></span><span>
</span><span id="line-241"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-243"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-245"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-246"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-247"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span>
</span><span id="line-250"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constraint</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nubBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-254"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-256"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Option</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">option</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-259"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-260"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cast</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-262"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-263"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span>
</span><span id="line-264"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Quote</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span>
</span><span id="line-265"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span>
</span><span id="line-266"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.Connection</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NC</span></span><span>
</span><span id="line-267"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-268"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client.Internal</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LI</span></span><span>
</span><span id="line-269"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client.MultipartFormData</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LM</span></span><span>
</span><span id="line-270"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client.TLS</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-271"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Y</span></span><span>
</span><span id="line-272"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafePerformIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.URI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">URI</span></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.URI</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">URI</span></span><span>
</span><span id="line-275"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.URI.QQ</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QQ</span></span><span>
</span><span id="line-276"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Web.Authenticate.OAuth</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OAuth</span></span><span>
</span><span id="line-277"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Web.HttpApiData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToHttpApiData</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- Making a request</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- $making-a-request</span><span>
</span><span id="line-283"></span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- To make an HTTP request you normally need only one function: 'req'.</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Make an HTTP request. The function takes 5 arguments, 4 of which</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- specify required parameters and the final 'Option' argument is a</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- collection of optional parameters.</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- Let's go through all the arguments first: @req method url body response</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- options@.</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- @method@ is an HTTP method such as 'GET' or 'POST'. The documentation has</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- a dedicated section about HTTP methods below.</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- @url@ is a 'Url' that describes location of resource you want to interact</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- with.</span><span>
</span><span id="line-298"></span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- @body@ is a body option such as 'NoReqBody' or 'ReqBodyJson'. The</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- tutorial has a section about HTTP bodies, but usage is very</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- straightforward and should be clear from the examples below.</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- @response@ is a type hint how to make and interpret response of an HTTP</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- request. Out-of-the-box it can be the following:</span><span>
</span><span id="line-305"></span><span class="hs-comment">--</span><span>
</span><span id="line-306"></span><span class="hs-comment">--     * 'ignoreResponse'</span><span>
</span><span id="line-307"></span><span class="hs-comment">--     * 'jsonResponse'</span><span>
</span><span id="line-308"></span><span class="hs-comment">--     * 'bsResponse' (to get a strict 'ByteString')</span><span>
</span><span id="line-309"></span><span class="hs-comment">--     * 'lbsResponse' (to get a lazy 'BL.ByteString')</span><span>
</span><span id="line-310"></span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- Finally, @options@ is a 'Monoid' that holds a composite 'Option' for all</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- other optional settings like query parameters, headers, non-standard port</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- number, etc. There are quite a few things you can put there, see the</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- corresponding section in the documentation. If you don't need anything at</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- all, pass 'mempty'.</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- __Note__ that if you use 'req' to do all your requests, connection</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- sharing and reuse is done for you automatically.</span><span>
</span><span id="line-319"></span><span class="hs-comment">--</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- See the examples below to get on the speed quickly.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-323"></span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- First, this is a piece of boilerplate that should be in place before you</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- try the examples:</span><span>
</span><span id="line-326"></span><span class="hs-comment">--</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- &gt; {-# LANGUAGE DeriveGeneric     #-}</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- &gt; {-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- &gt; module Main (main) where</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- &gt; import Control.Monad</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- &gt; import Control.Monad.IO.Class</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- &gt; import Data.Aeson</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- &gt; import Data.Maybe (fromJust)</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- &gt; import Data.Monoid ((&lt;&gt;))</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- &gt; import Data.Text (Text)</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- &gt; import GHC.Generics</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- &gt; import Network.HTTP.Req</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- &gt; import qualified Data.ByteString.Char8 as B</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- &gt; import qualified Text.URI as URI</span><span>
</span><span id="line-342"></span><span class="hs-comment">--</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- We will be making requests against the &lt;https://httpbin.org&gt; service.</span><span>
</span><span id="line-344"></span><span class="hs-comment">--</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- Make a GET request, grab 5 random bytes:</span><span>
</span><span id="line-346"></span><span class="hs-comment">--</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- &gt; main = runReq defaultHttpConfig $ do</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- &gt;   let n :: Int</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- &gt;       n = 5</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- &gt;   bs &lt;- req GET (https &quot;httpbin.org&quot; /: &quot;bytes&quot; /~ n) NoReqBody bsResponse mempty</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- &gt;   liftIO $ B.putStrLn (responseBody bs)</span><span>
</span><span id="line-353"></span><span class="hs-comment">--</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- The same, but now we use a query parameter named @\&quot;seed\&quot;@ to control</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- seed of the generator:</span><span>
</span><span id="line-356"></span><span class="hs-comment">--</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- &gt; main = runReq defaultHttpConfig $ do</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- &gt;   let n, seed :: Int</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- &gt;       n    = 5</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- &gt;       seed = 100</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- &gt;   bs &lt;- req GET (https &quot;httpbin.org&quot; /: &quot;bytes&quot; /~ n) NoReqBody bsResponse $</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- &gt;     &quot;seed&quot; =: seed</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- &gt;   liftIO $ B.putStrLn (responseBody bs)</span><span>
</span><span id="line-365"></span><span class="hs-comment">--</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- POST JSON data and get some info about the POST request:</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- &gt; data MyData = MyData</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- &gt;   { size  :: Int</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- &gt;   , color :: Text</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- &gt;   } deriving (Show, Generic)</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- &gt; instance ToJSON MyData</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- &gt; instance FromJSON MyData</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- &gt; main = runReq defaultHttpConfig $ do</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- &gt;   let myData = MyData</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- &gt;         { size  = 6</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- &gt;         , color = &quot;Green&quot; }</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- &gt;   v &lt;- req POST (https &quot;httpbin.org&quot; /: &quot;post&quot;) (ReqBodyJson myData) jsonResponse mempty</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- &gt;   liftIO $ print (responseBody v :: Value)</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- Sending URL-encoded body:</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- &gt; main = runReq defaultHttpConfig $ do</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- &gt;   let params =</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- &gt;         &quot;foo&quot; =: (&quot;bar&quot; :: Text) &lt;&gt;</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- &gt;         queryFlag &quot;baz&quot;</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- &gt;   response &lt;- req POST (https &quot;httpbin.org&quot; /: &quot;post&quot;) (ReqBodyUrlEnc params) jsonResponse mempty</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- &gt;   liftIO $ print (responseBody response :: Value)</span><span>
</span><span id="line-393"></span><span class="hs-comment">--</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- Using various optional parameters and URL that is not known in advance:</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- &gt; main = runReq defaultHttpConfig $ do</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- &gt;   -- This is an example of what to do when URL is given dynamically. Of</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- &gt;   -- course in a real application you may not want to use 'fromJust'.</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- &gt;   uri &lt;- URI.mkURI &quot;https://httpbin.org/get?foo=bar&quot;</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- &gt;   let (url, options) = fromJust (useHttpsURI uri)</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- &gt;   response &lt;- req GET url NoReqBody jsonResponse $</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- &gt;     &quot;from&quot; =: (15 :: Int)           &lt;&gt;</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- &gt;     &quot;to&quot;   =: (67 :: Int)           &lt;&gt;</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- &gt;     basicAuth &quot;username&quot; &quot;password&quot; &lt;&gt;</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- &gt;     options                         &lt;&gt; -- contains the ?foo=bar part</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- &gt;     port 443 -- here you can put any port of course</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- &gt;   liftIO $ print (responseBody response :: Value)</span><span>
</span><span id="line-409"></span><span id="local-6989586621679213916"><span id="local-6989586621679213917"><span id="local-6989586621679213918"><span id="local-6989586621679213919"><span id="local-6989586621679213920"><span class="annot"><a href="Network.HTTP.Req.html#req"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#MonadHttp"><span class="hs-identifier hs-type">MonadHttp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213920"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213919"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213918"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213917"><span class="hs-identifier hs-type">response</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier hs-type">HttpBodyAllowed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-type">AllowsBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213919"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ProvidesBody"><span class="hs-identifier hs-type">ProvidesBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213918"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-comment">-- | HTTP method</span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><a href="#local-6989586621679213919"><span class="hs-identifier hs-type">method</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-comment">-- | 'Url'&#8212;location of resource</span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213916"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-comment">-- | Body of the request</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><a href="#local-6989586621679213918"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-comment">-- | A hint how to interpret response</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679213917"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-comment">-- | Collection of optional parameters</span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213916"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-comment">-- | Response</span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><a href="#local-6989586621679213920"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213917"><span class="hs-identifier hs-type">response</span></a></span></span></span></span></span></span><span>
</span><span id="line-428"></span><span id="req"><span class="annot"><span class="annottext">req :: method
-&gt; Url scheme
-&gt; body
-&gt; Proxy response
-&gt; Option scheme
-&gt; m response
</span><a href="Network.HTTP.Req.html#req"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679213915"><span class="annot"><span class="annottext">method :: method
</span><a href="#local-6989586621679213915"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679213914"><span class="annot"><span class="annottext">url :: Url scheme
</span><a href="#local-6989586621679213914"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span id="local-6989586621679213913"><span class="annot"><span class="annottext">body :: body
</span><a href="#local-6989586621679213913"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679213912"><span class="annot"><span class="annottext">responseProxy :: Proxy response
</span><a href="#local-6989586621679213912"><span class="hs-identifier hs-var">responseProxy</span></a></span></span><span> </span><span id="local-6989586621679213911"><span class="annot"><span class="annottext">options :: Option scheme
</span><a href="#local-6989586621679213911"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>  </span><span class="annot"><span class="annottext">method
-&gt; Url scheme
-&gt; body
-&gt; Option scheme
-&gt; (Response BodyReader -&gt; IO response)
-&gt; m response
forall (m :: * -&gt; *) method body (scheme :: Scheme) a.
(MonadHttp m, HttpMethod method, HttpBody body,
 HttpBodyAllowed (AllowsBody method) (ProvidesBody body)) =&gt;
method
-&gt; Url scheme
-&gt; body
-&gt; Option scheme
-&gt; (Response BodyReader -&gt; IO a)
-&gt; m a
</span><a href="Network.HTTP.Req.html#reqBr"><span class="hs-identifier hs-var">reqBr</span></a></span><span> </span><span class="annot"><span class="annottext">method
</span><a href="#local-6989586621679213915"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">Url scheme
</span><a href="#local-6989586621679213914"><span class="hs-identifier hs-var">url</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621679213913"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213911"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">Option scheme -&gt; Option scheme -&gt; Option scheme
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213910"><span class="hs-identifier hs-var">extraOptions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Response BodyReader -&gt; IO response
forall response.
HttpResponse response =&gt;
Response BodyReader -&gt; IO response
</span><a href="Network.HTTP.Req.html#getHttpResponse"><span class="hs-identifier hs-var">getHttpResponse</span></a></span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621679213910"><span class="annot"><span class="annottext">extraOptions :: Option scheme
</span><a href="#local-6989586621679213910"><span class="hs-identifier hs-var hs-var">extraOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proxy response -&gt; Maybe ByteString
forall response.
HttpResponse response =&gt;
Proxy response -&gt; Maybe ByteString
</span><a href="Network.HTTP.Req.html#acceptHeader"><span class="hs-identifier hs-var">acceptHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy response
</span><a href="#local-6989586621679213912"><span class="hs-identifier hs-var">responseProxy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-433"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Option scheme
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-434"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679213907"><span class="annot"><span class="annottext">accept :: ByteString
</span><a href="#local-6989586621679213907"><span class="hs-identifier hs-var">accept</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Option scheme
forall (scheme :: Scheme).
ByteString -&gt; ByteString -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#header"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Accept&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213907"><span class="hs-identifier hs-var">accept</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">-- | A version of 'req' that does not use one of the predefined instances of</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- 'HttpResponse' but instead allows the user to consume @'L.Response'</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- 'L.BodyReader'@ manually, in a custom way.</span><span>
</span><span id="line-439"></span><span class="hs-comment">--</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- @since 1.0.0</span><span>
</span><span id="line-441"></span><span id="local-6989586621679214445"><span id="local-6989586621679214446"><span id="local-6989586621679214451"><span id="local-6989586621679214453"><span id="local-6989586621679214455"><span class="annot"><a href="Network.HTTP.Req.html#reqBr"><span class="hs-identifier hs-type">reqBr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#MonadHttp"><span class="hs-identifier hs-type">MonadHttp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214455"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214453"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214451"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-445"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier hs-type">HttpBodyAllowed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-type">AllowsBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214453"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ProvidesBody"><span class="hs-identifier hs-type">ProvidesBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214451"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-comment">-- | HTTP method</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><a href="#local-6989586621679214453"><span class="hs-identifier hs-type">method</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-comment">-- | 'Url'&#8212;location of resource</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214446"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-comment">-- | Body of the request</span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><a href="#local-6989586621679214451"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-comment">-- | Collection of optional parameters</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214446"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-comment">-- | How to consume response</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.BodyReader</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679214445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-comment">-- | Result</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><a href="#local-6989586621679214455"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214445"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-459"></span><span id="reqBr"><span class="annot"><span class="annottext">reqBr :: method
-&gt; Url scheme
-&gt; body
-&gt; Option scheme
-&gt; (Response BodyReader -&gt; IO a)
-&gt; m a
</span><a href="Network.HTTP.Req.html#reqBr"><span class="hs-identifier hs-var hs-var">reqBr</span></a></span></span><span> </span><span id="local-6989586621679213906"><span class="annot"><span class="annottext">method :: method
</span><a href="#local-6989586621679213906"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679213905"><span class="annot"><span class="annottext">url :: Url scheme
</span><a href="#local-6989586621679213905"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span id="local-6989586621679213904"><span class="annot"><span class="annottext">body :: body
</span><a href="#local-6989586621679213904"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679213903"><span class="annot"><span class="annottext">options :: Option scheme
</span><a href="#local-6989586621679213903"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621679213902"><span class="annot"><span class="annottext">consume :: Response BodyReader -&gt; IO a
</span><a href="#local-6989586621679213902"><span class="hs-identifier hs-var">consume</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">method
-&gt; Url scheme
-&gt; body
-&gt; Option scheme
-&gt; (Request -&gt; Manager -&gt; m a)
-&gt; m a
forall (m :: * -&gt; *) method body (scheme :: Scheme) a.
(MonadHttp m, HttpMethod method, HttpBody body,
 HttpBodyAllowed (AllowsBody method) (ProvidesBody body)) =&gt;
method
-&gt; Url scheme
-&gt; body
-&gt; Option scheme
-&gt; (Request -&gt; Manager -&gt; m a)
-&gt; m a
</span><a href="Network.HTTP.Req.html#req%27"><span class="hs-identifier hs-var">req'</span></a></span><span> </span><span class="annot"><span class="annottext">method
</span><a href="#local-6989586621679213906"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">Url scheme
</span><a href="#local-6989586621679213905"><span class="hs-identifier hs-var">url</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621679213904"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213903"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Manager -&gt; m a) -&gt; m a)
-&gt; (Request -&gt; Manager -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213901"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679213901"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span id="local-6989586621679213900"><span class="annot"><span class="annottext">manager :: Manager
</span><a href="#local-6989586621679213900"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-460"></span><span>  </span><span id="local-6989586621679213894"><span id="local-6989586621679213895"><span id="local-6989586621679213896"><span id="local-6989586621679213897"><span id="local-6989586621679213898"><span id="local-6989586621679213899"><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type">HttpConfig</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span></span></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m HttpConfig
forall (m :: * -&gt; *). MonadHttp m =&gt; m HttpConfig
</span><a href="Network.HTTP.Req.html#getHttpConfig"><span class="hs-identifier hs-var">getHttpConfig</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213885"><span class="annot"><span class="annottext">wrapVanilla :: IO a -&gt; IO a
</span><a href="#local-6989586621679213885"><span class="hs-identifier hs-var hs-var">wrapVanilla</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; IO a) -&gt; IO a -&gt; IO a
forall e a. Exception e =&gt; (e -&gt; IO a) -&gt; IO a -&gt; IO a
</span><span class="hs-identifier hs-var">handle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; IO a)
-&gt; (HttpException -&gt; HttpException) -&gt; HttpException -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; HttpException
</span><a href="Network.HTTP.Req.html#VanillaHttpException"><span class="hs-identifier hs-var">VanillaHttpException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>      </span><span id="local-6989586621679213880"><span class="annot"><span class="annottext">wrapExc :: IO a -&gt; IO a
</span><a href="#local-6989586621679213880"><span class="hs-identifier hs-var hs-var">wrapExc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HttpExceptionContentWrapper -&gt; IO a) -&gt; IO a -&gt; IO a
forall e a. Exception e =&gt; (e -&gt; IO a) -&gt; IO a -&gt; IO a
</span><span class="hs-identifier hs-var">handle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; IO a)
-&gt; (HttpExceptionContentWrapper -&gt; HttpException)
-&gt; HttpExceptionContentWrapper
-&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; HttpExceptionContentWrapper -&gt; HttpException
</span><span class="hs-identifier hs-var">LI.toHttpException</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213901"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>      </span><span id="local-6989586621679213878"><span class="annot"><span class="annottext">withRRef :: (IORef (Maybe (Response a)) -&gt; IO c) -&gt; IO c
</span><a href="#local-6989586621679213878"><span class="hs-identifier hs-var hs-var">withRRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-464"></span><span>        </span><span class="annot"><span class="annottext">IO (IORef (Maybe (Response a)))
-&gt; (IORef (Maybe (Response a)) -&gt; IO ())
-&gt; (IORef (Maybe (Response a)) -&gt; IO c)
-&gt; IO c
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span>
</span><span id="line-465"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Response a) -&gt; IO (IORef (Maybe (Response a)))
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Response a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IORef (Maybe (Response a)) -&gt; IO (Maybe (Response a))
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">(IORef (Maybe (Response a)) -&gt; IO (Maybe (Response a)))
-&gt; (Maybe (Response a) -&gt; IO ())
-&gt; IORef (Maybe (Response a))
-&gt; IO ()
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Response a -&gt; IO ()) -&gt; Maybe (Response a) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Response a -&gt; IO ()
forall a. Response a -&gt; IO ()
</span><span class="hs-identifier hs-var">L.responseClose</span></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Either HttpException a) -&gt; m (Either HttpException a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either HttpException a) -&gt; m (Either HttpException a))
-&gt; (IO a -&gt; IO (Either HttpException a))
-&gt; IO a
-&gt; m (Either HttpException a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Either HttpException a)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; IO (Either HttpException a))
-&gt; (IO a -&gt; IO a) -&gt; IO a -&gt; IO (Either HttpException a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO a
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679213885"><span class="hs-identifier hs-var">wrapVanilla</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; IO a) -&gt; (IO a -&gt; IO a) -&gt; IO a -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO a
</span><a href="#local-6989586621679213880"><span class="hs-identifier hs-var">wrapExc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(IORef (Maybe (Response BodyReader)) -&gt; IO a) -&gt; IO a
forall a c. (IORef (Maybe (Response a)) -&gt; IO c) -&gt; IO c
</span><a href="#local-6989586621679213878"><span class="hs-identifier hs-var">withRRef</span></a></span><span> </span><span class="annot"><span class="annottext">((IORef (Maybe (Response BodyReader)) -&gt; IO a) -&gt; IO a)
-&gt; (IORef (Maybe (Response BodyReader)) -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213869"><span class="annot"><span class="annottext">rref :: IORef (Maybe (Response BodyReader))
</span><a href="#local-6989586621679213869"><span class="hs-identifier hs-var">rref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213868"><span class="annot"><span class="annottext">openResponse :: IO (Response BodyReader)
</span><a href="#local-6989586621679213868"><span class="hs-identifier hs-var hs-var">openResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Response BodyReader) -&gt; IO (Response BodyReader)
forall a. IO a -&gt; IO a
</span><span class="hs-identifier hs-var">mask_</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response BodyReader) -&gt; IO (Response BodyReader))
-&gt; IO (Response BodyReader) -&gt; IO (Response BodyReader)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>              </span><span id="local-6989586621679213866"><span class="annot"><span class="annottext">Maybe (Response BodyReader)
</span><a href="#local-6989586621679213866"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (Response BodyReader))
-&gt; IO (Maybe (Response BodyReader))
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (Response BodyReader))
</span><a href="#local-6989586621679213869"><span class="hs-identifier hs-var">rref</span></a></span><span>
</span><span id="line-471"></span><span>              </span><span class="annot"><span class="annottext">(Response BodyReader -&gt; IO ())
-&gt; Maybe (Response BodyReader) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader -&gt; IO ()
forall a. Response a -&gt; IO ()
</span><span class="hs-identifier hs-var">L.responseClose</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Response BodyReader)
</span><a href="#local-6989586621679213866"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-472"></span><span>              </span><span id="local-6989586621679213865"><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213865"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response BodyReader)
</span><span class="hs-identifier hs-var">L.responseOpen</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213901"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679213900"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-473"></span><span>              </span><span class="annot"><span class="annottext">IORef (Maybe (Response BodyReader))
-&gt; Maybe (Response BodyReader) -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (Response BodyReader))
</span><a href="#local-6989586621679213869"><span class="hs-identifier hs-var">rref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response BodyReader -&gt; Maybe (Response BodyReader)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213865"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>              </span><span class="annot"><span class="annottext">Response BodyReader -&gt; IO (Response BodyReader)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213865"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-475"></span><span>        </span><span id="local-6989586621679213862"><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213862"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-476"></span><span>          </span><span class="annot"><span class="annottext">RetryPolicyM IO
-&gt; (RetryStatus -&gt; Response BodyReader -&gt; IO Bool)
-&gt; (RetryStatus -&gt; IO (Response BodyReader))
-&gt; IO (Response BodyReader)
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
RetryPolicyM m
-&gt; (RetryStatus -&gt; b -&gt; m Bool) -&gt; (RetryStatus -&gt; m b) -&gt; m b
</span><span class="hs-identifier hs-var">retrying</span></span><span>
</span><span id="line-477"></span><span>            </span><span class="annot"><span class="annottext">RetryPolicyM IO
</span><a href="#local-6989586621679213895"><span class="hs-identifier hs-var">httpConfigRetryPolicy</span></a></span><span>
</span><span id="line-478"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679213860"><span class="annot"><span class="annottext">st :: RetryStatus
</span><a href="#local-6989586621679213860"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679213859"><span class="annot"><span class="annottext">r :: Response BodyReader
</span><a href="#local-6989586621679213859"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO Bool) -&gt; Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RetryStatus -&gt; Response BodyReader -&gt; Bool
forall b. RetryStatus -&gt; Response b -&gt; Bool
</span><a href="#local-6989586621679213894"><span class="hs-identifier hs-var">httpConfigRetryJudge</span></a></span><span> </span><span class="annot"><span class="annottext">RetryStatus
</span><a href="#local-6989586621679213860"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213859"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Response BodyReader) -&gt; RetryStatus -&gt; IO (Response BodyReader)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">IO (Response BodyReader)
</span><a href="#local-6989586621679213868"><span class="hs-identifier hs-var">openResponse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679213857"><span class="annot"><span class="annottext">preview :: ByteString
</span><a href="#local-6989586621679213857"><span class="hs-identifier hs-var">preview</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213856"><span class="annot"><span class="annottext">r' :: Response BodyReader
</span><a href="#local-6989586621679213856"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Response BodyReader -&gt; IO (ByteString, Response BodyReader)
</span><a href="Network.HTTP.Req.html#grabPreview"><span class="hs-identifier hs-var">grabPreview</span></a></span><span> </span><span class="annot"><span class="annottext">Int
forall a. Num a =&gt; a
</span><a href="Network.HTTP.Req.html#bodyPreviewLength"><span class="hs-identifier hs-var">bodyPreviewLength</span></a></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213862"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-481"></span><span>        </span><span class="annot"><span class="annottext">(HttpExceptionContent -&gt; IO Any)
-&gt; Maybe HttpExceptionContent -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; IO Any
forall a. HttpExceptionContent -&gt; IO a
</span><span class="hs-identifier hs-var">LI.throwHttp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request
-&gt; Response BodyReader -&gt; ByteString -&gt; Maybe HttpExceptionContent
forall b.
Request -&gt; Response b -&gt; ByteString -&gt; Maybe HttpExceptionContent
</span><a href="#local-6989586621679213896"><span class="hs-identifier hs-var">httpConfigCheckResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213901"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213856"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213857"><span class="hs-identifier hs-var">preview</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>        </span><span class="annot"><span class="annottext">Response BodyReader -&gt; IO a
</span><a href="#local-6989586621679213902"><span class="hs-identifier hs-var">consume</span></a></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213856"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><span class="annottext">m (Either HttpException a)
-&gt; (Either HttpException a -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; m a)
-&gt; (a -&gt; m a) -&gt; Either HttpException a -&gt; m a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; m a
forall (m :: * -&gt; *) a. MonadHttp m =&gt; HttpException -&gt; m a
</span><a href="Network.HTTP.Req.html#handleHttpException"><span class="hs-identifier hs-var">handleHttpException</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- | Mostly like 'req' with respect to its arguments, but accepts a callback</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- that allows to perform a request in arbitrary fashion.</span><span>
</span><span id="line-488"></span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- This function /does not/ perform handling\/wrapping exceptions, checking</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- response (with 'httpConfigCheckResponse'), and retrying. It only prepares</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- 'L.Request' and allows you to use it.</span><span>
</span><span id="line-492"></span><span class="hs-comment">--</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-494"></span><span class="annot"><a href="Network.HTTP.Req.html#req%27"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679214431"><span class="annot"><a href="#local-6989586621679214431"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679214430"><span class="annot"><a href="#local-6989586621679214430"><span class="hs-identifier hs-type">method</span></a></span></span><span> </span><span id="local-6989586621679214429"><span class="annot"><a href="#local-6989586621679214429"><span class="hs-identifier hs-type">body</span></a></span></span><span> </span><span id="local-6989586621679214428"><span class="annot"><a href="#local-6989586621679214428"><span class="hs-identifier hs-type">scheme</span></a></span></span><span> </span><span id="local-6989586621679214427"><span class="annot"><a href="#local-6989586621679214427"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#MonadHttp"><span class="hs-identifier hs-type">MonadHttp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214431"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-497"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214430"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214429"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier hs-type">HttpBodyAllowed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-type">AllowsBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214430"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ProvidesBody"><span class="hs-identifier hs-type">ProvidesBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214429"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-comment">-- | HTTP method</span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><a href="#local-6989586621679214430"><span class="hs-identifier hs-type">method</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-comment">-- | 'Url'&#8212;location of resource</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214428"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-comment">-- | Body of the request</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><a href="#local-6989586621679214429"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-comment">-- | Collection of optional parameters</span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214428"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-comment">-- | How to perform request</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214431"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-comment">-- | Result</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><a href="#local-6989586621679214431"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214427"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-513"></span><span id="req%27"><span class="annot"><span class="annottext">req' :: method
-&gt; Url scheme
-&gt; body
-&gt; Option scheme
-&gt; (Request -&gt; Manager -&gt; m a)
-&gt; m a
</span><a href="Network.HTTP.Req.html#req%27"><span class="hs-identifier hs-var hs-var">req'</span></a></span></span><span> </span><span id="local-6989586621679213850"><span class="annot"><span class="annottext">method :: method
</span><a href="#local-6989586621679213850"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679213849"><span class="annot"><span class="annottext">url :: Url scheme
</span><a href="#local-6989586621679213849"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span id="local-6989586621679213848"><span class="annot"><span class="annottext">body :: body
</span><a href="#local-6989586621679213848"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679213847"><span class="annot"><span class="annottext">options :: Option scheme
</span><a href="#local-6989586621679213847"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621679213846"><span class="annot"><span class="annottext">m :: Request -&gt; Manager -&gt; m a
</span><a href="#local-6989586621679213846"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>  </span><span id="local-6989586621679213845"><span class="annot"><span class="annottext">HttpConfig
</span><a href="#local-6989586621679213845"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m HttpConfig
forall (m :: * -&gt; *). MonadHttp m =&gt; m HttpConfig
</span><a href="Network.HTTP.Req.html#getHttpConfig"><span class="hs-identifier hs-var">getHttpConfig</span></a></span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- NOTE First appearance of any given header wins. This allows to</span><span>
</span><span id="line-516"></span><span>      </span><span class="hs-comment">-- &#8220;overwrite&#8221; headers when we construct a request by cons-ing.</span><span>
</span><span id="line-517"></span><span>      </span><span id="local-6989586621679213844"><span class="annot"><span class="annottext">nubHeaders :: Endo Request
</span><a href="#local-6989586621679213844"><span class="hs-identifier hs-var hs-var">nubHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Endo Request
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Endo Request)
-&gt; (Request -&gt; Request) -&gt; Endo Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213842"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213842"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-518"></span><span>        </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213842"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">requestHeaders :: RequestHeaders
</span><span class="hs-identifier hs-var">L.requestHeaders</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((HeaderName, ByteString) -&gt; (HeaderName, ByteString) -&gt; Bool)
-&gt; RequestHeaders -&gt; RequestHeaders
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nubBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName -&gt; HeaderName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(HeaderName -&gt; HeaderName -&gt; Bool)
-&gt; ((HeaderName, ByteString) -&gt; HeaderName)
-&gt; (HeaderName, ByteString)
-&gt; (HeaderName, ByteString)
-&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">(HeaderName, ByteString) -&gt; HeaderName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; RequestHeaders
</span><span class="hs-identifier hs-var hs-var">L.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213842"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-519"></span><span>      </span><span id="local-6989586621679213840"><span class="annot"><span class="annottext">request' :: Request
</span><a href="#local-6989586621679213840"><span class="hs-identifier hs-var hs-var">request'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-520"></span><span>        </span><span class="annot"><span class="annottext">(Endo Request -&gt; Request -&gt; Request)
-&gt; Request -&gt; Endo Request -&gt; Request
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Endo Request -&gt; Request -&gt; Request
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">appEndo</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">L.defaultRequest</span></span><span> </span><span class="annot"><span class="annottext">(Endo Request -&gt; Request) -&gt; Endo Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-521"></span><span>          </span><span class="hs-comment">-- NOTE The order of 'mappend's matters, here method is overwritten</span><span>
</span><span id="line-522"></span><span>          </span><span class="hs-comment">-- first and 'options' take effect last. In particular, this means</span><span>
</span><span id="line-523"></span><span>          </span><span class="hs-comment">-- that 'options' can overwrite things set by other request</span><span>
</span><span id="line-524"></span><span>          </span><span class="hs-comment">-- components, which is useful for setting port number,</span><span>
</span><span id="line-525"></span><span>          </span><span class="hs-comment">-- &quot;Content-Type&quot; header, etc.</span><span>
</span><span id="line-526"></span><span>          </span><span class="annot"><span class="annottext">Endo Request
</span><a href="#local-6989586621679213844"><span class="hs-identifier hs-var">nubHeaders</span></a></span><span>
</span><span id="line-527"></span><span>            </span><span class="annot"><span class="annottext">Endo Request -&gt; Endo Request -&gt; Endo Request
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Option scheme -&gt; Endo Request
forall a. RequestComponent a =&gt; a -&gt; Endo Request
</span><a href="Network.HTTP.Req.html#getRequestMod"><span class="hs-identifier hs-var">getRequestMod</span></a></span><span> </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213847"><span class="hs-identifier hs-var">options</span></a></span><span>
</span><span id="line-528"></span><span>            </span><span class="annot"><span class="annottext">Endo Request -&gt; Endo Request -&gt; Endo Request
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HttpConfig -&gt; Endo Request
forall a. RequestComponent a =&gt; a -&gt; Endo Request
</span><a href="Network.HTTP.Req.html#getRequestMod"><span class="hs-identifier hs-var">getRequestMod</span></a></span><span> </span><span class="annot"><span class="annottext">HttpConfig
</span><a href="#local-6989586621679213845"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-529"></span><span>            </span><span class="annot"><span class="annottext">Endo Request -&gt; Endo Request -&gt; Endo Request
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Womb &quot;body&quot; body -&gt; Endo Request
forall a. RequestComponent a =&gt; a -&gt; Endo Request
</span><a href="Network.HTTP.Req.html#getRequestMod"><span class="hs-identifier hs-var">getRequestMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">body -&gt; Womb &quot;body&quot; body
forall (tag :: Symbol) a. a -&gt; Womb tag a
</span><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-var">Womb</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621679213848"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-type">Womb</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679214429"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>            </span><span class="annot"><span class="annottext">Endo Request -&gt; Endo Request -&gt; Endo Request
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Url scheme -&gt; Endo Request
forall a. RequestComponent a =&gt; a -&gt; Endo Request
</span><a href="Network.HTTP.Req.html#getRequestMod"><span class="hs-identifier hs-var">getRequestMod</span></a></span><span> </span><span class="annot"><span class="annottext">Url scheme
</span><a href="#local-6989586621679213849"><span class="hs-identifier hs-var">url</span></a></span><span>
</span><span id="line-531"></span><span>            </span><span class="annot"><span class="annottext">Endo Request -&gt; Endo Request -&gt; Endo Request
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Womb &quot;method&quot; method -&gt; Endo Request
forall a. RequestComponent a =&gt; a -&gt; Endo Request
</span><a href="Network.HTTP.Req.html#getRequestMod"><span class="hs-identifier hs-var">getRequestMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">method -&gt; Womb &quot;method&quot; method
forall (tag :: Symbol) a. a -&gt; Womb tag a
</span><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-var">Womb</span></a></span><span> </span><span class="annot"><span class="annottext">method
</span><a href="#local-6989586621679213850"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-type">Womb</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;method&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679214430"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>  </span><span id="local-6989586621679213834"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213834"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Option scheme -&gt; Request -&gt; m Request
forall (m :: * -&gt; *) (scheme :: Scheme).
MonadIO m =&gt;
Option scheme -&gt; Request -&gt; m Request
</span><a href="Network.HTTP.Req.html#finalizeRequest"><span class="hs-identifier hs-var">finalizeRequest</span></a></span><span> </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213847"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213840"><span class="hs-identifier hs-var">request'</span></a></span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="annottext">(Manager -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; (Manager -&gt; m a) -&gt; m a
</span><a href="Network.HTTP.Req.html#withReqManager"><span class="hs-identifier hs-var">withReqManager</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; m a
</span><a href="#local-6989586621679213846"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213834"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="hs-comment">-- | Perform an action using the global implicit 'L.Manager' that the rest</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- of the library uses. This allows to reuse connections that the</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- 'L.Manager' controls.</span><span>
</span><span id="line-538"></span><span id="local-6989586621679214337"><span id="local-6989586621679214338"><span class="annot"><a href="Network.HTTP.Req.html#withReqManager"><span class="hs-identifier hs-type">withReqManager</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679214338"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214338"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214337"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214338"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214337"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-539"></span><span id="withReqManager"><span class="annot"><span class="annottext">withReqManager :: (Manager -&gt; m a) -&gt; m a
</span><a href="Network.HTTP.Req.html#withReqManager"><span class="hs-identifier hs-var hs-var">withReqManager</span></a></span></span><span> </span><span id="local-6989586621679213832"><span class="annot"><span class="annottext">m :: Manager -&gt; m a
</span><a href="#local-6989586621679213832"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Manager -&gt; m Manager
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IORef Manager -&gt; IO Manager
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef Manager
</span><a href="Network.HTTP.Req.html#globalManager"><span class="hs-identifier hs-var">globalManager</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Manager -&gt; (Manager -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Manager -&gt; m a
</span><a href="#local-6989586621679213832"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">-- | Global 'L.Manager' that 'req' uses. Here we just go with the default</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- settings, so users don't need to deal with this manager stuff at all, but</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- when we create a request, instance 'HttpConfig' can affect the default</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- settings via 'getHttpConfig'.</span><span>
</span><span id="line-545"></span><span class="hs-comment">--</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- A note about safety, in case 'unsafePerformIO' looks suspicious to you.</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- The value of 'globalManager' is named and lives on top level. This means</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- it will be shared, i.e. computed only once on the first use of the</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- manager. From that moment on the 'IORef' will be just reused&#8212;exactly the</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- behavior we want here in order to maximize connection sharing. GHC could</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- spoil the plan by inlining the definition, hence the @NOINLINE@ pragma.</span><span>
</span><span id="line-552"></span><span class="annot"><a href="Network.HTTP.Req.html#globalManager"><span class="hs-identifier hs-type">globalManager</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Manager</span></span><span>
</span><span id="line-553"></span><span id="globalManager"><span class="annot"><span class="annottext">globalManager :: IORef Manager
</span><a href="Network.HTTP.Req.html#globalManager"><span class="hs-identifier hs-var hs-var">globalManager</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (IORef Manager) -&gt; IORef Manager
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (IORef Manager) -&gt; IORef Manager)
-&gt; IO (IORef Manager) -&gt; IORef Manager
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-554"></span><span>  </span><span id="local-6989586621679213830"><span class="annot"><span class="annottext">ConnectionContext
</span><a href="#local-6989586621679213830"><span class="hs-identifier hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ConnectionContext
</span><span class="hs-identifier hs-var">NC.initConnectionContext</span></span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213828"><span class="annot"><span class="annottext">settings :: ManagerSettings
</span><a href="#local-6989586621679213828"><span class="hs-identifier hs-var hs-var">settings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-556"></span><span>        </span><span class="annot"><span class="annottext">Maybe ConnectionContext
-&gt; TLSSettings -&gt; Maybe SockSettings -&gt; ManagerSettings
</span><span class="hs-identifier hs-var">L.mkManagerSettingsContext</span></span><span>
</span><span id="line-557"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionContext -&gt; Maybe ConnectionContext
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ConnectionContext
</span><a href="#local-6989586621679213830"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool -&gt; TLSSettings
</span><span class="hs-identifier hs-var">NC.TLSSettingsSimple</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>          </span><span class="annot"><span class="annottext">Maybe SockSettings
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-560"></span><span>  </span><span id="local-6989586621679213825"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679213825"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; IO Manager
</span><span class="hs-identifier hs-var">L.newManager</span></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679213828"><span class="hs-identifier hs-var">settings</span></a></span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><span class="annottext">Manager -&gt; IO (IORef Manager)
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679213825"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-562"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#globalManager"><span class="hs-pragma hs-type">globalManager</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- Embedding requests in your monad</span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- $embedding-requests</span><span>
</span><span id="line-568"></span><span class="hs-comment">--</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- To use 'req' in your monad, all you need to do is to make the monad an</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- instance of the 'MonadHttp' type class.</span><span>
</span><span id="line-571"></span><span class="hs-comment">--</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- When writing a library, keep your API polymorphic in terms of</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- 'MonadHttp', only define instance of 'MonadHttp' in final application.</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- Another option is to use a @newtype@-wrapped monad stack and define</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- 'MonadHttp' for it. As of version /0.4.0/, the 'Req' monad that follows</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- this strategy is provided out-of-the-box (see below).</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">-- | A type class for monads that support performing HTTP requests.</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- Typically, you only need to define the 'handleHttpException' method</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- unless you want to tweak 'HttpConfig'.</span><span>
</span><span id="line-581"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679214416"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadHttp"><span class="annot"><a href="Network.HTTP.Req.html#MonadHttp"><span class="hs-identifier hs-var">MonadHttp</span></a></span></span><span> </span><span id="local-6989586621679214416"><span class="annot"><a href="#local-6989586621679214416"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-comment">-- | This method describes how to deal with 'HttpException' that was</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-comment">-- caught by the library. One option is to re-throw it if you are OK with</span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-comment">-- exceptions, but if you prefer working with something like</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-comment">-- 'Control.Monad.Except.MonadError', this is the right place to pass it to</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-comment">-- 'Control.Monad.Except.throwError'.</span><span>
</span><span id="line-587"></span><span>  </span><span id="local-6989586621679214366"><span id="handleHttpException"><span class="annot"><a href="Network.HTTP.Req.html#handleHttpException"><span class="hs-identifier hs-type">handleHttpException</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpException"><span class="hs-identifier hs-type">HttpException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214416"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214366"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-comment">-- | Return 'HttpConfig' to be used when performing HTTP requests. Default</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-comment">-- implementation returns its 'def' value, which is described in the</span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-comment">-- documentation for the type. Common usage pattern with manually defined</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-comment">-- 'getHttpConfig' is to return some hard-coded value, or a value</span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-comment">-- extracted from 'Control.Monad.Reader.MonadReader' if a more flexible</span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-comment">-- approach to configuration is desirable.</span><span>
</span><span id="line-595"></span><span>  </span><span id="getHttpConfig"><span class="annot"><a href="Network.HTTP.Req.html#getHttpConfig"><span class="hs-identifier hs-type">getHttpConfig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679214416"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type">HttpConfig</span></a></span><span>
</span><span id="line-596"></span><span>  </span><span id="local-6989586621679213823"><span class="annot"><a href="Network.HTTP.Req.html#getHttpConfig"><span class="hs-identifier hs-var hs-var">getHttpConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpConfig -&gt; m HttpConfig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HttpConfig
</span><a href="Network.HTTP.Req.html#defaultHttpConfig"><span class="hs-identifier hs-var">defaultHttpConfig</span></a></span></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="hs-comment">-- | 'HttpConfig' contains general and default settings to be used when</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- making HTTP requests.</span><span>
</span><span id="line-600"></span><span class="hs-keyword">data</span><span> </span><span id="HttpConfig"><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-var">HttpConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpConfig"><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-var">HttpConfig</span></a></span></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Proxy to use. By default values of @HTTP_PROXY@ and @HTTPS_PROXY@</span><span>
</span><span id="line-602"></span><span>    </span><span class="hs-comment">-- environment variables are respected, this setting overwrites them.</span><span>
</span><span id="line-603"></span><span>    </span><span class="hs-comment">-- Default value: 'Nothing'.</span><span>
</span><span id="line-604"></span><span>    </span><span id="httpConfigProxy"><span class="annot"><span class="annottext">HttpConfig -&gt; Maybe Proxy
</span><a href="Network.HTTP.Req.html#httpConfigProxy"><span class="hs-identifier hs-var hs-var">httpConfigProxy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Proxy</span></span><span class="hs-special">,</span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-comment">-- | How many redirects to follow when getting a resource. Default</span><span>
</span><span id="line-606"></span><span>    </span><span class="hs-comment">-- value: 10.</span><span>
</span><span id="line-607"></span><span>    </span><span id="httpConfigRedirectCount"><span class="annot"><span class="annottext">HttpConfig -&gt; Int
</span><a href="Network.HTTP.Req.html#httpConfigRedirectCount"><span class="hs-identifier hs-var hs-var">httpConfigRedirectCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-608"></span><span>    </span><span class="hs-comment">-- | Alternative 'L.Manager' to use. 'Nothing' (default value) means</span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-comment">-- that the default implicit manager will be used (that's what you want</span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-comment">-- in 99% of cases).</span><span>
</span><span id="line-611"></span><span>    </span><span id="httpConfigAltManager"><span class="annot"><span class="annottext">HttpConfig -&gt; Maybe Manager
</span><a href="Network.HTTP.Req.html#httpConfigAltManager"><span class="hs-identifier hs-var hs-var">httpConfigAltManager</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Manager</span></span><span class="hs-special">,</span><span>
</span><span id="line-612"></span><span>    </span><span class="hs-comment">-- | Function to check the response immediately after receiving the</span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-comment">-- status and headers, before streaming of response body. The third</span><span>
</span><span id="line-614"></span><span>    </span><span class="hs-comment">-- argument is the beginning of response body (typically first 1024</span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-comment">-- bytes). This is used for throwing exceptions on non-success status</span><span>
</span><span id="line-616"></span><span>    </span><span class="hs-comment">-- codes by default (set to @\\_ _ _ -&gt; Nothing@ if this behavior is not</span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-comment">-- desirable).</span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-comment">-- When the value this function returns is 'Nothing', nothing will</span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-comment">-- happen. When it there is 'L.HttpExceptionContent' inside 'Just', it</span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-comment">-- will be thrown.</span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-comment">-- Throwing is better then just returning a request with non-2xx status</span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-comment">-- code because in that case something is wrong and we need a way to</span><span>
</span><span id="line-625"></span><span>    </span><span class="hs-comment">-- short-cut execution (also remember that Req retries automatically on</span><span>
</span><span id="line-626"></span><span>    </span><span class="hs-comment">-- request timeouts and such, so when your request fails, it's certainly</span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-comment">-- something exceptional). The thrown exception is caught by the library</span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-comment">-- though and is available in 'handleHttpException'.</span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-630"></span><span>    </span><span class="hs-comment">-- __Note__: signature of this function was changed in the version</span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-comment">-- /1.0.0/.</span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-634"></span><span>    </span><span id="httpConfigCheckResponse"><span class="annot"><span class="annottext">HttpConfig
-&gt; forall b.
   Request -&gt; Response b -&gt; ByteString -&gt; Maybe HttpExceptionContent
</span><a href="Network.HTTP.Req.html#httpConfigCheckResponse"><span class="hs-identifier hs-var hs-var">httpConfigCheckResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-635"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679214420"><span class="annot"><a href="#local-6989586621679214420"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-636"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-637"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><a href="#local-6989586621679214420"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-638"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-639"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.HttpExceptionContent</span></span><span class="hs-special">,</span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-comment">-- | The retry policy to use for request retrying. By default 'def' is</span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-comment">-- used (see 'RetryPolicyM').</span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-comment">-- __Note__: signature of this function was changed in the version</span><span>
</span><span id="line-644"></span><span>    </span><span class="hs-comment">-- /1.0.0/.</span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-647"></span><span>    </span><span id="httpConfigRetryPolicy"><span class="annot"><span class="annottext">HttpConfig -&gt; RetryPolicyM IO
</span><a href="Network.HTTP.Req.html#httpConfigRetryPolicy"><span class="hs-identifier hs-var hs-var">httpConfigRetryPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RetryPolicyM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">,</span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-comment">-- | The function is used to decide whether to retry a request. 'True'</span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-comment">-- means that the request should be retried.</span><span>
</span><span id="line-650"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-651"></span><span>    </span><span class="hs-comment">-- __Note__: signature of this function was changed in the version</span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-comment">-- /1.0.0/.</span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-655"></span><span>    </span><span id="httpConfigRetryJudge"><span class="annot"><span class="annottext">HttpConfig -&gt; forall b. RetryStatus -&gt; Response b -&gt; Bool
</span><a href="Network.HTTP.Req.html#httpConfigRetryJudge"><span class="hs-identifier hs-var hs-var">httpConfigRetryJudge</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679214417"><span class="annot"><a href="#local-6989586621679214417"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RetryStatus</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><a href="#local-6989586621679214417"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="hs-comment">-- | Default value of 'HttpConfig'.</span><span>
</span><span id="line-660"></span><span class="hs-comment">--</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- @since 2.0.0</span><span>
</span><span id="line-662"></span><span class="annot"><a href="Network.HTTP.Req.html#defaultHttpConfig"><span class="hs-identifier hs-type">defaultHttpConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type">HttpConfig</span></a></span><span>
</span><span id="line-663"></span><span id="defaultHttpConfig"><span class="annot"><span class="annottext">defaultHttpConfig :: HttpConfig
</span><a href="Network.HTTP.Req.html#defaultHttpConfig"><span class="hs-identifier hs-var hs-var">defaultHttpConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>  </span><span class="annot"><span class="annottext">HttpConfig :: Maybe Proxy
-&gt; Int
-&gt; Maybe Manager
-&gt; (forall b.
    Request -&gt; Response b -&gt; ByteString -&gt; Maybe HttpExceptionContent)
-&gt; RetryPolicyM IO
-&gt; (forall b. RetryStatus -&gt; Response b -&gt; Bool)
-&gt; HttpConfig
</span><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type hs-type">HttpConfig</span></a></span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">httpConfigProxy :: Maybe Proxy
</span><a href="Network.HTTP.Req.html#httpConfigProxy"><span class="hs-identifier hs-var">httpConfigProxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><span class="annottext">httpConfigRedirectCount :: Int
</span><a href="Network.HTTP.Req.html#httpConfigRedirectCount"><span class="hs-identifier hs-var">httpConfigRedirectCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">,</span><span>
</span><span id="line-667"></span><span>      </span><span class="annot"><span class="annottext">httpConfigAltManager :: Maybe Manager
</span><a href="Network.HTTP.Req.html#httpConfigAltManager"><span class="hs-identifier hs-var">httpConfigAltManager</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Manager
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-668"></span><span>      </span><span class="annot"><span class="annottext">httpConfigCheckResponse :: forall b.
Request -&gt; Response b -&gt; ByteString -&gt; Maybe HttpExceptionContent
</span><a href="Network.HTTP.Req.html#httpConfigCheckResponse"><span class="hs-identifier hs-var">httpConfigCheckResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679213821"><span class="annot"><span class="annottext">response :: Response b
</span><a href="#local-6989586621679213821"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span id="local-6989586621679213820"><span class="annot"><span class="annottext">preview :: ByteString
</span><a href="#local-6989586621679213820"><span class="hs-identifier hs-var">preview</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-669"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213819"><span class="annot"><span class="annottext">scode :: Int
</span><a href="#local-6989586621679213819"><span class="hs-identifier hs-var hs-var">scode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response b -&gt; Int
forall body. Response body -&gt; Int
</span><a href="#local-6989586621679213818"><span class="hs-identifier hs-var">statusCode</span></a></span><span> </span><span class="annot"><span class="annottext">Response b
</span><a href="#local-6989586621679213821"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-670"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213819"><span class="hs-identifier hs-var">scode</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213819"><span class="hs-identifier hs-var">scode</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">300</span></span><span>
</span><span id="line-671"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe HttpExceptionContent
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-672"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; Maybe HttpExceptionContent
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response () -&gt; ByteString -&gt; HttpExceptionContent
</span><span class="hs-identifier hs-var">L.StatusCodeException</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response b -&gt; Response ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Response b
</span><a href="#local-6989586621679213821"><span class="hs-identifier hs-var">response</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213820"><span class="hs-identifier hs-var">preview</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-673"></span><span>      </span><span class="annot"><span class="annottext">httpConfigRetryPolicy :: RetryPolicyM IO
</span><a href="Network.HTTP.Req.html#httpConfigRetryPolicy"><span class="hs-identifier hs-var">httpConfigRetryPolicy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RetryPolicyM IO
RetryPolicy
</span><span class="hs-identifier hs-var">retryPolicyDefault</span></span><span class="hs-special">,</span><span>
</span><span id="line-674"></span><span>      </span><span class="annot"><span class="annottext">httpConfigRetryJudge :: forall b. RetryStatus -&gt; Response b -&gt; Bool
</span><a href="Network.HTTP.Req.html#httpConfigRetryJudge"><span class="hs-identifier hs-var">httpConfigRetryJudge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679213811"><span class="annot"><span class="annottext">response :: Response b
</span><a href="#local-6989586621679213811"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-675"></span><span>        </span><span class="annot"><span class="annottext">Response b -&gt; Int
forall body. Response body -&gt; Int
</span><a href="#local-6989586621679213818"><span class="hs-identifier hs-var">statusCode</span></a></span><span> </span><span class="annot"><span class="annottext">Response b
</span><a href="#local-6989586621679213811"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-676"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">408</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Request timeout</span><span>
</span><span id="line-677"></span><span>                   </span><span class="annot"><span class="hs-number">504</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Gateway timeout</span><span>
</span><span id="line-678"></span><span>                   </span><span class="annot"><span class="hs-number">524</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- A timeout occurred</span><span>
</span><span id="line-679"></span><span>                   </span><span class="annot"><span class="hs-number">598</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- (Informal convention) Network read timeout error</span><span>
</span><span id="line-680"></span><span>                   </span><span class="annot"><span class="hs-number">599</span></span><span> </span><span class="hs-comment">-- (Informal convention) Network connect timeout error</span><span>
</span><span id="line-681"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-682"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-683"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-684"></span><span>    </span><span id="local-6989586621679213818"><span class="annot"><span class="annottext">statusCode :: Response body -&gt; Int
</span><a href="#local-6989586621679213818"><span class="hs-identifier hs-var hs-var">statusCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Int
</span><span class="hs-identifier hs-var hs-var">Y.statusCode</span></span><span> </span><span class="annot"><span class="annottext">(Status -&gt; Int)
-&gt; (Response body -&gt; Status) -&gt; Response body -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response body -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">L.responseStatus</span></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#RequestComponent"><span class="hs-identifier hs-type">RequestComponent</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type">HttpConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>  </span><span id="local-6989586621679213805"><span class="annot"><span class="annottext">getRequestMod :: HttpConfig -&gt; Endo Request
</span><a href="#local-6989586621679213805"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestMod</span></a></span></span><span> </span><span id="local-6989586621679213799"><span id="local-6989586621679213800"><span id="local-6989586621679213801"><span id="local-6989586621679213802"><span id="local-6989586621679213803"><span id="local-6989586621679213804"><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type">HttpConfig</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Endo Request
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Endo Request)
-&gt; (Request -&gt; Request) -&gt; Endo Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213798"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213798"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213798"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Maybe Proxy
</span><a href="#local-6989586621679213797"><span class="hs-identifier hs-var">L.proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679213804"><span class="hs-identifier hs-var">httpConfigProxy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-690"></span><span>        </span><span class="annot"><span class="annottext">redirectCount :: Int
</span><a href="#local-6989586621679213796"><span class="hs-identifier hs-var">L.redirectCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213803"><span class="hs-identifier hs-var">httpConfigRedirectCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-691"></span><span>        </span><span class="annot"><span class="annottext">requestManagerOverride :: Maybe Manager
</span><a href="#local-6989586621679213795"><span class="hs-identifier hs-var">LI.requestManagerOverride</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Manager
</span><a href="#local-6989586621679213802"><span class="hs-identifier hs-var">httpConfigAltManager</span></a></span><span>
</span><span id="line-692"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-comment">-- | A monad that allows to run 'req' in any 'IO'-enabled monad without</span><span>
</span><span id="line-695"></span><span class="hs-comment">-- having to define new instances.</span><span>
</span><span id="line-696"></span><span class="hs-comment">--</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- @since 0.4.0</span><span>
</span><span id="line-698"></span><span class="hs-keyword">newtype</span><span> </span><span id="Req"><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-var">Req</span></a></span></span><span> </span><span id="local-6989586621679214265"><span class="annot"><a href="#local-6989586621679214265"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Req"><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-var">Req</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type">HttpConfig</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679214265"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679213790"><span id="local-6989586621679213792"><span class="annot"><span class="annottext">a -&gt; Req b -&gt; Req a
(a -&gt; b) -&gt; Req a -&gt; Req b
(forall a b. (a -&gt; b) -&gt; Req a -&gt; Req b)
-&gt; (forall a b. a -&gt; Req b -&gt; Req a) -&gt; Functor Req
forall a b. a -&gt; Req b -&gt; Req a
forall a b. (a -&gt; b) -&gt; Req a -&gt; Req b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Req b -&gt; Req a
$c&lt;$ :: forall a b. a -&gt; Req b -&gt; Req a
fmap :: (a -&gt; b) -&gt; Req a -&gt; Req b
$cfmap :: forall a b. (a -&gt; b) -&gt; Req a -&gt; Req b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-701"></span><span>      </span><span id="local-6989586621679213778"><span id="local-6989586621679213780"><span id="local-6989586621679213782"><span id="local-6989586621679213784"><span id="local-6989586621679213786"><span class="annot"><span class="annottext">Functor Req
a -&gt; Req a
Functor Req =&gt;
(forall a. a -&gt; Req a)
-&gt; (forall a b. Req (a -&gt; b) -&gt; Req a -&gt; Req b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; Req a -&gt; Req b -&gt; Req c)
-&gt; (forall a b. Req a -&gt; Req b -&gt; Req b)
-&gt; (forall a b. Req a -&gt; Req b -&gt; Req a)
-&gt; Applicative Req
Req a -&gt; Req b -&gt; Req b
Req a -&gt; Req b -&gt; Req a
Req (a -&gt; b) -&gt; Req a -&gt; Req b
(a -&gt; b -&gt; c) -&gt; Req a -&gt; Req b -&gt; Req c
forall a. a -&gt; Req a
forall a b. Req a -&gt; Req b -&gt; Req a
forall a b. Req a -&gt; Req b -&gt; Req b
forall a b. Req (a -&gt; b) -&gt; Req a -&gt; Req b
forall a b c. (a -&gt; b -&gt; c) -&gt; Req a -&gt; Req b -&gt; Req c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: Req a -&gt; Req b -&gt; Req a
$c&lt;* :: forall a b. Req a -&gt; Req b -&gt; Req a
*&gt; :: Req a -&gt; Req b -&gt; Req b
$c*&gt; :: forall a b. Req a -&gt; Req b -&gt; Req b
liftA2 :: (a -&gt; b -&gt; c) -&gt; Req a -&gt; Req b -&gt; Req c
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Req a -&gt; Req b -&gt; Req c
&lt;*&gt; :: Req (a -&gt; b) -&gt; Req a -&gt; Req b
$c&lt;*&gt; :: forall a b. Req (a -&gt; b) -&gt; Req a -&gt; Req b
pure :: a -&gt; Req a
$cpure :: forall a. a -&gt; Req a
$cp1Applicative :: Functor Req
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-702"></span><span>      </span><span id="local-6989586621679213770"><span id="local-6989586621679213772"><span id="local-6989586621679213774"><span class="annot"><span class="annottext">Applicative Req
a -&gt; Req a
Applicative Req =&gt;
(forall a b. Req a -&gt; (a -&gt; Req b) -&gt; Req b)
-&gt; (forall a b. Req a -&gt; Req b -&gt; Req b)
-&gt; (forall a. a -&gt; Req a)
-&gt; Monad Req
Req a -&gt; (a -&gt; Req b) -&gt; Req b
Req a -&gt; Req b -&gt; Req b
forall a. a -&gt; Req a
forall a b. Req a -&gt; Req b -&gt; Req b
forall a b. Req a -&gt; (a -&gt; Req b) -&gt; Req b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; Req a
$creturn :: forall a. a -&gt; Req a
&gt;&gt; :: Req a -&gt; Req b -&gt; Req b
$c&gt;&gt; :: forall a b. Req a -&gt; Req b -&gt; Req b
&gt;&gt;= :: Req a -&gt; (a -&gt; Req b) -&gt; Req b
$c&gt;&gt;= :: forall a b. Req a -&gt; (a -&gt; Req b) -&gt; Req b
$cp1Monad :: Applicative Req
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-703"></span><span>      </span><span id="local-6989586621679213766"><span class="annot"><span class="annottext">Monad Req
Monad Req =&gt; (forall a. IO a -&gt; Req a) -&gt; MonadIO Req
IO a -&gt; Req a
forall a. IO a -&gt; Req a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: IO a -&gt; Req a
$cliftIO :: forall a. IO a -&gt; Req a
$cp1MonadIO :: Monad Req
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></span></span><span>
</span><span id="line-704"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBase</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-type">Req</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-707"></span><span>  </span><span id="local-6989586621679213758"><span class="annot"><span class="annottext">liftBase :: IO &#945; -&gt; Req &#945;
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">liftBase</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO &#945; -&gt; Req &#945;
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-type">Req</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StM"><span class="annot"><span class="hs-identifier hs-var">StM</span></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-type">Req</span></a></span><span> </span><span id="local-6989586621679213752"><span class="annot"><a href="#local-6989586621679213752"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679213752"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-711"></span><span>  </span><span id="local-6989586621679213751"><span class="annot"><span class="annottext">liftBaseWith :: (RunInBase Req IO -&gt; IO a) -&gt; Req a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">liftBaseWith</span></span></span><span> </span><span id="local-6989586621679213749"><span class="annot"><span class="annottext">f :: RunInBase Req IO -&gt; IO a
</span><a href="#local-6989586621679213749"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT HttpConfig IO a -&gt; Req a
forall a. ReaderT HttpConfig IO a -&gt; Req a
</span><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-var">Req</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HttpConfig IO a -&gt; Req a)
-&gt; ((HttpConfig -&gt; IO a) -&gt; ReaderT HttpConfig IO a)
-&gt; (HttpConfig -&gt; IO a)
-&gt; Req a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HttpConfig -&gt; IO a) -&gt; ReaderT HttpConfig IO a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">ReaderT</span></span><span> </span><span class="annot"><span class="annottext">((HttpConfig -&gt; IO a) -&gt; Req a) -&gt; (HttpConfig -&gt; IO a) -&gt; Req a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213747"><span class="annot"><span class="annottext">r :: HttpConfig
</span><a href="#local-6989586621679213747"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunInBase Req IO -&gt; IO a
</span><a href="#local-6989586621679213749"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpConfig -&gt; Req a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; HttpConfig -&gt; Req a -&gt; m a
</span><a href="Network.HTTP.Req.html#runReq"><span class="hs-identifier hs-var">runReq</span></a></span><span> </span><span class="annot"><span class="annottext">HttpConfig
</span><a href="#local-6989586621679213747"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">liftBaseWith</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-713"></span><span>  </span><span id="local-6989586621679213746"><span class="annot"><span class="annottext">restoreM :: StM Req a -&gt; Req a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreM</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT HttpConfig IO a -&gt; Req a
forall a. ReaderT HttpConfig IO a -&gt; Req a
</span><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-var">Req</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HttpConfig IO a -&gt; Req a)
-&gt; (a -&gt; ReaderT HttpConfig IO a) -&gt; a -&gt; Req a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HttpConfig -&gt; IO a) -&gt; ReaderT HttpConfig IO a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">ReaderT</span></span><span> </span><span class="annot"><span class="annottext">((HttpConfig -&gt; IO a) -&gt; ReaderT HttpConfig IO a)
-&gt; (a -&gt; HttpConfig -&gt; IO a) -&gt; a -&gt; ReaderT HttpConfig IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; HttpConfig -&gt; IO a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; HttpConfig -&gt; IO a)
-&gt; (a -&gt; IO a) -&gt; a -&gt; HttpConfig -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">restoreM</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#MonadHttp"><span class="hs-identifier hs-type">MonadHttp</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-type">Req</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-717"></span><span>  </span><span id="local-6989586621679213740"><span class="annot"><span class="annottext">handleHttpException :: HttpException -&gt; Req a
</span><a href="#local-6989586621679213740"><span class="hs-identifier hs-var hs-var hs-var hs-var">handleHttpException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT HttpConfig IO a -&gt; Req a
forall a. ReaderT HttpConfig IO a -&gt; Req a
</span><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-var">Req</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HttpConfig IO a -&gt; Req a)
-&gt; (HttpException -&gt; ReaderT HttpConfig IO a)
-&gt; HttpException
-&gt; Req a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; ReaderT HttpConfig IO a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; ReaderT HttpConfig IO a)
-&gt; (HttpException -&gt; IO a)
-&gt; HttpException
-&gt; ReaderT HttpConfig IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span>
</span><span id="line-718"></span><span>  </span><span id="local-6989586621679213738"><span class="annot"><span class="annottext">getHttpConfig :: Req HttpConfig
</span><a href="#local-6989586621679213738"><span class="hs-identifier hs-var hs-var hs-var hs-var">getHttpConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT HttpConfig IO HttpConfig -&gt; Req HttpConfig
forall a. ReaderT HttpConfig IO a -&gt; Req a
</span><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-var">Req</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT HttpConfig IO HttpConfig
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-719"></span><span>
</span><span id="line-720"></span><span class="hs-comment">-- | Run a computation in the 'Req' monad with the given 'HttpConfig'. In</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- case of exceptional situation an 'HttpException' will be thrown.</span><span>
</span><span id="line-722"></span><span class="hs-comment">--</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- @since 0.4.0</span><span>
</span><span id="line-724"></span><span id="local-6989586621679214259"><span id="local-6989586621679214260"><span class="annot"><a href="Network.HTTP.Req.html#runReq"><span class="hs-identifier hs-type">runReq</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-725"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679214260"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-comment">-- | 'HttpConfig' to use</span><span>
</span><span id="line-727"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#HttpConfig"><span class="hs-identifier hs-type">HttpConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-comment">-- | Computation to run</span><span>
</span><span id="line-729"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-type">Req</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214259"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-730"></span><span>  </span><span class="annot"><a href="#local-6989586621679214260"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214259"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-731"></span><span id="runReq"><span class="annot"><span class="annottext">runReq :: HttpConfig -&gt; Req a -&gt; m a
</span><a href="Network.HTTP.Req.html#runReq"><span class="hs-identifier hs-var hs-var">runReq</span></a></span></span><span> </span><span id="local-6989586621679213736"><span class="annot"><span class="annottext">config :: HttpConfig
</span><a href="#local-6989586621679213736"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Req"><span class="hs-identifier hs-type">Req</span></a></span><span> </span><span id="local-6989586621679213735"><span class="annot"><span class="annottext">m :: ReaderT HttpConfig IO a
</span><a href="#local-6989586621679213735"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT HttpConfig IO a -&gt; HttpConfig -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT HttpConfig IO a
</span><a href="#local-6989586621679213735"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">HttpConfig
</span><a href="#local-6989586621679213736"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- Request&#8212;Method</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="hs-comment">-- $method</span><span>
</span><span id="line-737"></span><span class="hs-comment">--</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- The package supports all methods as defined by RFC 2616, and 'PATCH'</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- which is defined by RFC 5789&#8212;that should be enough to talk to RESTful</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- APIs. In some cases, however, you may want to add more methods (e.g. you</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- work with WebDAV &lt;https://en.wikipedia.org/wiki/WebDAV&gt;); no need to</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- compromise on type safety and hack, it only takes a couple of seconds to</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- define a new method that will works seamlessly, see 'HttpMethod'.</span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span class="hs-comment">-- | 'GET' method.</span><span>
</span><span id="line-746"></span><span class="hs-keyword">data</span><span> </span><span id="GET"><span class="annot"><a href="Network.HTTP.Req.html#GET"><span class="hs-identifier hs-var">GET</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GET"><span class="annot"><a href="Network.HTTP.Req.html#GET"><span class="hs-identifier hs-var">GET</span></a></span></span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#GET"><span class="hs-identifier hs-type">GET</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-749"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#GET"><span class="hs-identifier hs-type">GET</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span>
</span><span id="line-750"></span><span>  </span><span id="local-6989586621679213729"><span class="annot"><span class="annottext">httpMethodName :: Proxy GET -&gt; ByteString
</span><a href="Network.HTTP.Req.html#httpMethodName"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodGet</span></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="hs-comment">-- | 'POST' method.</span><span>
</span><span id="line-753"></span><span class="hs-keyword">data</span><span> </span><span id="POST"><span class="annot"><a href="Network.HTTP.Req.html#POST"><span class="hs-identifier hs-var">POST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="POST"><span class="annot"><a href="Network.HTTP.Req.html#POST"><span class="hs-identifier hs-var">POST</span></a></span></span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#POST"><span class="hs-identifier hs-type">POST</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#POST"><span class="hs-identifier hs-type">POST</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span>
</span><span id="line-757"></span><span>  </span><span id="local-6989586621679213722"><span class="annot"><span class="annottext">httpMethodName :: Proxy POST -&gt; ByteString
</span><a href="#local-6989586621679213722"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodPost</span></span><span>
</span><span id="line-758"></span><span>
</span><span id="line-759"></span><span class="hs-comment">-- | 'HEAD' method.</span><span>
</span><span id="line-760"></span><span class="hs-keyword">data</span><span> </span><span id="HEAD"><span class="annot"><a href="Network.HTTP.Req.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HEAD"><span class="annot"><a href="Network.HTTP.Req.html#HEAD"><span class="hs-identifier hs-var">HEAD</span></a></span></span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HEAD"><span class="hs-identifier hs-type">HEAD</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-763"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HEAD"><span class="hs-identifier hs-type">HEAD</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span>
</span><span id="line-764"></span><span>  </span><span id="local-6989586621679213718"><span class="annot"><span class="annottext">httpMethodName :: Proxy HEAD -&gt; ByteString
</span><a href="#local-6989586621679213718"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodHead</span></span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-comment">-- | 'PUT' method.</span><span>
</span><span id="line-767"></span><span class="hs-keyword">data</span><span> </span><span id="PUT"><span class="annot"><a href="Network.HTTP.Req.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PUT"><span class="annot"><a href="Network.HTTP.Req.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span></span><span>
</span><span id="line-768"></span><span>
</span><span id="line-769"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#PUT"><span class="hs-identifier hs-type">PUT</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#PUT"><span class="hs-identifier hs-type">PUT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span>
</span><span id="line-771"></span><span>  </span><span id="local-6989586621679213714"><span class="annot"><span class="annottext">httpMethodName :: Proxy PUT -&gt; ByteString
</span><a href="#local-6989586621679213714"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodPut</span></span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="hs-comment">-- | 'DELETE' method. This data type does not allow having request body with</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- 'DELETE' requests, as it should be. However some APIs may expect 'DELETE'</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- requests to have bodies, in that case define your own variation of</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- 'DELETE' method and allow it to have a body.</span><span>
</span><span id="line-777"></span><span class="hs-keyword">data</span><span> </span><span id="DELETE"><span class="annot"><a href="Network.HTTP.Req.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DELETE"><span class="annot"><a href="Network.HTTP.Req.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span></span><span>
</span><span id="line-778"></span><span>
</span><span id="line-779"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#DELETE"><span class="hs-identifier hs-type">DELETE</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#DELETE"><span class="hs-identifier hs-type">DELETE</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span>
</span><span id="line-781"></span><span>  </span><span id="local-6989586621679213710"><span class="annot"><span class="annottext">httpMethodName :: Proxy DELETE -&gt; ByteString
</span><a href="#local-6989586621679213710"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodDelete</span></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">-- | 'TRACE' method.</span><span>
</span><span id="line-784"></span><span class="hs-keyword">data</span><span> </span><span id="TRACE"><span class="annot"><a href="Network.HTTP.Req.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TRACE"><span class="annot"><a href="Network.HTTP.Req.html#TRACE"><span class="hs-identifier hs-var">TRACE</span></a></span></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#TRACE"><span class="hs-identifier hs-type">TRACE</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#TRACE"><span class="hs-identifier hs-type">TRACE</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span>
</span><span id="line-788"></span><span>  </span><span id="local-6989586621679213706"><span class="annot"><span class="annottext">httpMethodName :: Proxy TRACE -&gt; ByteString
</span><a href="#local-6989586621679213706"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodTrace</span></span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span class="hs-comment">-- | 'CONNECT' method.</span><span>
</span><span id="line-791"></span><span class="hs-keyword">data</span><span> </span><span id="CONNECT"><span class="annot"><a href="Network.HTTP.Req.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CONNECT"><span class="annot"><a href="Network.HTTP.Req.html#CONNECT"><span class="hs-identifier hs-var">CONNECT</span></a></span></span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#CONNECT"><span class="hs-identifier hs-type">CONNECT</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-794"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#CONNECT"><span class="hs-identifier hs-type">CONNECT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span>
</span><span id="line-795"></span><span>  </span><span id="local-6989586621679213702"><span class="annot"><span class="annottext">httpMethodName :: Proxy CONNECT -&gt; ByteString
</span><a href="#local-6989586621679213702"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodConnect</span></span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span class="hs-comment">-- | 'OPTIONS' method.</span><span>
</span><span id="line-798"></span><span class="hs-keyword">data</span><span> </span><span id="OPTIONS"><span class="annot"><a href="Network.HTTP.Req.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OPTIONS"><span class="annot"><a href="Network.HTTP.Req.html#OPTIONS"><span class="hs-identifier hs-var">OPTIONS</span></a></span></span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#OPTIONS"><span class="hs-identifier hs-type">OPTIONS</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-801"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#OPTIONS"><span class="hs-identifier hs-type">OPTIONS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span>
</span><span id="line-802"></span><span>  </span><span id="local-6989586621679213698"><span class="annot"><span class="annottext">httpMethodName :: Proxy OPTIONS -&gt; ByteString
</span><a href="#local-6989586621679213698"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodOptions</span></span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span class="hs-comment">-- | 'PATCH' method.</span><span>
</span><span id="line-805"></span><span class="hs-keyword">data</span><span> </span><span id="PATCH"><span class="annot"><a href="Network.HTTP.Req.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PATCH"><span class="annot"><a href="Network.HTTP.Req.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#PATCH"><span class="hs-identifier hs-type">PATCH</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-808"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#PATCH"><span class="hs-identifier hs-type">PATCH</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span>
</span><span id="line-809"></span><span>  </span><span id="local-6989586621679213694"><span class="annot"><span class="annottext">httpMethodName :: Proxy PATCH -&gt; ByteString
</span><a href="#local-6989586621679213694"><span class="hs-identifier hs-var hs-var hs-var hs-var">httpMethodName</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Y.methodPatch</span></span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-comment">-- | A type class for types that can be used as an HTTP method. To define a</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- non-standard method, follow this example that defines @COPY@:</span><span>
</span><span id="line-813"></span><span class="hs-comment">--</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- &gt; data COPY = COPY</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- &gt; instance HttpMethod COPY where</span><span>
</span><span id="line-817"></span><span class="hs-comment">-- &gt;   type AllowsBody COPY = 'CanHaveBody</span><span>
</span><span id="line-818"></span><span class="hs-comment">-- &gt;   httpMethodName Proxy = &quot;COPY&quot;</span><span>
</span><span id="line-819"></span><span class="hs-keyword">class</span><span> </span><span id="HttpMethod"><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-var">HttpMethod</span></a></span></span><span> </span><span id="local-6989586621679214243"><span class="annot"><a href="#local-6989586621679214243"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-820"></span><span>  </span><span class="hs-comment">-- | Type function 'AllowsBody' returns a type of kind 'CanHaveBody' which</span><span>
</span><span id="line-821"></span><span>  </span><span class="hs-comment">-- tells the rest of the library whether the method can have body or not.</span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-comment">-- We use the special type 'CanHaveBody' lifted to the kind level instead</span><span>
</span><span id="line-823"></span><span>  </span><span class="hs-comment">-- of 'Bool' to get more user-friendly compiler messages.</span><span>
</span><span id="line-824"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AllowsBody"><span class="annot"><a href="Network.HTTP.Req.html#AllowsBody"><span class="hs-identifier hs-var">AllowsBody</span></a></span></span><span> </span><span id="local-6989586621679214243"><span class="annot"><a href="#local-6989586621679214243"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-comment">-- | Return name of the method as a 'ByteString'.</span><span>
</span><span id="line-827"></span><span>  </span><span id="httpMethodName"><span class="annot"><a href="Network.HTTP.Req.html#httpMethodName"><span class="hs-identifier hs-type">httpMethodName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679214243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span id="local-6989586621679213692"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpMethod"><span class="hs-identifier hs-type">HttpMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213692"><span class="hs-identifier hs-type">method</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#RequestComponent"><span class="hs-identifier hs-type">RequestComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-type">Womb</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;method&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679213692"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-830"></span><span>  </span><span id="local-6989586621679213690"><span class="annot"><span class="annottext">getRequestMod :: Womb &quot;method&quot; method -&gt; Endo Request
</span><a href="#local-6989586621679213690"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestMod</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Endo Request
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Endo Request)
-&gt; (Request -&gt; Request) -&gt; Endo Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213689"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213689"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213689"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">method :: ByteString
</span><a href="#local-6989586621679213688"><span class="hs-identifier hs-var">L.method</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy method -&gt; ByteString
forall a. HttpMethod a =&gt; Proxy a -&gt; ByteString
</span><a href="Network.HTTP.Req.html#httpMethodName"><span class="hs-identifier hs-var">httpMethodName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy method
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679213692"><span class="hs-identifier hs-type">method</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span></span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- Request&#8212;URL</span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="hs-comment">-- $url</span><span>
</span><span id="line-837"></span><span class="hs-comment">--</span><span>
</span><span id="line-838"></span><span class="hs-comment">-- We use 'Url's which are correct by construction, see 'Url'. To build a</span><span>
</span><span id="line-839"></span><span class="hs-comment">-- 'Url' from a 'URI', use 'useHttpURI', 'useHttpsURI', or generic 'useURI'.</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span class="hs-comment">-- | Request's 'Url'. Start constructing your 'Url' with 'http' or 'https'</span><span>
</span><span id="line-842"></span><span class="hs-comment">-- specifying the scheme and host at the same time. Then use the @('/~')@</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- and @('/:')@ operators to grow the path one piece at a time. Every single</span><span>
</span><span id="line-844"></span><span class="hs-comment">-- piece of path will be url(percent)-encoded, so using @('/~')@ and</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- @('/:')@ is the only way to have forward slashes between path segments.</span><span>
</span><span id="line-846"></span><span class="hs-comment">-- This approach makes working with dynamic path segments easy and safe. See</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- examples below how to represent various 'Url's (make sure the</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- @OverloadedStrings@ language extension is enabled).</span><span>
</span><span id="line-849"></span><span class="hs-comment">--</span><span>
</span><span id="line-850"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-851"></span><span class="hs-comment">--</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- &gt; http &quot;httpbin.org&quot;</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- &gt; -- http://httpbin.org</span><span>
</span><span id="line-854"></span><span class="hs-comment">--</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- &gt; https &quot;httpbin.org&quot;</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- &gt; -- https://httpbin.org</span><span>
</span><span id="line-857"></span><span class="hs-comment">--</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- &gt; https &quot;httpbin.org&quot; /: &quot;encoding&quot; /: &quot;utf8&quot;</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- &gt; -- https://httpbin.org/encoding/utf8</span><span>
</span><span id="line-860"></span><span class="hs-comment">--</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- &gt; https &quot;httpbin.org&quot; /: &quot;foo&quot; /: &quot;bar/baz&quot;</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- &gt; -- https://httpbin.org/foo/bar%2Fbaz</span><span>
</span><span id="line-863"></span><span class="hs-comment">--</span><span>
</span><span id="line-864"></span><span class="hs-comment">-- &gt; https &quot;httpbin.org&quot; /: &quot;bytes&quot; /~ (10 :: Int)</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- &gt; -- https://httpbin.org/bytes/10</span><span>
</span><span id="line-866"></span><span class="hs-comment">--</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- &gt; https &quot;&#1102;&#1085;&#1080;&#1082;&#1086;&#1076;.&#1088;&#1092;&quot;</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- &gt; -- https://%D1%8E%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4.%D1%80%D1%84</span><span>
</span><span id="line-869"></span><span id="local-6989586621679213686"><span id="local-6989586621679213687"></span></span><span class="hs-keyword">data</span><span> </span><span id="Url"><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-var">Url</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679214155"><span class="annot"><a href="#local-6989586621679214155"><span class="hs-identifier hs-type">scheme</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Scheme"><span class="hs-identifier hs-type">Scheme</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Url"><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-var">Url</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Scheme"><span class="hs-identifier hs-type">Scheme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-comment">-- NOTE The second value is the path segments in reversed order.</span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213681"><span id="local-6989586621679213683"><span class="annot"><span class="annottext">Url scheme -&gt; Url scheme -&gt; Bool
(Url scheme -&gt; Url scheme -&gt; Bool)
-&gt; (Url scheme -&gt; Url scheme -&gt; Bool) -&gt; Eq (Url scheme)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
/= :: Url scheme -&gt; Url scheme -&gt; Bool
$c/= :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
== :: Url scheme -&gt; Url scheme -&gt; Bool
$c== :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213665"><span id="local-6989586621679213667"><span id="local-6989586621679213669"><span id="local-6989586621679213671"><span id="local-6989586621679213673"><span id="local-6989586621679213675"><span id="local-6989586621679213677"><span class="annot"><span class="annottext">Eq (Url scheme)
Eq (Url scheme) =&gt;
(Url scheme -&gt; Url scheme -&gt; Ordering)
-&gt; (Url scheme -&gt; Url scheme -&gt; Bool)
-&gt; (Url scheme -&gt; Url scheme -&gt; Bool)
-&gt; (Url scheme -&gt; Url scheme -&gt; Bool)
-&gt; (Url scheme -&gt; Url scheme -&gt; Bool)
-&gt; (Url scheme -&gt; Url scheme -&gt; Url scheme)
-&gt; (Url scheme -&gt; Url scheme -&gt; Url scheme)
-&gt; Ord (Url scheme)
Url scheme -&gt; Url scheme -&gt; Bool
Url scheme -&gt; Url scheme -&gt; Ordering
Url scheme -&gt; Url scheme -&gt; Url scheme
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall (scheme :: Scheme). Eq (Url scheme)
forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Ordering
forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Url scheme
min :: Url scheme -&gt; Url scheme -&gt; Url scheme
$cmin :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Url scheme
max :: Url scheme -&gt; Url scheme -&gt; Url scheme
$cmax :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Url scheme
&gt;= :: Url scheme -&gt; Url scheme -&gt; Bool
$c&gt;= :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
&gt; :: Url scheme -&gt; Url scheme -&gt; Bool
$c&gt; :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
&lt;= :: Url scheme -&gt; Url scheme -&gt; Bool
$c&lt;= :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
&lt; :: Url scheme -&gt; Url scheme -&gt; Bool
$c&lt; :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Bool
compare :: Url scheme -&gt; Url scheme -&gt; Ordering
$ccompare :: forall (scheme :: Scheme). Url scheme -&gt; Url scheme -&gt; Ordering
$cp1Ord :: forall (scheme :: Scheme). Eq (Url scheme)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213658"><span id="local-6989586621679213660"><span id="local-6989586621679213662"><span class="annot"><span class="annottext">Int -&gt; Url scheme -&gt; ShowS
[Url scheme] -&gt; ShowS
Url scheme -&gt; String
(Int -&gt; Url scheme -&gt; ShowS)
-&gt; (Url scheme -&gt; String)
-&gt; ([Url scheme] -&gt; ShowS)
-&gt; Show (Url scheme)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (scheme :: Scheme). Int -&gt; Url scheme -&gt; ShowS
forall (scheme :: Scheme). [Url scheme] -&gt; ShowS
forall (scheme :: Scheme). Url scheme -&gt; String
showList :: [Url scheme] -&gt; ShowS
$cshowList :: forall (scheme :: Scheme). [Url scheme] -&gt; ShowS
show :: Url scheme -&gt; String
$cshow :: forall (scheme :: Scheme). Url scheme -&gt; String
showsPrec :: Int -&gt; Url scheme -&gt; ShowS
$cshowsPrec :: forall (scheme :: Scheme). Int -&gt; Url scheme -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="%24cUrl"><span id="%24tUrl"><span id="local-6989586621679213628"><span id="local-6989586621679213630"><span id="local-6989586621679213632"><span id="local-6989586621679213634"><span id="local-6989586621679213636"><span id="local-6989586621679213638"><span id="local-6989586621679213640"><span id="local-6989586621679213642"><span id="local-6989586621679213644"><span id="local-6989586621679213646"><span id="local-6989586621679213648"><span id="local-6989586621679213650"><span id="local-6989586621679213652"><span id="local-6989586621679213654"><span class="annot"><span class="annottext">Typeable (Url scheme)
DataType
Constr
Typeable (Url scheme) =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; Url scheme -&gt; c (Url scheme))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Url scheme))
-&gt; (Url scheme -&gt; Constr)
-&gt; (Url scheme -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Url scheme)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c (Url scheme)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Url scheme -&gt; Url scheme)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme))
-&gt; Data (Url scheme)
Url scheme -&gt; DataType
Url scheme -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Url scheme -&gt; Url scheme
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Url scheme -&gt; c (Url scheme)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Url scheme)
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
forall (scheme :: Scheme). Typeable scheme =&gt; Typeable (Url scheme)
forall (scheme :: Scheme).
Typeable scheme =&gt;
Url scheme -&gt; DataType
forall (scheme :: Scheme). Typeable scheme =&gt; Url scheme -&gt; Constr
forall (scheme :: Scheme).
Typeable scheme =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Url scheme -&gt; Url scheme
forall (scheme :: Scheme) u.
Typeable scheme =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; u
forall (scheme :: Scheme) u.
Typeable scheme =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; [u]
forall (scheme :: Scheme) r r'.
Typeable scheme =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
forall (scheme :: Scheme) r r'.
Typeable scheme =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
forall (scheme :: Scheme) (m :: * -&gt; *).
(Typeable scheme, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
forall (scheme :: Scheme) (m :: * -&gt; *).
(Typeable scheme, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
forall (scheme :: Scheme) (c :: * -&gt; *).
Typeable scheme =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Url scheme)
forall (scheme :: Scheme) (c :: * -&gt; *).
Typeable scheme =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Url scheme -&gt; c (Url scheme)
forall (scheme :: Scheme) (t :: * -&gt; *) (c :: * -&gt; *).
(Typeable scheme, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Url scheme))
forall (scheme :: Scheme) (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Typeable scheme, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Url scheme))
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Url scheme)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Url scheme -&gt; c (Url scheme)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Url scheme))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Url scheme))
$cUrl :: Constr
$tUrl :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
$cgmapMo :: forall (scheme :: Scheme) (m :: * -&gt; *).
(Typeable scheme, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
$cgmapMp :: forall (scheme :: Scheme) (m :: * -&gt; *).
(Typeable scheme, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
$cgmapM :: forall (scheme :: Scheme) (m :: * -&gt; *).
(Typeable scheme, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Url scheme -&gt; m (Url scheme)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; u
$cgmapQi :: forall (scheme :: Scheme) u.
Typeable scheme =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; [u]
$cgmapQ :: forall (scheme :: Scheme) u.
Typeable scheme =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Url scheme -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
$cgmapQr :: forall (scheme :: Scheme) r r'.
Typeable scheme =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
$cgmapQl :: forall (scheme :: Scheme) r r'.
Typeable scheme =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Url scheme -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Url scheme -&gt; Url scheme
$cgmapT :: forall (scheme :: Scheme).
Typeable scheme =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Url scheme -&gt; Url scheme
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Url scheme))
$cdataCast2 :: forall (scheme :: Scheme) (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Typeable scheme, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Url scheme))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Url scheme))
$cdataCast1 :: forall (scheme :: Scheme) (t :: * -&gt; *) (c :: * -&gt; *).
(Typeable scheme, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Url scheme))
dataTypeOf :: Url scheme -&gt; DataType
$cdataTypeOf :: forall (scheme :: Scheme).
Typeable scheme =&gt;
Url scheme -&gt; DataType
toConstr :: Url scheme -&gt; Constr
$ctoConstr :: forall (scheme :: Scheme). Typeable scheme =&gt; Url scheme -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Url scheme)
$cgunfold :: forall (scheme :: Scheme) (c :: * -&gt; *).
Typeable scheme =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Url scheme)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Url scheme -&gt; c (Url scheme)
$cgfoldl :: forall (scheme :: Scheme) (c :: * -&gt; *).
Typeable scheme =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Url scheme -&gt; c (Url scheme)
$cp1Data :: forall (scheme :: Scheme). Typeable scheme =&gt; Typeable (Url scheme)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Url scheme -&gt; Rep (Url scheme) x)
-&gt; (forall x. Rep (Url scheme) x -&gt; Url scheme)
-&gt; Generic (Url scheme)
forall x. Rep (Url scheme) x -&gt; Url scheme
forall x. Url scheme -&gt; Rep (Url scheme) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (scheme :: Scheme) x. Rep (Url scheme) x -&gt; Url scheme
forall (scheme :: Scheme) x. Url scheme -&gt; Rep (Url scheme) x
$cto :: forall (scheme :: Scheme) x. Rep (Url scheme) x -&gt; Url scheme
$cfrom :: forall (scheme :: Scheme) x. Url scheme -&gt; Rep (Url scheme) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span class="hs-comment">-- With template-haskell &gt;=2.15 and text &gt;=1.2.4 Lift can be derived, however</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- the derived lift forgets the type of scheme.</span><span>
</span><span id="line-877"></span><span id="local-6989586621679213621"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679213621"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213621"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-878"></span><span>  </span><span id="local-6989586621679213618"><span class="annot"><span class="annottext">lift :: Url scheme -&gt; Q Exp
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">lift</span></span></span><span> </span><span id="local-6989586621679213617"><span class="annot"><span class="annottext">url :: Url scheme
</span><a href="#local-6989586621679213617"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-879"></span><span>    </span><span class="annot"><span class="annottext">(forall b. Data b =&gt; b -&gt; Maybe (Q Exp)) -&gt; Url scheme -&gt; Q Exp
forall a.
Data a =&gt;
(forall b. Data b =&gt; b -&gt; Maybe (Q Exp)) -&gt; a -&gt; Q Exp
</span><span class="hs-identifier hs-var">TH.dataToExpQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Q Exp) -&gt; Maybe Text -&gt; Maybe (Q Exp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Q Exp
</span><a href="#local-6989586621679213615"><span class="hs-identifier hs-var">liftText</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe (Q Exp))
-&gt; (b -&gt; Maybe Text) -&gt; b -&gt; Maybe (Q Exp)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe Text
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Url scheme
</span><a href="#local-6989586621679213617"><span class="hs-identifier hs-var">url</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; TypeQ -&gt; Q Exp
</span><span class="hs-operator hs-var">`TH.sigE`</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Url scheme
</span><a href="#local-6989586621679213617"><span class="hs-identifier hs-var">url</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-880"></span><span>      </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-type">Http</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-identifier">Url</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Http</span><span class="hs-special">|]</span><span>
</span><span id="line-881"></span><span>      </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-identifier">Url</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Https</span><span class="hs-special">|]</span><span>
</span><span id="line-882"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-883"></span><span>      </span><span id="local-6989586621679213615"><span class="annot"><span class="annottext">liftText :: Text -&gt; Q Exp
</span><a href="#local-6989586621679213615"><span class="hs-identifier hs-var hs-var">liftText</span></a></span></span><span> </span><span id="local-6989586621679213614"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679213614"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">TH.AppE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">TH.VarE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">T.pack</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; Q Exp -&gt; Q Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall t. Lift t =&gt; t -&gt; Q Exp
</span><span class="hs-identifier hs-var">TH.lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679213614"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span></span><span class="hs-cpp">

#if MIN_VERSION_template_haskell(2,16,0)
</span><span>  </span><span class="hs-identifier">liftTyped</span><span> </span><span class="hs-identifier">url</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">TH.TExp</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">TH.lift</span><span> </span><span class="hs-identifier">url</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- | Given host name, produce a 'Url' which has &#8220;http&#8221; as its scheme and</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- empty path. This also sets port to @80@.</span><span>
</span><span id="line-891"></span><span class="annot"><a href="Network.HTTP.Req.html#http"><span class="hs-identifier hs-type">http</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-type">Http</span></a></span><span>
</span><span id="line-892"></span><span id="http"><span class="annot"><span class="annottext">http :: Text -&gt; Url 'Http
</span><a href="Network.HTTP.Req.html#http"><span class="hs-identifier hs-var hs-var">http</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scheme -&gt; NonEmpty Text -&gt; Url 'Http
forall (scheme :: Scheme). Scheme -&gt; NonEmpty Text -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-var">Url</span></a></span><span> </span><span class="annot"><span class="annottext">Scheme
</span><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-var">Http</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Text -&gt; Url 'Http)
-&gt; (Text -&gt; NonEmpty Text) -&gt; Text -&gt; Url 'Http
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NonEmpty Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="hs-comment">-- | Given host name, produce a 'Url' which has &#8220;https&#8221; as its scheme and</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- empty path. This also sets port to @443@.</span><span>
</span><span id="line-896"></span><span class="annot"><a href="Network.HTTP.Req.html#https"><span class="hs-identifier hs-type">https</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span>
</span><span id="line-897"></span><span id="https"><span class="annot"><span class="annottext">https :: Text -&gt; Url 'Https
</span><a href="Network.HTTP.Req.html#https"><span class="hs-identifier hs-var hs-var">https</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scheme -&gt; NonEmpty Text -&gt; Url 'Https
forall (scheme :: Scheme). Scheme -&gt; NonEmpty Text -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-var">Url</span></a></span><span> </span><span class="annot"><span class="annottext">Scheme
</span><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-var">Https</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Text -&gt; Url 'Https)
-&gt; (Text -&gt; NonEmpty Text) -&gt; Text -&gt; Url 'Https
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NonEmpty Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- | Grow given 'Url' appending a single path segment to it. Note that the</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- path segment can be of any type that is an instance of 'ToHttpApiData'.</span><span>
</span><span id="line-901"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#%2F~"><span class="hs-operator hs-type">/~</span></a></span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span id="local-6989586621679214146"><span id="local-6989586621679214147"><span class="annot"><a href="Network.HTTP.Req.html#%2F~"><span class="hs-operator hs-type">(/~)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToHttpApiData</span></span><span> </span><span class="annot"><a href="#local-6989586621679214147"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214146"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214147"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214146"><span class="hs-identifier hs-type">scheme</span></a></span></span></span><span>
</span><span id="line-904"></span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span id="local-6989586621679213609"><span class="annot"><span class="annottext">secure :: Scheme
</span><a href="#local-6989586621679213609"><span class="hs-identifier hs-var">secure</span></a></span></span><span> </span><span id="local-6989586621679213608"><span class="annot"><span class="annottext">path :: NonEmpty Text
</span><a href="#local-6989586621679213608"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="%2F~"><span class="annot"><span class="annottext">/~ :: Url scheme -&gt; a -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#%2F~"><span class="hs-operator hs-var hs-var">/~</span></a></span></span><span> </span><span id="local-6989586621679213607"><span class="annot"><span class="annottext">segment :: a
</span><a href="#local-6989586621679213607"><span class="hs-identifier hs-var">segment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scheme -&gt; NonEmpty Text -&gt; Url scheme
forall (scheme :: Scheme). Scheme -&gt; NonEmpty Text -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-var">Url</span></a></span><span> </span><span class="annot"><span class="annottext">Scheme
</span><a href="#local-6989586621679213609"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NonEmpty Text -&gt; NonEmpty Text
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NE.cons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToHttpApiData a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toUrlPiece</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679213607"><span class="hs-identifier hs-var">segment</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty Text
</span><a href="#local-6989586621679213608"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span>
</span><span id="line-906"></span><span class="hs-comment">-- | Type-constrained version of @('/~')@ to remove ambiguity in the cases</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- when next URL piece is a 'Data.Text.Text' literal.</span><span>
</span><span id="line-908"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#%2F%3A"><span class="hs-operator hs-type">/:</span></a></span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span id="local-6989586621679214134"><span class="annot"><a href="Network.HTTP.Req.html#%2F%3A"><span class="hs-operator hs-type">(/:)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214134"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214134"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-911"></span><span id="%2F%3A"><span class="annot"><span class="annottext">/: :: Url scheme -&gt; Text -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#%2F%3A"><span class="hs-operator hs-var hs-var">(/:)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Url scheme -&gt; Text -&gt; Url scheme
forall a (scheme :: Scheme).
ToHttpApiData a =&gt;
Url scheme -&gt; a -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#%2F~"><span class="hs-operator hs-var">(/~)</span></a></span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span class="hs-comment">-- | The 'useHttpURI' function provides an alternative method to get 'Url'</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- (possibly with some 'Option's) from a 'URI'. This is useful when you are</span><span>
</span><span id="line-915"></span><span class="hs-comment">-- given a URL to query dynamically and don't know it beforehand.</span><span>
</span><span id="line-916"></span><span class="hs-comment">--</span><span>
</span><span id="line-917"></span><span class="hs-comment">-- This function expects the scheme to be &#8220;http&#8221; and host to be present.</span><span>
</span><span id="line-918"></span><span class="hs-comment">--</span><span>
</span><span id="line-919"></span><span class="hs-comment">-- @since 3.0.0</span><span>
</span><span id="line-920"></span><span id="local-6989586621679214125"><span class="annot"><a href="Network.HTTP.Req.html#useHttpURI"><span class="hs-identifier hs-type">useHttpURI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-type">Http</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214125"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-921"></span><span id="useHttpURI"><span class="annot"><span class="annottext">useHttpURI :: URI -&gt; Maybe (Url 'Http, Option scheme)
</span><a href="Network.HTTP.Req.html#useHttpURI"><span class="hs-identifier hs-var hs-var">useHttpURI</span></a></span></span><span> </span><span id="local-6989586621679213604"><span class="annot"><span class="annottext">uri :: URI
</span><a href="#local-6989586621679213604"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-922"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">URI -&gt; Maybe (RText 'Scheme)
</span><span class="hs-identifier hs-var hs-var">URI.uriScheme</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213604"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (RText 'Scheme) -&gt; Maybe (RText 'Scheme) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RText 'Scheme -&gt; Maybe (RText 'Scheme)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="">[QQ.scheme|http|]</span></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>  </span><span id="local-6989586621679213600"><span class="annot"><span class="annottext">Url 'Http
</span><a href="#local-6989586621679213600"><span class="hs-identifier hs-var">urlHead</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Url 'Http
</span><a href="Network.HTTP.Req.html#http"><span class="hs-identifier hs-var">http</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Url 'Http) -&gt; Maybe Text -&gt; Maybe (Url 'Http)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; Maybe Text
</span><a href="Network.HTTP.Req.html#uriHost"><span class="hs-identifier hs-var">uriHost</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213604"><span class="hs-identifier hs-var">uri</span></a></span><span>
</span><span id="line-924"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213598"><span class="annot"><span class="annottext">url :: Url 'Http
</span><a href="#local-6989586621679213598"><span class="hs-identifier hs-var hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Maybe (Bool, NonEmpty (RText 'PathPiece))
</span><span class="hs-identifier hs-var hs-var">URI.uriPath</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213604"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-925"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Url 'Http
</span><a href="#local-6989586621679213600"><span class="hs-identifier hs-var">urlHead</span></a></span><span>
</span><span id="line-926"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213596"><span class="annot"><span class="annottext">xs :: NonEmpty (RText 'PathPiece)
</span><a href="#local-6989586621679213596"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-927"></span><span>          </span><span class="annot"><span class="annottext">(Url 'Http -&gt; Text -&gt; Url 'Http)
-&gt; Url 'Http -&gt; [Text] -&gt; Url 'Http
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Url 'Http -&gt; Text -&gt; Url 'Http
forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#%2F%3A"><span class="hs-operator hs-var">(/:)</span></a></span><span> </span><span class="annot"><span class="annottext">Url 'Http
</span><a href="#local-6989586621679213600"><span class="hs-identifier hs-var">urlHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RText 'PathPiece -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span> </span><span class="annot"><span class="annottext">(RText 'PathPiece -&gt; Text) -&gt; [RText 'PathPiece] -&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (RText 'PathPiece) -&gt; [RText 'PathPiece]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NE.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (RText 'PathPiece)
</span><a href="#local-6989586621679213596"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>  </span><span class="annot"><span class="annottext">(Url 'Http, Option scheme) -&gt; Maybe (Url 'Http, Option scheme)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Url 'Http
</span><a href="#local-6989586621679213598"><span class="hs-identifier hs-var">url</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Option scheme
forall (scheme :: Scheme). URI -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#uriOptions"><span class="hs-identifier hs-var">uriOptions</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213604"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-929"></span><span>
</span><span id="line-930"></span><span class="hs-comment">-- | Just like 'useHttpURI', but expects the &#8220;https&#8221; scheme.</span><span>
</span><span id="line-931"></span><span class="hs-comment">--</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- @since 3.0.0</span><span>
</span><span id="line-933"></span><span id="local-6989586621679214122"><span class="annot"><a href="Network.HTTP.Req.html#useHttpsURI"><span class="hs-identifier hs-type">useHttpsURI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214122"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-934"></span><span id="useHttpsURI"><span class="annot"><span class="annottext">useHttpsURI :: URI -&gt; Maybe (Url 'Https, Option scheme)
</span><a href="Network.HTTP.Req.html#useHttpsURI"><span class="hs-identifier hs-var hs-var">useHttpsURI</span></a></span></span><span> </span><span id="local-6989586621679213592"><span class="annot"><span class="annottext">uri :: URI
</span><a href="#local-6989586621679213592"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-935"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">URI -&gt; Maybe (RText 'Scheme)
</span><span class="hs-identifier hs-var hs-var">URI.uriScheme</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213592"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (RText 'Scheme) -&gt; Maybe (RText 'Scheme) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RText 'Scheme -&gt; Maybe (RText 'Scheme)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="">[QQ.scheme|https|]</span></span><span class="hs-special">)</span><span>
</span><span id="line-936"></span><span>  </span><span id="local-6989586621679213591"><span class="annot"><span class="annottext">Url 'Https
</span><a href="#local-6989586621679213591"><span class="hs-identifier hs-var">urlHead</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Url 'Https
</span><a href="Network.HTTP.Req.html#https"><span class="hs-identifier hs-var">https</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Url 'Https) -&gt; Maybe Text -&gt; Maybe (Url 'Https)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; Maybe Text
</span><a href="Network.HTTP.Req.html#uriHost"><span class="hs-identifier hs-var">uriHost</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213592"><span class="hs-identifier hs-var">uri</span></a></span><span>
</span><span id="line-937"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213590"><span class="annot"><span class="annottext">url :: Url 'Https
</span><a href="#local-6989586621679213590"><span class="hs-identifier hs-var hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Maybe (Bool, NonEmpty (RText 'PathPiece))
</span><span class="hs-identifier hs-var hs-var">URI.uriPath</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213592"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-938"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Url 'Https
</span><a href="#local-6989586621679213591"><span class="hs-identifier hs-var">urlHead</span></a></span><span>
</span><span id="line-939"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213589"><span class="annot"><span class="annottext">xs :: NonEmpty (RText 'PathPiece)
</span><a href="#local-6989586621679213589"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-940"></span><span>          </span><span class="annot"><span class="annottext">(Url 'Https -&gt; Text -&gt; Url 'Https)
-&gt; Url 'Https -&gt; [Text] -&gt; Url 'Https
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Url 'Https -&gt; Text -&gt; Url 'Https
forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><a href="Network.HTTP.Req.html#%2F%3A"><span class="hs-operator hs-var">(/:)</span></a></span><span> </span><span class="annot"><span class="annottext">Url 'Https
</span><a href="#local-6989586621679213591"><span class="hs-identifier hs-var">urlHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RText 'PathPiece -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span> </span><span class="annot"><span class="annottext">(RText 'PathPiece -&gt; Text) -&gt; [RText 'PathPiece] -&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (RText 'PathPiece) -&gt; [RText 'PathPiece]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NE.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (RText 'PathPiece)
</span><a href="#local-6989586621679213589"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-941"></span><span>  </span><span class="annot"><span class="annottext">(Url 'Https, Option scheme) -&gt; Maybe (Url 'Https, Option scheme)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Url 'Https
</span><a href="#local-6989586621679213590"><span class="hs-identifier hs-var">url</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Option scheme
forall (scheme :: Scheme). URI -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#uriOptions"><span class="hs-identifier hs-var">uriOptions</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213592"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span class="hs-comment">-- | A combination of 'useHttpURI' and 'useHttpsURI' for cases when scheme</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- is not known in advance.</span><span>
</span><span id="line-945"></span><span class="hs-comment">--</span><span>
</span><span id="line-946"></span><span class="hs-comment">-- @since 3.0.0</span><span>
</span><span id="line-947"></span><span id="local-6989586621679214110"><span id="local-6989586621679214111"><span class="annot"><a href="Network.HTTP.Req.html#useURI"><span class="hs-identifier hs-type">useURI</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-948"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-949"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span>
</span><span id="line-950"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span>
</span><span id="line-951"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-type">Http</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214111"><span class="hs-identifier hs-type">scheme0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214110"><span class="hs-identifier hs-type">scheme1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>    </span><span class="hs-special">)</span></span></span><span>
</span><span id="line-954"></span><span id="useURI"><span class="annot"><span class="annottext">useURI :: URI
-&gt; Maybe
     (Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
</span><a href="Network.HTTP.Req.html#useURI"><span class="hs-identifier hs-var hs-var">useURI</span></a></span></span><span> </span><span id="local-6989586621679213588"><span class="annot"><span class="annottext">uri :: URI
</span><a href="#local-6989586621679213588"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-955"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Url 'Http, Option scheme0)
-&gt; Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">((Url 'Http, Option scheme0)
 -&gt; Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
-&gt; Maybe (Url 'Http, Option scheme0)
-&gt; Maybe
     (Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; Maybe (Url 'Http, Option scheme0)
forall (scheme :: Scheme). URI -&gt; Maybe (Url 'Http, Option scheme)
</span><a href="Network.HTTP.Req.html#useHttpURI"><span class="hs-identifier hs-var">useHttpURI</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213588"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe
  (Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
-&gt; Maybe
     (Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
-&gt; Maybe
     (Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Url 'Https, Option scheme1)
-&gt; Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">((Url 'Https, Option scheme1)
 -&gt; Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
-&gt; Maybe (Url 'Https, Option scheme1)
-&gt; Maybe
     (Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; Maybe (Url 'Https, Option scheme1)
forall (scheme :: Scheme). URI -&gt; Maybe (Url 'Https, Option scheme)
</span><a href="Network.HTTP.Req.html#useHttpsURI"><span class="hs-identifier hs-var">useHttpsURI</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213588"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>
</span><span id="line-957"></span><span class="hs-comment">-- | An internal helper function to extract host from a 'URI'.</span><span>
</span><span id="line-958"></span><span class="annot"><a href="Network.HTTP.Req.html#uriHost"><span class="hs-identifier hs-type">uriHost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-959"></span><span id="uriHost"><span class="annot"><span class="annottext">uriHost :: URI -&gt; Maybe Text
</span><a href="Network.HTTP.Req.html#uriHost"><span class="hs-identifier hs-var hs-var">uriHost</span></a></span></span><span> </span><span id="local-6989586621679213586"><span class="annot"><span class="annottext">uri :: URI
</span><a href="#local-6989586621679213586"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Either Bool Authority
</span><span class="hs-identifier hs-var hs-var">URI.uriAuthority</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213586"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-960"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-961"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679213582"><span id="local-6989586621679213583"><span id="local-6989586621679213584"><span class="annot"><span class="hs-identifier hs-type">URI.Authority</span></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-962"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RText 'Host -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span> </span><span class="annot"><span class="annottext">RText 'Host
</span><a href="#local-6989586621679213583"><span class="hs-identifier hs-var">authHost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span class="hs-comment">-- | A quasiquoter to build an 'Url' and 'Option' tuple. The type of the</span><span>
</span><span id="line-965"></span><span class="hs-comment">-- generated expression is @('Url' scheme0, 'Option' scheme1)@ with</span><span>
</span><span id="line-966"></span><span class="hs-comment">-- @scheme0@ being either 'Http' or 'Https' depending on the input.</span><span>
</span><span id="line-967"></span><span class="hs-comment">--</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- @since 3.2.0</span><span>
</span><span id="line-969"></span><span class="annot"><a href="Network.HTTP.Req.html#urlQ"><span class="hs-identifier hs-type">urlQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.QuasiQuoter</span></span><span>
</span><span id="line-970"></span><span id="urlQ"><span class="annot"><span class="annottext">urlQ :: QuasiQuoter
</span><a href="Network.HTTP.Req.html#urlQ"><span class="hs-identifier hs-var hs-var">urlQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-971"></span><span>  </span><span class="annot"><span class="annottext">QuasiQuoter :: (String -&gt; Q Exp)
-&gt; (String -&gt; Q Pat)
-&gt; (String -&gt; TypeQ)
-&gt; (String -&gt; Q [Dec])
-&gt; QuasiQuoter
</span><span class="hs-identifier hs-type hs-type">TH.QuasiQuoter</span></span><span>
</span><span id="line-972"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">quoteExp :: String -&gt; Q Exp
</span><span class="hs-identifier hs-var">quoteExp</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213575"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679213575"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-973"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either SomeException URI
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m URI
</span><span class="hs-identifier hs-var">URI.mkURI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679213575"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-974"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679213573"><span class="annot"><span class="annottext">err :: SomeException
</span><a href="#local-6989586621679213573"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException -&gt; String
forall e. Exception e =&gt; e -&gt; String
</span><span class="hs-identifier hs-var">displayException</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679213573"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679213571"><span class="annot"><span class="annottext">uri :: URI
</span><a href="#local-6989586621679213571"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">URI
-&gt; Maybe (Either (Url 'Http, Option Any) (Url 'Https, Option Any))
forall (scheme0 :: Scheme) (scheme1 :: Scheme).
URI
-&gt; Maybe
     (Either (Url 'Http, Option scheme0) (Url 'Https, Option scheme1))
</span><a href="Network.HTTP.Req.html#useURI"><span class="hs-identifier hs-var">useURI</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213571"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-976"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Not a HTTP or HTTPS URL&quot;</span></span><span>
</span><span id="line-977"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679213570"><span class="annot"><span class="annottext">eurl :: Either (Url 'Http, Option Any) (Url 'Https, Option Any)
</span><a href="#local-6989586621679213570"><span class="hs-identifier hs-var">eurl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-978"></span><span>              </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
</span><span class="hs-identifier hs-var">TH.tupE</span></span><span>
</span><span id="line-979"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">((Url 'Http, Option Any) -&gt; Q Exp)
-&gt; ((Url 'Https, Option Any) -&gt; Q Exp)
-&gt; Either (Url 'Http, Option Any) (Url 'Https, Option Any)
-&gt; Q Exp
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Url 'Http -&gt; Q Exp
forall t. Lift t =&gt; t -&gt; Q Exp
</span><span class="hs-identifier hs-var">TH.lift</span></span><span> </span><span class="annot"><span class="annottext">(Url 'Http -&gt; Q Exp)
-&gt; ((Url 'Http, Option Any) -&gt; Url 'Http)
-&gt; (Url 'Http, Option Any)
-&gt; Q Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Url 'Http, Option Any) -&gt; Url 'Http
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Url 'Https -&gt; Q Exp
forall t. Lift t =&gt; t -&gt; Q Exp
</span><span class="hs-identifier hs-var">TH.lift</span></span><span> </span><span class="annot"><span class="annottext">(Url 'Https -&gt; Q Exp)
-&gt; ((Url 'Https, Option Any) -&gt; Url 'Https)
-&gt; (Url 'Https, Option Any)
-&gt; Q Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Url 'Https, Option Any) -&gt; Url 'Https
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either (Url 'Http, Option Any) (Url 'Https, Option Any)
</span><a href="#local-6989586621679213570"><span class="hs-identifier hs-var">eurl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-980"></span><span>                  </span><span class="hs-special">[|</span><span class="hs-identifier">uriOptions</span><span> </span><span class="hs-identifier">uri</span><span class="hs-special">|]</span><span>
</span><span id="line-981"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-982"></span><span>      </span><span class="annot"><span class="annottext">quotePat :: String -&gt; Q Pat
</span><span class="hs-identifier hs-var">quotePat</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Q Pat
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;This usage is not supported&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-983"></span><span>      </span><span class="annot"><span class="annottext">quoteType :: String -&gt; TypeQ
</span><span class="hs-identifier hs-var">quoteType</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; TypeQ
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;This usage is not supported&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-984"></span><span>      </span><span class="annot"><span class="annottext">quoteDec :: String -&gt; Q [Dec]
</span><span class="hs-identifier hs-var">quoteDec</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Q [Dec]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;This usage is not supported&quot;</span></span><span>
</span><span id="line-985"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span class="hs-comment">-- | An internal helper function to extract 'Option's from a 'URI'.</span><span>
</span><span id="line-988"></span><span class="annot"><a href="Network.HTTP.Req.html#uriOptions"><span class="hs-identifier hs-type">uriOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679214131"><span class="annot"><a href="#local-6989586621679214131"><span class="hs-identifier hs-type">scheme</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214131"><span class="hs-identifier hs-type">scheme</span></a></span><span>
</span><span id="line-989"></span><span id="uriOptions"><span class="annot"><span class="annottext">uriOptions :: URI -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#uriOptions"><span class="hs-identifier hs-var hs-var">uriOptions</span></a></span></span><span> </span><span id="local-6989586621679213568"><span class="annot"><span class="annottext">uri :: URI
</span><a href="#local-6989586621679213568"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-990"></span><span>  </span><span class="annot"><span class="annottext">[Option scheme] -&gt; Option scheme
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-991"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213567"><span class="hs-identifier hs-var">auth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-992"></span><span>      </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213566"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-993"></span><span>      </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213565"><span class="hs-identifier hs-var">port'</span></a></span><span>
</span><span id="line-994"></span><span>      </span><span class="hs-comment">-- , fragment'</span><span>
</span><span id="line-995"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-996"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-997"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679213567"><span class="annot"><span class="annottext">auth :: Option scheme
</span><a href="#local-6989586621679213567"><span class="hs-identifier hs-var">auth</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213565"><span class="annot"><span class="annottext">port' :: Option scheme
</span><a href="#local-6989586621679213565"><span class="hs-identifier hs-var">port'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-998"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Either Bool Authority
</span><span class="hs-identifier hs-var hs-var">URI.uriAuthority</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213568"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-999"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Option scheme
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Option scheme
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679213562"><span id="local-6989586621679213563"><span id="local-6989586621679213564"><span class="annot"><span class="hs-identifier hs-type">URI.Authority</span></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1001"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213561"><span class="annot"><span class="annottext">auth0 :: Option scheme
</span><a href="#local-6989586621679213561"><span class="hs-identifier hs-var hs-var">auth0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621679213564"><span class="hs-identifier hs-var">authUserInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1002"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Option scheme
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1003"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679213559"><span id="local-6989586621679213560"><span class="annot"><span class="hs-identifier hs-type">URI.UserInfo</span></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1004"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213555"><span class="annot"><span class="annottext">username :: ByteString
</span><a href="#local-6989586621679213555"><span class="hs-identifier hs-var hs-var">username</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RText 'Username -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span> </span><span class="annot"><span class="annottext">RText 'Username
</span><a href="#local-6989586621679213560"><span class="hs-identifier hs-var">uiUsername</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1005"></span><span>                      </span><span id="local-6989586621679213553"><span class="annot"><span class="annottext">password :: ByteString
</span><a href="#local-6989586621679213553"><span class="hs-identifier hs-var hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (RText 'Password -&gt; ByteString)
-&gt; Maybe (RText 'Password)
-&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString)
-&gt; (RText 'Password -&gt; Text) -&gt; RText 'Password -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RText 'Password -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (RText 'Password)
</span><a href="#local-6989586621679213559"><span class="hs-identifier hs-var">uiPassword</span></a></span><span>
</span><span id="line-1006"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Option scheme
forall (scheme :: Scheme).
ByteString -&gt; ByteString -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#basicAuthUnsafe"><span class="hs-identifier hs-var">basicAuthUnsafe</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213555"><span class="hs-identifier hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213553"><span class="hs-identifier hs-var">password</span></a></span><span>
</span><span id="line-1007"></span><span>              </span><span id="local-6989586621679213551"><span class="annot"><span class="annottext">port0 :: Option scheme
</span><a href="#local-6989586621679213551"><span class="hs-identifier hs-var hs-var">port0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Word
</span><a href="#local-6989586621679213562"><span class="hs-identifier hs-var">authPort</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1008"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Option scheme
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1009"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679213550"><span class="annot"><span class="annottext">port'' :: Word
</span><a href="#local-6989586621679213550"><span class="hs-identifier hs-var">port''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Option scheme
forall (scheme :: Scheme). Int -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#port"><span class="hs-identifier hs-var">port</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679213550"><span class="hs-identifier hs-var">port''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1010"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213561"><span class="hs-identifier hs-var">auth0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Option scheme
</span><a href="#local-6989586621679213551"><span class="hs-identifier hs-var">port0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1011"></span><span>    </span><span id="local-6989586621679213566"><span class="annot"><span class="annottext">query :: Option scheme
</span><a href="#local-6989586621679213566"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1012"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213549"><span class="annot"><span class="annottext">liftQueryParam :: QueryParam -&gt; Option scheme
</span><a href="#local-6989586621679213549"><span class="hs-identifier hs-var hs-var">liftQueryParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1013"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">URI.QueryFlag</span></span><span> </span><span id="local-6989586621679213547"><span class="annot"><span class="annottext">t :: RText 'QueryKey
</span><a href="#local-6989586621679213547"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Option scheme
forall param. QueryParam param =&gt; Text -&gt; param
</span><a href="Network.HTTP.Req.html#queryFlag"><span class="hs-identifier hs-var">queryFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679213547"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1014"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">URI.QueryParam</span></span><span> </span><span id="local-6989586621679213545"><span class="annot"><span class="annottext">k :: RText 'QueryKey
</span><a href="#local-6989586621679213545"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679213544"><span class="annot"><span class="annottext">v :: RText 'QueryValue
</span><a href="#local-6989586621679213544"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679213545"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Option scheme
forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><a href="Network.HTTP.Req.html#%3D%3A"><span class="hs-operator hs-var">=:</span></a></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue -&gt; Text
forall (l :: RTextLabel). RText l -&gt; Text
</span><span class="hs-identifier hs-var">URI.unRText</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679213544"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1015"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Option scheme] -&gt; Option scheme
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryParam -&gt; Option scheme
</span><a href="#local-6989586621679213549"><span class="hs-identifier hs-var">liftQueryParam</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryParam -&gt; Option scheme) -&gt; [QueryParam] -&gt; [Option scheme]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; [QueryParam]
</span><span class="hs-identifier hs-var hs-var">URI.uriQuery</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679213568"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span class="hs-comment">-- TODO Blocked on upstream: https://github.com/snoyberg/http-client/issues/424</span><span>
</span><span id="line-1018"></span><span class="hs-comment">-- fragment' =</span><span>
</span><span id="line-1019"></span><span class="hs-comment">--   case URI.uriFragment uri of</span><span>
</span><span id="line-1020"></span><span class="hs-comment">--     Nothing -&gt; mempty</span><span>
</span><span id="line-1021"></span><span class="hs-comment">--     Just fragment'' -&gt; fragment (URI.unRText fragment'')</span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span id="local-6989586621679213542"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#RequestComponent"><span class="hs-identifier hs-type">RequestComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213542"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1024"></span><span>  </span><span id="local-6989586621679213540"><span class="annot"><span class="annottext">getRequestMod :: Url scheme -&gt; Endo Request
</span><a href="#local-6989586621679213540"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestMod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Url"><span class="hs-identifier hs-type">Url</span></a></span><span> </span><span id="local-6989586621679213539"><span class="annot"><span class="annottext">scheme :: Scheme
</span><a href="#local-6989586621679213539"><span class="hs-identifier hs-var">scheme</span></a></span></span><span> </span><span id="local-6989586621679213538"><span class="annot"><span class="annottext">segments :: NonEmpty Text
</span><a href="#local-6989586621679213538"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Endo Request
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Endo Request)
-&gt; (Request -&gt; Request) -&gt; Endo Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213537"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213537"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1025"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213536"><span class="annot"><span class="annottext">host :: Text
</span><a href="#local-6989586621679213536"><span class="hs-identifier hs-var">host</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679213534"><span class="annot"><span class="annottext">path :: [Text]
</span><a href="#local-6989586621679213534"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Text -&gt; NonEmpty Text
forall a. NonEmpty a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NE.reverse</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Text
</span><a href="#local-6989586621679213538"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-1026"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213537"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1027"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">secure :: Bool
</span><a href="#local-6989586621679213532"><span class="hs-identifier hs-var">L.secure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Scheme
</span><a href="#local-6989586621679213539"><span class="hs-identifier hs-var">scheme</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1028"></span><span>              </span><span class="annot"><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-type">Http</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1029"></span><span>              </span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-1030"></span><span>            </span><span class="annot"><span class="annottext">port :: Int
</span><span class="hs-identifier hs-var">L.port</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Scheme
</span><a href="#local-6989586621679213539"><span class="hs-identifier hs-var">scheme</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1031"></span><span>              </span><span class="annot"><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-type">Http</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-number">80</span></span><span>
</span><span id="line-1032"></span><span>              </span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-number">443</span></span><span class="hs-special">,</span><span>
</span><span id="line-1033"></span><span>            </span><span class="annot"><span class="annottext">host :: ByteString
</span><a href="#local-6989586621679213530"><span class="hs-identifier hs-var">L.host</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Y.urlEncode</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679213536"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1034"></span><span>            </span><span class="annot"><span class="annottext">path :: ByteString
</span><a href="#local-6989586621679213528"><span class="hs-identifier hs-var">L.path</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1035"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; ([Text] -&gt; ByteString) -&gt; [Text] -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">BB.toLazyByteString</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString)
-&gt; ([Text] -&gt; Builder) -&gt; [Text] -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Builder
</span><span class="hs-identifier hs-var">Y.encodePathSegments</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679213534"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-1036"></span><span>          </span><span class="hs-special">}</span></span><span>
</span><span id="line-1037"></span><span>
</span><span id="line-1038"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1039"></span><span class="hs-comment">-- Request&#8212;Body</span><span>
</span><span id="line-1040"></span><span>
</span><span id="line-1041"></span><span class="hs-comment">-- $body</span><span>
</span><span id="line-1042"></span><span class="hs-comment">--</span><span>
</span><span id="line-1043"></span><span class="hs-comment">-- A number of options for request bodies are available. The @Content-Type@</span><span>
</span><span id="line-1044"></span><span class="hs-comment">-- header is set for you automatically according to the body option you use</span><span>
</span><span id="line-1045"></span><span class="hs-comment">-- (it's always specified in the documentation for a given body option). To</span><span>
</span><span id="line-1046"></span><span class="hs-comment">-- add your own way to represent request body, define an instance of</span><span>
</span><span id="line-1047"></span><span class="hs-comment">-- 'HttpBody'.</span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span class="hs-comment">-- | This data type represents empty body of an HTTP request. This is the</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- data type to use with 'HttpMethod's that cannot have a body, as it's the</span><span>
</span><span id="line-1051"></span><span class="hs-comment">-- only type for which 'ProvidesBody' returns 'NoBody'.</span><span>
</span><span id="line-1052"></span><span class="hs-comment">--</span><span>
</span><span id="line-1053"></span><span class="hs-comment">-- Using of this body option does not set the @Content-Type@ header.</span><span>
</span><span id="line-1054"></span><span class="hs-keyword">data</span><span> </span><span id="NoReqBody"><span class="annot"><a href="Network.HTTP.Req.html#NoReqBody"><span class="hs-identifier hs-var">NoReqBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NoReqBody"><span class="annot"><a href="Network.HTTP.Req.html#NoReqBody"><span class="hs-identifier hs-var">NoReqBody</span></a></span></span><span>
</span><span id="line-1055"></span><span>
</span><span id="line-1056"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213521"><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#NoReqBody"><span class="hs-identifier hs-type">NoReqBody</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1057"></span><span>  </span><span id="local-6989586621679213519"><span class="annot"><span class="annottext">getRequestBody :: NoReqBody -&gt; RequestBody
</span><a href="Network.HTTP.Req.html#getRequestBody"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#NoReqBody"><span class="hs-identifier hs-type">NoReqBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">L.RequestBodyBS</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">B.empty</span></span><span>
</span><span id="line-1058"></span><span>
</span><span id="line-1059"></span><span class="hs-comment">-- | This body option allows to use a JSON object as request body&#8212;probably</span><span>
</span><span id="line-1060"></span><span class="hs-comment">-- the most popular format right now. Just wrap a data type that is an</span><span>
</span><span id="line-1061"></span><span class="hs-comment">-- instance of 'ToJSON' type class and you are done: it will be converted to</span><span>
</span><span id="line-1062"></span><span class="hs-comment">-- JSON and inserted as request body.</span><span>
</span><span id="line-1063"></span><span class="hs-comment">--</span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- This body option sets the @Content-Type@ header to @\&quot;application/json;</span><span>
</span><span id="line-1065"></span><span class="hs-comment">-- charset=utf-8\&quot;@ value.</span><span>
</span><span id="line-1066"></span><span class="hs-keyword">newtype</span><span> </span><span id="ReqBodyJson"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyJson"><span class="hs-identifier hs-var">ReqBodyJson</span></a></span></span><span> </span><span id="local-6989586621679213515"><span class="annot"><a href="#local-6989586621679213515"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReqBodyJson"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyJson"><span class="hs-identifier hs-var">ReqBodyJson</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679213515"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span id="local-6989586621679213513"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679213513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyJson"><span class="hs-identifier hs-type">ReqBodyJson</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213513"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1069"></span><span>  </span><span id="local-6989586621679213510"><span class="annot"><span class="annottext">getRequestBody :: ReqBodyJson a -&gt; RequestBody
</span><a href="#local-6989586621679213510"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyJson"><span class="hs-identifier hs-type">ReqBodyJson</span></a></span><span> </span><span id="local-6989586621679213509"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679213509"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">L.RequestBodyLBS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">A.encode</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679213509"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span>  </span><span id="local-6989586621679213506"><span class="annot"><span class="annottext">getRequestContentType :: ReqBodyJson a -&gt; Maybe ByteString
</span><a href="Network.HTTP.Req.html#getRequestContentType"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestContentType</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="hs-string">&quot;application/json; charset=utf-8&quot;</span></span></span><span>
</span><span id="line-1071"></span><span>
</span><span id="line-1072"></span><span class="hs-comment">-- | This body option streams request body from a file. It is expected that</span><span>
</span><span id="line-1073"></span><span class="hs-comment">-- the file size does not change during the streaming.</span><span>
</span><span id="line-1074"></span><span class="hs-comment">--</span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- Using of this body option does not set the @Content-Type@ header.</span><span>
</span><span id="line-1076"></span><span class="hs-keyword">newtype</span><span> </span><span id="ReqBodyFile"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyFile"><span class="hs-identifier hs-var">ReqBodyFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReqBodyFile"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyFile"><span class="hs-identifier hs-var">ReqBodyFile</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-1077"></span><span>
</span><span id="line-1078"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213500"><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyFile"><span class="hs-identifier hs-type">ReqBodyFile</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1079"></span><span>  </span><span id="local-6989586621679213499"><span class="annot"><span class="annottext">getRequestBody :: ReqBodyFile -&gt; RequestBody
</span><a href="#local-6989586621679213499"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyFile"><span class="hs-identifier hs-type">ReqBodyFile</span></a></span><span> </span><span id="local-6989586621679213498"><span class="annot"><span class="annottext">path :: String
</span><a href="#local-6989586621679213498"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1080"></span><span>    </span><span class="annot"><span class="annottext">IO RequestBody -&gt; RequestBody
</span><span class="hs-identifier hs-var">LI.RequestBodyIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO RequestBody
</span><span class="hs-identifier hs-var">L.streamFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679213498"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span class="hs-comment">-- | HTTP request body represented by a strict 'ByteString'.</span><span>
</span><span id="line-1083"></span><span class="hs-comment">--</span><span>
</span><span id="line-1084"></span><span class="hs-comment">-- Using of this body option does not set the @Content-Type@ header.</span><span>
</span><span id="line-1085"></span><span class="hs-keyword">newtype</span><span> </span><span id="ReqBodyBs"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyBs"><span class="hs-identifier hs-var">ReqBodyBs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReqBodyBs"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyBs"><span class="hs-identifier hs-var">ReqBodyBs</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-1086"></span><span>
</span><span id="line-1087"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213492"><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyBs"><span class="hs-identifier hs-type">ReqBodyBs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1088"></span><span>  </span><span id="local-6989586621679213491"><span class="annot"><span class="annottext">getRequestBody :: ReqBodyBs -&gt; RequestBody
</span><a href="#local-6989586621679213491"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyBs"><span class="hs-identifier hs-type">ReqBodyBs</span></a></span><span> </span><span id="local-6989586621679213490"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679213490"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">L.RequestBodyBS</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213490"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1089"></span><span>
</span><span id="line-1090"></span><span class="hs-comment">-- | HTTP request body represented by a lazy 'BL.ByteString'.</span><span>
</span><span id="line-1091"></span><span class="hs-comment">--</span><span>
</span><span id="line-1092"></span><span class="hs-comment">-- Using of this body option does not set the @Content-Type@ header.</span><span>
</span><span id="line-1093"></span><span class="hs-keyword">newtype</span><span> </span><span id="ReqBodyLbs"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyLbs"><span class="hs-identifier hs-var">ReqBodyLbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReqBodyLbs"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyLbs"><span class="hs-identifier hs-var">ReqBodyLbs</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span>
</span><span id="line-1094"></span><span>
</span><span id="line-1095"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213486"><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyLbs"><span class="hs-identifier hs-type">ReqBodyLbs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1096"></span><span>  </span><span id="local-6989586621679213485"><span class="annot"><span class="annottext">getRequestBody :: ReqBodyLbs -&gt; RequestBody
</span><a href="#local-6989586621679213485"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyLbs"><span class="hs-identifier hs-type">ReqBodyLbs</span></a></span><span> </span><span id="local-6989586621679213484"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679213484"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">L.RequestBodyLBS</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213484"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1097"></span><span>
</span><span id="line-1098"></span><span class="hs-comment">-- | Form URL-encoded body. This can hold a collection of parameters which</span><span>
</span><span id="line-1099"></span><span class="hs-comment">-- are encoded similarly to query parameters at the end of query string,</span><span>
</span><span id="line-1100"></span><span class="hs-comment">-- with the only difference that they are stored in request body. The</span><span>
</span><span id="line-1101"></span><span class="hs-comment">-- similarity is reflected in the API as well, as you can use the same</span><span>
</span><span id="line-1102"></span><span class="hs-comment">-- combinators you would use to add query parameters: @('=:')@ and</span><span>
</span><span id="line-1103"></span><span class="hs-comment">-- 'queryFlag'.</span><span>
</span><span id="line-1104"></span><span class="hs-comment">--</span><span>
</span><span id="line-1105"></span><span class="hs-comment">-- This body option sets the @Content-Type@ header to</span><span>
</span><span id="line-1106"></span><span class="hs-comment">-- @\&quot;application/x-www-form-urlencoded\&quot;@ value.</span><span>
</span><span id="line-1107"></span><span class="hs-keyword">newtype</span><span> </span><span id="ReqBodyUrlEnc"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyUrlEnc"><span class="hs-identifier hs-var">ReqBodyUrlEnc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReqBodyUrlEnc"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyUrlEnc"><span class="hs-identifier hs-var">ReqBodyUrlEnc</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#FormUrlEncodedParam"><span class="hs-identifier hs-type">FormUrlEncodedParam</span></a></span><span>
</span><span id="line-1108"></span><span>
</span><span id="line-1109"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyUrlEnc"><span class="hs-identifier hs-type">ReqBodyUrlEnc</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1110"></span><span>  </span><span id="local-6989586621679213480"><span class="annot"><span class="annottext">getRequestBody :: ReqBodyUrlEnc -&gt; RequestBody
</span><a href="#local-6989586621679213480"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyUrlEnc"><span class="hs-identifier hs-type">ReqBodyUrlEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#FormUrlEncodedParam"><span class="hs-identifier hs-type">FormUrlEncodedParam</span></a></span><span> </span><span id="local-6989586621679213478"><span class="annot"><span class="annottext">params :: [(Text, Maybe Text)]
</span><a href="#local-6989586621679213478"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1111"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">L.RequestBodyLBS</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RequestBody)
-&gt; (Builder -&gt; ByteString) -&gt; Builder -&gt; RequestBody
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">BB.toLazyByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; [(Text, Maybe Text)] -&gt; Builder
</span><span class="hs-identifier hs-var">Y.renderQueryText</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Maybe Text)]
</span><a href="#local-6989586621679213478"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1112"></span><span>  </span><span id="local-6989586621679213476"><span class="annot"><span class="annottext">getRequestContentType :: ReqBodyUrlEnc -&gt; Maybe ByteString
</span><a href="#local-6989586621679213476"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestContentType</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="hs-string">&quot;application/x-www-form-urlencoded&quot;</span></span><span>
</span><span id="line-1113"></span><span>
</span><span id="line-1114"></span><span class="hs-comment">-- | An opaque monoidal value that allows to collect URL-encoded parameters</span><span>
</span><span id="line-1115"></span><span class="hs-comment">-- to be wrapped in 'ReqBodyUrlEnc'.</span><span>
</span><span id="line-1116"></span><span class="hs-keyword">newtype</span><span> </span><span id="FormUrlEncodedParam"><span class="annot"><a href="Network.HTTP.Req.html#FormUrlEncodedParam"><span class="hs-identifier hs-var">FormUrlEncodedParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FormUrlEncodedParam"><span class="annot"><a href="Network.HTTP.Req.html#FormUrlEncodedParam"><span class="hs-identifier hs-var">FormUrlEncodedParam</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1117"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213470"><span id="local-6989586621679213472"><span id="local-6989586621679213474"><span class="annot"><span class="annottext">b -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
NonEmpty FormUrlEncodedParam -&gt; FormUrlEncodedParam
FormUrlEncodedParam -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
(FormUrlEncodedParam -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam)
-&gt; (NonEmpty FormUrlEncodedParam -&gt; FormUrlEncodedParam)
-&gt; (forall b.
    Integral b =&gt;
    b -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam)
-&gt; Semigroup FormUrlEncodedParam
forall b.
Integral b =&gt;
b -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
stimes :: b -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
$cstimes :: forall b.
Integral b =&gt;
b -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
sconcat :: NonEmpty FormUrlEncodedParam -&gt; FormUrlEncodedParam
$csconcat :: NonEmpty FormUrlEncodedParam -&gt; FormUrlEncodedParam
&lt;&gt; :: FormUrlEncodedParam -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
$c&lt;&gt; :: FormUrlEncodedParam -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213462"><span id="local-6989586621679213464"><span id="local-6989586621679213466"><span class="annot"><span class="annottext">Semigroup FormUrlEncodedParam
FormUrlEncodedParam
Semigroup FormUrlEncodedParam =&gt;
FormUrlEncodedParam
-&gt; (FormUrlEncodedParam
    -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam)
-&gt; ([FormUrlEncodedParam] -&gt; FormUrlEncodedParam)
-&gt; Monoid FormUrlEncodedParam
[FormUrlEncodedParam] -&gt; FormUrlEncodedParam
FormUrlEncodedParam -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
forall a.
Semigroup a =&gt;
a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
mconcat :: [FormUrlEncodedParam] -&gt; FormUrlEncodedParam
$cmconcat :: [FormUrlEncodedParam] -&gt; FormUrlEncodedParam
mappend :: FormUrlEncodedParam -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
$cmappend :: FormUrlEncodedParam -&gt; FormUrlEncodedParam -&gt; FormUrlEncodedParam
mempty :: FormUrlEncodedParam
$cmempty :: FormUrlEncodedParam
$cp1Monoid :: Semigroup FormUrlEncodedParam
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#QueryParam"><span class="hs-identifier hs-type">QueryParam</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#FormUrlEncodedParam"><span class="hs-identifier hs-type">FormUrlEncodedParam</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1120"></span><span>  </span><span id="local-6989586621679213458"><span class="annot"><span class="annottext">queryParam :: Text -&gt; Maybe a -&gt; FormUrlEncodedParam
</span><a href="Network.HTTP.Req.html#queryParam"><span class="hs-identifier hs-var hs-var hs-var hs-var">queryParam</span></a></span></span><span> </span><span id="local-6989586621679213456"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679213456"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679213455"><span class="annot"><span class="annottext">mvalue :: Maybe a
</span><a href="#local-6989586621679213455"><span class="hs-identifier hs-var">mvalue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1121"></span><span>    </span><span class="annot"><span class="annottext">[(Text, Maybe Text)] -&gt; FormUrlEncodedParam
</span><a href="Network.HTTP.Req.html#FormUrlEncodedParam"><span class="hs-identifier hs-var">FormUrlEncodedParam</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679213456"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToHttpApiData a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toQueryParam</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Text) -&gt; Maybe a -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679213455"><span class="hs-identifier hs-var">mvalue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1122"></span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- | Multipart form data. Please consult the</span><span>
</span><span id="line-1124"></span><span class="hs-comment">-- &quot;Network.HTTP.Client.MultipartFormData&quot; module for how to construct</span><span>
</span><span id="line-1125"></span><span class="hs-comment">-- parts, then use 'reqBodyMultipart' to create actual request body from the</span><span>
</span><span id="line-1126"></span><span class="hs-comment">-- parts. 'reqBodyMultipart' is the only way to get a value of the type</span><span>
</span><span id="line-1127"></span><span class="hs-comment">-- 'ReqBodyMultipart', as its constructor is not exported on purpose.</span><span>
</span><span id="line-1128"></span><span class="hs-comment">--</span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1130"></span><span class="hs-comment">--</span><span>
</span><span id="line-1131"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-1132"></span><span class="hs-comment">--</span><span>
</span><span id="line-1133"></span><span class="hs-comment">-- &gt; import Control.Monad.IO.Class</span><span>
</span><span id="line-1134"></span><span class="hs-comment">-- &gt; import Data.Default.Class</span><span>
</span><span id="line-1135"></span><span class="hs-comment">-- &gt; import Network.HTTP.Req</span><span>
</span><span id="line-1136"></span><span class="hs-comment">-- &gt; import qualified Network.HTTP.Client.MultipartFormData as LM</span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-1138"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-1139"></span><span class="hs-comment">-- &gt; main = runReq def $ do</span><span>
</span><span id="line-1140"></span><span class="hs-comment">-- &gt;   body &lt;-</span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- &gt;     reqBodyMultipart</span><span>
</span><span id="line-1142"></span><span class="hs-comment">-- &gt;       [ LM.partBS &quot;title&quot; &quot;My Image&quot;</span><span>
</span><span id="line-1143"></span><span class="hs-comment">-- &gt;       , LM.partFileSource &quot;file1&quot; &quot;/tmp/image.jpg&quot;</span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- &gt;       ]</span><span>
</span><span id="line-1145"></span><span class="hs-comment">-- &gt;   response &lt;-</span><span>
</span><span id="line-1146"></span><span class="hs-comment">-- &gt;     req POST (http &quot;example.com&quot; /: &quot;post&quot;)</span><span>
</span><span id="line-1147"></span><span class="hs-comment">-- &gt;       body</span><span>
</span><span id="line-1148"></span><span class="hs-comment">-- &gt;       bsResponse</span><span>
</span><span id="line-1149"></span><span class="hs-comment">-- &gt;       mempty</span><span>
</span><span id="line-1150"></span><span class="hs-comment">-- &gt;   liftIO $ print (responseBody response)</span><span>
</span><span id="line-1151"></span><span class="hs-keyword">data</span><span> </span><span id="ReqBodyMultipart"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier hs-var">ReqBodyMultipart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReqBodyMultipart"><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier hs-var">ReqBodyMultipart</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LI.RequestBody</span></span><span>
</span><span id="line-1152"></span><span>
</span><span id="line-1153"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier hs-type">ReqBodyMultipart</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1154"></span><span>  </span><span id="local-6989586621679213450"><span class="annot"><span class="annottext">getRequestBody :: ReqBodyMultipart -&gt; RequestBody
</span><a href="#local-6989586621679213450"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier hs-type">ReqBodyMultipart</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679213449"><span class="annot"><span class="annottext">body :: RequestBody
</span><a href="#local-6989586621679213449"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679213449"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1155"></span><span>  </span><span id="local-6989586621679213448"><span class="annot"><span class="annottext">getRequestContentType :: ReqBodyMultipart -&gt; Maybe ByteString
</span><a href="#local-6989586621679213448"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestContentType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier hs-type">ReqBodyMultipart</span></a></span><span> </span><span id="local-6989586621679213447"><span class="annot"><span class="annottext">boundary :: ByteString
</span><a href="#local-6989586621679213447"><span class="hs-identifier hs-var">boundary</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1156"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;multipart/form-data; boundary=&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213447"><span class="hs-identifier hs-var">boundary</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>
</span><span id="line-1158"></span><span class="hs-comment">-- | Create 'ReqBodyMultipart' request body from a collection of 'LM.Part's.</span><span>
</span><span id="line-1159"></span><span class="hs-comment">--</span><span>
</span><span id="line-1160"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1161"></span><span id="local-6989586621679213446"><span class="annot"><a href="Network.HTTP.Req.html#reqBodyMultipart"><span class="hs-identifier hs-type">reqBodyMultipart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679213446"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">LM.Part</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679213446"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier hs-type">ReqBodyMultipart</span></a></span></span><span>
</span><span id="line-1162"></span><span id="reqBodyMultipart"><span class="annot"><span class="annottext">reqBodyMultipart :: [Part] -&gt; m ReqBodyMultipart
</span><a href="Network.HTTP.Req.html#reqBodyMultipart"><span class="hs-identifier hs-var hs-var">reqBodyMultipart</span></a></span></span><span> </span><span id="local-6989586621679213445"><span class="annot"><span class="annottext">parts :: [Part]
</span><a href="#local-6989586621679213445"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ReqBodyMultipart -&gt; m ReqBodyMultipart
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ReqBodyMultipart -&gt; m ReqBodyMultipart)
-&gt; IO ReqBodyMultipart -&gt; m ReqBodyMultipart
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1163"></span><span>  </span><span id="local-6989586621679213444"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213444"><span class="hs-identifier hs-var">boundary</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BodyReader
</span><span class="hs-identifier hs-var">LM.webkitBoundary</span></span><span>
</span><span id="line-1164"></span><span>  </span><span id="local-6989586621679213442"><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679213442"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Part] -&gt; IO RequestBody
forall (m :: * -&gt; *).
Applicative m =&gt;
ByteString -&gt; [PartM m] -&gt; m RequestBody
</span><span class="hs-identifier hs-var">LM.renderParts</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213444"><span class="hs-identifier hs-var">boundary</span></a></span><span> </span><span class="annot"><span class="annottext">[Part]
</span><a href="#local-6989586621679213445"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-1165"></span><span>  </span><span class="annot"><span class="annottext">ReqBodyMultipart -&gt; IO ReqBodyMultipart
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody -&gt; ReqBodyMultipart
</span><a href="Network.HTTP.Req.html#ReqBodyMultipart"><span class="hs-identifier hs-var">ReqBodyMultipart</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213444"><span class="hs-identifier hs-var">boundary</span></a></span><span> </span><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679213442"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1166"></span><span>
</span><span id="line-1167"></span><span class="hs-comment">-- | A type class for things that can be interpreted as an HTTP</span><span>
</span><span id="line-1168"></span><span class="hs-comment">-- 'L.RequestBody'.</span><span>
</span><span id="line-1169"></span><span class="hs-keyword">class</span><span> </span><span id="HttpBody"><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-var">HttpBody</span></a></span></span><span> </span><span id="local-6989586621679214085"><span class="annot"><a href="#local-6989586621679214085"><span class="hs-identifier hs-type">body</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1170"></span><span>  </span><span class="hs-comment">-- | How to get actual 'L.RequestBody'.</span><span>
</span><span id="line-1171"></span><span>  </span><span id="getRequestBody"><span class="annot"><a href="Network.HTTP.Req.html#getRequestBody"><span class="hs-identifier hs-type">getRequestBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679214085"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.RequestBody</span></span><span>
</span><span id="line-1172"></span><span>
</span><span id="line-1173"></span><span>  </span><span class="hs-comment">-- | This method allows us to optionally specify the value of</span><span>
</span><span id="line-1174"></span><span>  </span><span class="hs-comment">-- @Content-Type@ header that should be used with particular body option.</span><span>
</span><span id="line-1175"></span><span>  </span><span class="hs-comment">-- By default it returns 'Nothing' and so @Content-Type@ is not set.</span><span>
</span><span id="line-1176"></span><span>  </span><span id="getRequestContentType"><span class="annot"><a href="Network.HTTP.Req.html#getRequestContentType"><span class="hs-identifier hs-type">getRequestContentType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679214085"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-1177"></span><span>  </span><span id="local-6989586621679213440"><span class="annot"><a href="Network.HTTP.Req.html#getRequestContentType"><span class="hs-identifier hs-var hs-var">getRequestContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; body -&gt; Maybe ByteString
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-1178"></span><span>
</span><span id="line-1179"></span><span class="hs-comment">-- | The type function recognizes 'NoReqBody' as having 'NoBody', while any</span><span>
</span><span id="line-1180"></span><span class="hs-comment">-- other body option 'CanHaveBody'. This forces the user to use 'NoReqBody'</span><span>
</span><span id="line-1181"></span><span class="hs-comment">-- with 'GET' method and other methods that should not have body.</span><span>
</span><span id="line-1182"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ProvidesBody"><span class="annot"><a href="Network.HTTP.Req.html#ProvidesBody"><span class="hs-identifier hs-var">ProvidesBody</span></a></span></span><span> </span><span id="local-6989586621679213439"><span class="annot"><a href="#local-6989586621679213439"><span class="hs-identifier hs-type">body</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1183"></span><span>  </span><span id="ProvidesBody"><span class="annot"><a href="Network.HTTP.Req.html#ProvidesBody"><span class="hs-identifier hs-var">ProvidesBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#NoReqBody"><span class="hs-identifier hs-type">NoReqBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span>
</span><span id="line-1184"></span><span>  </span><span id="ProvidesBody"><span class="annot"><a href="Network.HTTP.Req.html#ProvidesBody"><span class="hs-identifier hs-var">ProvidesBody</span></a></span></span><span> </span><span id="local-6989586621679213438"><span class="annot"><a href="#local-6989586621679213438"><span class="hs-identifier hs-type hs-type">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span>
</span><span id="line-1185"></span><span>
</span><span id="line-1186"></span><span class="hs-comment">-- | This type function allows any HTTP body if method says it</span><span>
</span><span id="line-1187"></span><span class="hs-comment">-- 'CanHaveBody'. When the method says it should have 'NoBody', the only</span><span>
</span><span id="line-1188"></span><span class="hs-comment">-- body option to use is 'NoReqBody'.</span><span>
</span><span id="line-1189"></span><span class="hs-comment">--</span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- __Note__: users of GHC 8.0.1 and later will see a slightly more friendly</span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- error message when method does not allow a body and body is provided.</span><span>
</span><span id="line-1192"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-1193"></span><span>  </span><span id="HttpBodyAllowed"><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier hs-var">HttpBodyAllowed</span></a></span></span><span>
</span><span id="line-1194"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679213437"><span class="annot"><a href="#local-6989586621679213437"><span class="hs-identifier hs-type">allowsBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1195"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679213436"><span class="annot"><a href="#local-6989586621679213436"><span class="hs-identifier hs-type">providesBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1196"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span>
</span><span id="line-1197"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1198"></span><span>  </span><span id="HttpBodyAllowed"><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier hs-var">HttpBodyAllowed</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1199"></span><span>  </span><span id="HttpBodyAllowed"><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier hs-var">HttpBodyAllowed</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span> </span><span id="local-6989586621679213435"><span class="annot"><a href="#local-6989586621679213435"><span class="hs-identifier hs-type hs-type">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1200"></span><span>  </span><span id="HttpBodyAllowed"><span class="annot"><a href="Network.HTTP.Req.html#HttpBodyAllowed"><span class="hs-identifier hs-var">HttpBodyAllowed</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-type">NoBody</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-type">CanHaveBody</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1201"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span>
</span><span id="line-1202"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;This HTTP method does not allow attaching a request body.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span id="local-6989586621679213434"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpBody"><span class="hs-identifier hs-type">HttpBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213434"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#RequestComponent"><span class="hs-identifier hs-type">RequestComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-type">Womb</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679213434"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1205"></span><span>  </span><span id="local-6989586621679213432"><span class="annot"><span class="annottext">getRequestMod :: Womb &quot;body&quot; body -&gt; Endo Request
</span><a href="#local-6989586621679213432"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestMod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-type">Womb</span></a></span><span> </span><span id="local-6989586621679213431"><span class="annot"><span class="annottext">body :: body
</span><a href="#local-6989586621679213431"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Endo Request
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Endo Request)
-&gt; (Request -&gt; Request) -&gt; Endo Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213430"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213430"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1206"></span><span>    </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213430"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1207"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">requestBody :: RequestBody
</span><a href="#local-6989586621679213429"><span class="hs-identifier hs-var">L.requestBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">body -&gt; RequestBody
forall body. HttpBody body =&gt; body -&gt; RequestBody
</span><a href="Network.HTTP.Req.html#getRequestBody"><span class="hs-identifier hs-var">getRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621679213431"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1208"></span><span>        </span><span class="annot"><span class="annottext">requestHeaders :: RequestHeaders
</span><span class="hs-identifier hs-var">L.requestHeaders</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1209"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213428"><span class="annot"><span class="annottext">old :: RequestHeaders
</span><a href="#local-6989586621679213428"><span class="hs-identifier hs-var hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; RequestHeaders
</span><span class="hs-identifier hs-var hs-var">L.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213430"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1210"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">body -&gt; Maybe ByteString
forall body. HttpBody body =&gt; body -&gt; Maybe ByteString
</span><a href="Network.HTTP.Req.html#getRequestContentType"><span class="hs-identifier hs-var">getRequestContentType</span></a></span><span> </span><span class="annot"><span class="annottext">body
</span><a href="#local-6989586621679213431"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1211"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679213428"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-1212"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679213427"><span class="annot"><span class="annottext">contentType :: ByteString
</span><a href="#local-6989586621679213427"><span class="hs-identifier hs-var">contentType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1213"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-identifier hs-var">Y.hContentType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213427"><span class="hs-identifier hs-var">contentType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HeaderName, ByteString) -&gt; RequestHeaders -&gt; RequestHeaders
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679213428"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-1214"></span><span>      </span><span class="hs-special">}</span></span><span>
</span><span id="line-1215"></span><span>
</span><span id="line-1216"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1217"></span><span class="hs-comment">-- Request&#8212;Optional parameters</span><span>
</span><span id="line-1218"></span><span>
</span><span id="line-1219"></span><span class="hs-comment">-- $optional-parameters</span><span>
</span><span id="line-1220"></span><span class="hs-comment">--</span><span>
</span><span id="line-1221"></span><span class="hs-comment">-- Optional parameters of request include things like query parameters,</span><span>
</span><span id="line-1222"></span><span class="hs-comment">-- headers, port number, etc. All optional parameters have the type</span><span>
</span><span id="line-1223"></span><span class="hs-comment">-- 'Option', which is a 'Monoid'. This means that you can use 'mempty' as</span><span>
</span><span id="line-1224"></span><span class="hs-comment">-- the last argument of 'req' to specify no optional parameters, or combine</span><span>
</span><span id="line-1225"></span><span class="hs-comment">-- 'Option's using 'mappend' or @('&lt;&gt;')@ to have several of them at once.</span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span class="hs-comment">-- | The opaque 'Option' type is a 'Monoid' you can use to pack collection</span><span>
</span><span id="line-1228"></span><span class="hs-comment">-- of optional parameters like query parameters and headers. See sections</span><span>
</span><span id="line-1229"></span><span class="hs-comment">-- below to learn which 'Option' primitives are available.</span><span>
</span><span id="line-1230"></span><span class="hs-keyword">data</span><span> </span><span id="Option"><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-var">Option</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679214062"><span class="annot"><a href="#local-6989586621679214062"><span class="hs-identifier hs-type">scheme</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Scheme"><span class="hs-identifier hs-type">Scheme</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Option"><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-var">Option</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Y.QueryText</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1232"></span><span>
</span><span id="line-1233"></span><span class="hs-comment">-- NOTE 'QueryText' is just [(Text, Maybe Text)], we keep it along with</span><span>
</span><span id="line-1234"></span><span class="hs-comment">-- Request to avoid appending to existing query string in request every</span><span>
</span><span id="line-1235"></span><span class="hs-comment">-- time new parameter is added. Additional Maybe (L.Request -&gt; IO</span><span>
</span><span id="line-1236"></span><span class="hs-comment">-- L.Request) is a finalizer that will be applied after all other</span><span>
</span><span id="line-1237"></span><span class="hs-comment">-- transformations. This is for authentication methods that sign requests</span><span>
</span><span id="line-1238"></span><span class="hs-comment">-- based on data in Request.</span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span id="local-6989586621679213423"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213418"><span id="local-6989586621679213420"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213423"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1241"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span id="local-6989586621679213417"><span class="annot"><span class="annottext">er0 :: Endo ([(Text, Maybe Text)], Request)
</span><a href="#local-6989586621679213417"><span class="hs-identifier hs-var">er0</span></a></span></span><span> </span><span id="local-6989586621679213416"><span class="annot"><span class="annottext">mr0 :: Maybe (Request -&gt; IO Request)
</span><a href="#local-6989586621679213416"><span class="hs-identifier hs-var">mr0</span></a></span></span><span> </span><span id="local-6989586621679213415"><span class="annot"><span class="annottext">&lt;&gt; :: Option scheme -&gt; Option scheme -&gt; Option scheme
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span id="local-6989586621679213414"><span class="annot"><span class="annottext">er1 :: Endo ([(Text, Maybe Text)], Request)
</span><a href="#local-6989586621679213414"><span class="hs-identifier hs-var">er1</span></a></span></span><span> </span><span id="local-6989586621679213413"><span class="annot"><span class="annottext">mr1 :: Maybe (Request -&gt; IO Request)
</span><a href="#local-6989586621679213413"><span class="hs-identifier hs-var">mr1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1242"></span><span>    </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
forall (scheme :: Scheme).
Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span>
</span><span id="line-1243"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
</span><a href="#local-6989586621679213417"><span class="hs-identifier hs-var">er0</span></a></span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
-&gt; Endo ([(Text, Maybe Text)], Request)
-&gt; Endo ([(Text, Maybe Text)], Request)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
</span><a href="#local-6989586621679213414"><span class="hs-identifier hs-var">er1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1244"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Request -&gt; IO Request)
</span><a href="#local-6989586621679213416"><span class="hs-identifier hs-var">mr0</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Request -&gt; IO Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Maybe (Request -&gt; IO Request)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Request -&gt; IO Request)
</span><a href="#local-6989586621679213413"><span class="hs-identifier hs-var">mr1</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span id="local-6989586621679213412"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213407"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213412"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1247"></span><span>  </span><span id="local-6989586621679213406"><span class="annot"><span class="annottext">mempty :: Option scheme
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
forall (scheme :: Scheme).
Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Request -&gt; IO Request)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1248"></span><span>  </span><span id="local-6989586621679213405"><span class="annot"><span class="annottext">mappend :: Option scheme -&gt; Option scheme -&gt; Option scheme
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Option scheme -&gt; Option scheme -&gt; Option scheme
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span></span><span>
</span><span id="line-1249"></span><span>
</span><span id="line-1250"></span><span class="hs-comment">-- | A helper to create an 'Option' that modifies only collection of query</span><span>
</span><span id="line-1251"></span><span class="hs-comment">-- parameters. This helper is not a part of the public API.</span><span>
</span><span id="line-1252"></span><span id="local-6989586621679214040"><span class="annot"><a href="Network.HTTP.Req.html#withQueryParams"><span class="hs-identifier hs-type">withQueryParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Y.QueryText</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Y.QueryText</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214040"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1253"></span><span id="withQueryParams"><span class="annot"><span class="annottext">withQueryParams :: ([(Text, Maybe Text)] -&gt; [(Text, Maybe Text)]) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withQueryParams"><span class="hs-identifier hs-var hs-var">withQueryParams</span></a></span></span><span> </span><span id="local-6989586621679213403"><span class="annot"><span class="annottext">f :: [(Text, Maybe Text)] -&gt; [(Text, Maybe Text)]
</span><a href="#local-6989586621679213403"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
forall (scheme :: Scheme).
Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([(Text, Maybe Text)], Request)
 -&gt; ([(Text, Maybe Text)], Request))
-&gt; Endo ([(Text, Maybe Text)], Request)
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(Text, Maybe Text)] -&gt; [(Text, Maybe Text)])
-&gt; ([(Text, Maybe Text)], Request)
-&gt; ([(Text, Maybe Text)], Request)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Maybe Text)] -&gt; [(Text, Maybe Text)]
</span><a href="#local-6989586621679213403"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Request -&gt; IO Request)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span class="hs-comment">-- | A helper to create an 'Option' that modifies only 'L.Request'. This</span><span>
</span><span id="line-1256"></span><span class="hs-comment">-- helper is not a part of public API.</span><span>
</span><span id="line-1257"></span><span id="local-6989586621679214038"><span class="annot"><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-type">withRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214038"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1258"></span><span id="withRequest"><span class="annot"><span class="annottext">withRequest :: (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var hs-var">withRequest</span></a></span></span><span> </span><span id="local-6989586621679213401"><span class="annot"><span class="annottext">f :: Request -&gt; Request
</span><a href="#local-6989586621679213401"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
forall (scheme :: Scheme).
Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([(Text, Maybe Text)], Request)
 -&gt; ([(Text, Maybe Text)], Request))
-&gt; Endo ([(Text, Maybe Text)], Request)
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Request -&gt; Request)
-&gt; ([(Text, Maybe Text)], Request)
-&gt; ([(Text, Maybe Text)], Request)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679213401"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Request -&gt; IO Request)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1259"></span><span>
</span><span id="line-1260"></span><span id="local-6989586621679213400"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#RequestComponent"><span class="hs-identifier hs-type">RequestComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213400"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1261"></span><span>  </span><span id="local-6989586621679213398"><span class="annot"><span class="annottext">getRequestMod :: Option scheme -&gt; Endo Request
</span><a href="#local-6989586621679213398"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRequestMod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span id="local-6989586621679213397"><span class="annot"><span class="annottext">f :: Endo ([(Text, Maybe Text)], Request)
</span><a href="#local-6989586621679213397"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Endo Request
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Endo Request)
-&gt; (Request -&gt; Request) -&gt; Endo Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213396"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213396"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1262"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213395"><span class="annot"><span class="annottext">qparams :: [(Text, Maybe Text)]
</span><a href="#local-6989586621679213395"><span class="hs-identifier hs-var">qparams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213394"><span class="annot"><span class="annottext">x' :: Request
</span><a href="#local-6989586621679213394"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
-&gt; ([(Text, Maybe Text)], Request)
-&gt; ([(Text, Maybe Text)], Request)
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">appEndo</span></span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
</span><a href="#local-6989586621679213397"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213396"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1263"></span><span>        </span><span id="local-6989586621679213393"><span class="annot"><span class="annottext">query :: ByteString
</span><a href="#local-6989586621679213393"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Query -&gt; ByteString
</span><span class="hs-identifier hs-var">Y.renderQuery</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Maybe Text)] -&gt; Query
</span><span class="hs-identifier hs-var">Y.queryTextToQuery</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Maybe Text)]
</span><a href="#local-6989586621679213395"><span class="hs-identifier hs-var">qparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1264"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213394"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">queryString :: ByteString
</span><a href="#local-6989586621679213390"><span class="hs-identifier hs-var">L.queryString</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213393"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">}</span></span><span>
</span><span id="line-1265"></span><span>
</span><span id="line-1266"></span><span class="hs-comment">-- | Finalize given 'L.Request' by applying a finalizer from the given</span><span>
</span><span id="line-1267"></span><span class="hs-comment">-- 'Option' (if it has any).</span><span>
</span><span id="line-1268"></span><span id="local-6989586621679214339"><span id="local-6989586621679214340"><span class="annot"><a href="Network.HTTP.Req.html#finalizeRequest"><span class="hs-identifier hs-type">finalizeRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679214340"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214339"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214340"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span></span></span><span>
</span><span id="line-1269"></span><span id="finalizeRequest"><span class="annot"><span class="annottext">finalizeRequest :: Option scheme -&gt; Request -&gt; m Request
</span><a href="Network.HTTP.Req.html#finalizeRequest"><span class="hs-identifier hs-var hs-var">finalizeRequest</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679213389"><span class="annot"><span class="annottext">mfinalizer :: Maybe (Request -&gt; IO Request)
</span><a href="#local-6989586621679213389"><span class="hs-identifier hs-var">mfinalizer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Request -&gt; m Request
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Request -&gt; m Request)
-&gt; (Request -&gt; IO Request) -&gt; Request -&gt; m Request
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Request -&gt; IO Request
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Request -&gt; IO Request)
</span><a href="#local-6989586621679213389"><span class="hs-identifier hs-var">mfinalizer</span></a></span><span>
</span><span id="line-1270"></span><span>
</span><span id="line-1271"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1272"></span><span class="hs-comment">-- Request&#8212;Optional parameters&#8212;Query Parameters</span><span>
</span><span id="line-1273"></span><span>
</span><span id="line-1274"></span><span class="hs-comment">-- $query-parameters</span><span>
</span><span id="line-1275"></span><span class="hs-comment">--</span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- This section describes a polymorphic interface that can be used to</span><span>
</span><span id="line-1277"></span><span class="hs-comment">-- construct query parameters (of the type 'Option') and form URL-encoded</span><span>
</span><span id="line-1278"></span><span class="hs-comment">-- bodies (of the type 'FormUrlEncodedParam').</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- | This operator builds a query parameter that will be included in URL of</span><span>
</span><span id="line-1281"></span><span class="hs-comment">-- your request after the question sign @?@. This is the same syntax you use</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- with form URL encoded request bodies.</span><span>
</span><span id="line-1283"></span><span class="hs-comment">--</span><span>
</span><span id="line-1284"></span><span class="hs-comment">-- This operator is defined in terms of 'queryParam':</span><span>
</span><span id="line-1285"></span><span class="hs-comment">--</span><span>
</span><span id="line-1286"></span><span class="hs-comment">-- &gt; name =: value = queryParam name (pure value)</span><span>
</span><span id="line-1287"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#%3D%3A"><span class="hs-operator hs-type">=:</span></a></span><span>
</span><span id="line-1288"></span><span>
</span><span id="line-1289"></span><span id="local-6989586621679214092"><span id="local-6989586621679214093"><span class="annot"><a href="Network.HTTP.Req.html#%3D%3A"><span class="hs-operator hs-type">(=:)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#QueryParam"><span class="hs-identifier hs-type">QueryParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214093"><span class="hs-identifier hs-type">param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToHttpApiData</span></span><span> </span><span class="annot"><a href="#local-6989586621679214092"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214092"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214093"><span class="hs-identifier hs-type">param</span></a></span></span></span><span>
</span><span id="line-1290"></span><span id="local-6989586621679213388"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679213388"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="%3D%3A"><span class="annot"><span class="annottext">=: :: Text -&gt; a -&gt; param
</span><a href="Network.HTTP.Req.html#%3D%3A"><span class="hs-operator hs-var hs-var">=:</span></a></span></span><span> </span><span id="local-6989586621679213387"><span class="annot"><span class="annottext">value :: a
</span><a href="#local-6989586621679213387"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe a -&gt; param
forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; Maybe a -&gt; param
</span><a href="Network.HTTP.Req.html#queryParam"><span class="hs-identifier hs-var">queryParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679213388"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679213387"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span><span>
</span><span id="line-1292"></span><span class="hs-comment">-- | Construct a flag, that is, valueless query parameter. For example, in</span><span>
</span><span id="line-1293"></span><span class="hs-comment">-- the following URL @\&quot;a\&quot;@ is a flag, while @\&quot;b\&quot;@ is a query parameter</span><span>
</span><span id="line-1294"></span><span class="hs-comment">-- with a value:</span><span>
</span><span id="line-1295"></span><span class="hs-comment">--</span><span>
</span><span id="line-1296"></span><span class="hs-comment">-- &gt; https://httpbin.org/foo/bar?a&amp;b=10</span><span>
</span><span id="line-1297"></span><span class="hs-comment">--</span><span>
</span><span id="line-1298"></span><span class="hs-comment">-- This operator is defined in terms of 'queryParam':</span><span>
</span><span id="line-1299"></span><span class="hs-comment">--</span><span>
</span><span id="line-1300"></span><span class="hs-comment">-- &gt; queryFlag name = queryParam name (Nothing :: Maybe ())</span><span>
</span><span id="line-1301"></span><span id="local-6989586621679214096"><span class="annot"><a href="Network.HTTP.Req.html#queryFlag"><span class="hs-identifier hs-type">queryFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#QueryParam"><span class="hs-identifier hs-type">QueryParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214096"><span class="hs-identifier hs-type">param</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214096"><span class="hs-identifier hs-type">param</span></a></span></span><span>
</span><span id="line-1302"></span><span id="queryFlag"><span class="annot"><span class="annottext">queryFlag :: Text -&gt; param
</span><a href="Network.HTTP.Req.html#queryFlag"><span class="hs-identifier hs-var hs-var">queryFlag</span></a></span></span><span> </span><span id="local-6989586621679213386"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679213386"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe () -&gt; param
forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; Maybe a -&gt; param
</span><a href="Network.HTTP.Req.html#queryParam"><span class="hs-identifier hs-var">queryParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679213386"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1303"></span><span>
</span><span id="line-1304"></span><span class="hs-comment">-- | A type class for query-parameter-like things. The reason to have an</span><span>
</span><span id="line-1305"></span><span class="hs-comment">-- overloaded 'queryParam' is to be able to use it as an 'Option' and as a</span><span>
</span><span id="line-1306"></span><span class="hs-comment">-- 'FormUrlEncodedParam' when constructing form URL encoded request bodies.</span><span>
</span><span id="line-1307"></span><span class="hs-comment">-- Having the same syntax for these cases seems natural and user-friendly.</span><span>
</span><span id="line-1308"></span><span class="hs-keyword">class</span><span> </span><span id="QueryParam"><span class="annot"><a href="Network.HTTP.Req.html#QueryParam"><span class="hs-identifier hs-var">QueryParam</span></a></span></span><span> </span><span id="local-6989586621679214072"><span class="annot"><a href="#local-6989586621679214072"><span class="hs-identifier hs-type">param</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1309"></span><span>  </span><span class="hs-comment">-- | Create a query parameter with given name and value. If value is</span><span>
</span><span id="line-1310"></span><span>  </span><span class="hs-comment">-- 'Nothing', it won't be included at all (i.e. you create a flag this</span><span>
</span><span id="line-1311"></span><span>  </span><span class="hs-comment">-- way). It's recommended to use @('=:')@ and 'queryFlag' instead of this</span><span>
</span><span id="line-1312"></span><span>  </span><span class="hs-comment">-- method, because they are easier to read.</span><span>
</span><span id="line-1313"></span><span>  </span><span id="local-6989586621679214073"><span id="queryParam"><span class="annot"><a href="Network.HTTP.Req.html#queryParam"><span class="hs-identifier hs-type">queryParam</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToHttpApiData</span></span><span> </span><span class="annot"><a href="#local-6989586621679214073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679214073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214072"><span class="hs-identifier hs-type">param</span></a></span></span><span>
</span><span id="line-1314"></span><span>
</span><span id="line-1315"></span><span id="local-6989586621679213385"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#QueryParam"><span class="hs-identifier hs-type">QueryParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213385"><span class="hs-identifier hs-type">scheme</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1316"></span><span>  </span><span id="local-6989586621679213383"><span class="annot"><span class="annottext">queryParam :: Text -&gt; Maybe a -&gt; Option scheme
</span><a href="#local-6989586621679213383"><span class="hs-identifier hs-var hs-var hs-var hs-var">queryParam</span></a></span></span><span> </span><span id="local-6989586621679213382"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679213382"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679213381"><span class="annot"><span class="annottext">mvalue :: Maybe a
</span><a href="#local-6989586621679213381"><span class="hs-identifier hs-var">mvalue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1317"></span><span>    </span><span class="annot"><span class="annottext">([(Text, Maybe Text)] -&gt; [(Text, Maybe Text)]) -&gt; Option scheme
forall (scheme :: Scheme).
([(Text, Maybe Text)] -&gt; [(Text, Maybe Text)]) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withQueryParams"><span class="hs-identifier hs-var">withQueryParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679213382"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToHttpApiData a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toQueryParam</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Text) -&gt; Maybe a -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679213381"><span class="hs-identifier hs-var">mvalue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1318"></span><span>
</span><span id="line-1319"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1320"></span><span class="hs-comment">-- Request&#8212;Optional parameters&#8212;Headers</span><span>
</span><span id="line-1321"></span><span>
</span><span id="line-1322"></span><span class="hs-comment">-- | Create an 'Option' that adds a header. Note that if you 'mappend' two</span><span>
</span><span id="line-1323"></span><span class="hs-comment">-- headers with the same names the leftmost header will win. This means, in</span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- particular, that you cannot create a request with several headers of the</span><span>
</span><span id="line-1325"></span><span class="hs-comment">-- same name.</span><span>
</span><span id="line-1326"></span><span id="local-6989586621679214439"><span class="annot"><a href="Network.HTTP.Req.html#header"><span class="hs-identifier hs-type">header</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1327"></span><span>  </span><span class="hs-comment">-- | Header name</span><span>
</span><span id="line-1328"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1329"></span><span>  </span><span class="hs-comment">-- | Header value</span><span>
</span><span id="line-1330"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1331"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214439"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1332"></span><span id="header"><span class="annot"><span class="annottext">header :: ByteString -&gt; ByteString -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#header"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679213380"><span class="annot"><span class="annottext">name :: ByteString
</span><a href="#local-6989586621679213380"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679213379"><span class="annot"><span class="annottext">value :: ByteString
</span><a href="#local-6989586621679213379"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var">withRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Request -&gt; Request
</span><a href="Network.HTTP.Req.html#attachHeader"><span class="hs-identifier hs-var">attachHeader</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213380"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213379"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1333"></span><span>
</span><span id="line-1334"></span><span class="hs-comment">-- | Attach a header with given name and content to a 'L.Request'.</span><span>
</span><span id="line-1335"></span><span class="hs-comment">--</span><span>
</span><span id="line-1336"></span><span class="hs-comment">-- @since 1.1.0</span><span>
</span><span id="line-1337"></span><span class="annot"><a href="Network.HTTP.Req.html#attachHeader"><span class="hs-identifier hs-type">attachHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span>
</span><span id="line-1338"></span><span id="attachHeader"><span class="annot"><span class="annottext">attachHeader :: ByteString -&gt; ByteString -&gt; Request -&gt; Request
</span><a href="Network.HTTP.Req.html#attachHeader"><span class="hs-identifier hs-var hs-var">attachHeader</span></a></span></span><span> </span><span id="local-6989586621679213378"><span class="annot"><span class="annottext">name :: ByteString
</span><a href="#local-6989586621679213378"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679213377"><span class="annot"><span class="annottext">value :: ByteString
</span><a href="#local-6989586621679213377"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679213376"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213376"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1339"></span><span>  </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213376"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">requestHeaders :: RequestHeaders
</span><span class="hs-identifier hs-var">L.requestHeaders</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; HeaderName
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213378"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213377"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HeaderName, ByteString) -&gt; RequestHeaders -&gt; RequestHeaders
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; RequestHeaders
</span><span class="hs-identifier hs-var hs-var">L.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213376"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1340"></span><span>
</span><span id="line-1341"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1342"></span><span class="hs-comment">-- Request&#8212;Optional parameters&#8212;Cookies</span><span>
</span><span id="line-1343"></span><span>
</span><span id="line-1344"></span><span class="hs-comment">-- $cookies</span><span>
</span><span id="line-1345"></span><span class="hs-comment">--</span><span>
</span><span id="line-1346"></span><span class="hs-comment">-- Support for cookies is quite minimalistic at the moment. It's possible to</span><span>
</span><span id="line-1347"></span><span class="hs-comment">-- specify which cookies to send using 'cookieJar' and inspect 'L.Response'</span><span>
</span><span id="line-1348"></span><span class="hs-comment">-- to extract 'L.CookieJar' from it (see 'responseCookieJar').</span><span>
</span><span id="line-1349"></span><span>
</span><span id="line-1350"></span><span class="hs-comment">-- | Use the given 'L.CookieJar'. A 'L.CookieJar' can be obtained from a</span><span>
</span><span id="line-1351"></span><span class="hs-comment">-- 'L.Response' record.</span><span>
</span><span id="line-1352"></span><span id="local-6989586621679213374"><span class="annot"><a href="Network.HTTP.Req.html#cookieJar"><span class="hs-identifier hs-type">cookieJar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.CookieJar</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213374"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1353"></span><span id="cookieJar"><span class="annot"><span class="annottext">cookieJar :: CookieJar -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#cookieJar"><span class="hs-identifier hs-var hs-var">cookieJar</span></a></span></span><span> </span><span id="local-6989586621679213373"><span class="annot"><span class="annottext">jar :: CookieJar
</span><a href="#local-6989586621679213373"><span class="hs-identifier hs-var">jar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var">withRequest</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Option scheme)
-&gt; (Request -&gt; Request) -&gt; Option scheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213372"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213372"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1354"></span><span>  </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213372"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cookieJar :: Maybe CookieJar
</span><span class="hs-identifier hs-var">L.cookieJar</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CookieJar -&gt; Maybe CookieJar
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CookieJar
</span><a href="#local-6989586621679213373"><span class="hs-identifier hs-var">jar</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1355"></span><span>
</span><span id="line-1356"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1357"></span><span class="hs-comment">-- Request&#8212;Optional parameters&#8212;Authentication</span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span class="hs-comment">-- $authentication</span><span>
</span><span id="line-1360"></span><span class="hs-comment">--</span><span>
</span><span id="line-1361"></span><span class="hs-comment">-- This section provides the common authentication helpers in the form of</span><span>
</span><span id="line-1362"></span><span class="hs-comment">-- 'Option's. You should always prefer the provided authentication 'Option's</span><span>
</span><span id="line-1363"></span><span class="hs-comment">-- to manual construction of headers because it ensures that you only use</span><span>
</span><span id="line-1364"></span><span class="hs-comment">-- one authentication method at a time (they overwrite each other) and</span><span>
</span><span id="line-1365"></span><span class="hs-comment">-- provides additional type safety that prevents leaking of credentials in</span><span>
</span><span id="line-1366"></span><span class="hs-comment">-- the cases when authentication relies on HTTPS for encrypting sensitive</span><span>
</span><span id="line-1367"></span><span class="hs-comment">-- data.</span><span>
</span><span id="line-1368"></span><span>
</span><span id="line-1369"></span><span class="hs-comment">-- | The 'Option' adds basic authentication.</span><span>
</span><span id="line-1370"></span><span class="hs-comment">--</span><span>
</span><span id="line-1371"></span><span class="hs-comment">-- See also: &lt;https://en.wikipedia.org/wiki/Basic_access_authentication&gt;.</span><span>
</span><span id="line-1372"></span><span class="annot"><a href="Network.HTTP.Req.html#basicAuth"><span class="hs-identifier hs-type">basicAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1373"></span><span>  </span><span class="hs-comment">-- | Username</span><span>
</span><span id="line-1374"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1375"></span><span>  </span><span class="hs-comment">-- | Password</span><span>
</span><span id="line-1376"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1377"></span><span>  </span><span class="hs-comment">-- | Auth 'Option'</span><span>
</span><span id="line-1378"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span>
</span><span id="line-1379"></span><span id="basicAuth"><span class="annot"><span class="annottext">basicAuth :: ByteString -&gt; ByteString -&gt; Option 'Https
</span><a href="Network.HTTP.Req.html#basicAuth"><span class="hs-identifier hs-var hs-var">basicAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Option 'Https
forall (scheme :: Scheme).
ByteString -&gt; ByteString -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#basicAuthUnsafe"><span class="hs-identifier hs-var">basicAuthUnsafe</span></a></span><span>
</span><span id="line-1380"></span><span>
</span><span id="line-1381"></span><span class="hs-comment">-- | An alternative to 'basicAuth' which works for any scheme. Note that</span><span>
</span><span id="line-1382"></span><span class="hs-comment">-- using basic access authentication without SSL\/TLS is vulnerable to</span><span>
</span><span id="line-1383"></span><span class="hs-comment">-- attacks. Use 'basicAuth' instead unless you know what you are doing.</span><span>
</span><span id="line-1384"></span><span class="hs-comment">--</span><span>
</span><span id="line-1385"></span><span class="hs-comment">-- @since 0.3.1</span><span>
</span><span id="line-1386"></span><span id="local-6989586621679213370"><span class="annot"><a href="Network.HTTP.Req.html#basicAuthUnsafe"><span class="hs-identifier hs-type">basicAuthUnsafe</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1387"></span><span>  </span><span class="hs-comment">-- | Username</span><span>
</span><span id="line-1388"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1389"></span><span>  </span><span class="hs-comment">-- | Password</span><span>
</span><span id="line-1390"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1391"></span><span>  </span><span class="hs-comment">-- | Auth 'Option'</span><span>
</span><span id="line-1392"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213370"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1393"></span><span id="basicAuthUnsafe"><span class="annot"><span class="annottext">basicAuthUnsafe :: ByteString -&gt; ByteString -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#basicAuthUnsafe"><span class="hs-identifier hs-var hs-var">basicAuthUnsafe</span></a></span></span><span> </span><span id="local-6989586621679213369"><span class="annot"><span class="annottext">username :: ByteString
</span><a href="#local-6989586621679213369"><span class="hs-identifier hs-var">username</span></a></span></span><span> </span><span id="local-6989586621679213368"><span class="annot"><span class="annottext">password :: ByteString
</span><a href="#local-6989586621679213368"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1394"></span><span>  </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#customAuth"><span class="hs-identifier hs-var">customAuth</span></a></span><span>
</span><span id="line-1395"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request)
-&gt; (Request -&gt; Request) -&gt; Request -&gt; IO Request
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">L.applyBasicAuth</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213369"><span class="hs-identifier hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213368"><span class="hs-identifier hs-var">password</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1396"></span><span>
</span><span id="line-1397"></span><span class="hs-comment">-- | The 'Option' set basic proxy authentication header.</span><span>
</span><span id="line-1398"></span><span class="hs-comment">--</span><span>
</span><span id="line-1399"></span><span class="hs-comment">-- @since 1.1.0</span><span>
</span><span id="line-1400"></span><span id="local-6989586621679213366"><span class="annot"><a href="Network.HTTP.Req.html#basicProxyAuth"><span class="hs-identifier hs-type">basicProxyAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1401"></span><span>  </span><span class="hs-comment">-- | Username</span><span>
</span><span id="line-1402"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1403"></span><span>  </span><span class="hs-comment">-- | Password</span><span>
</span><span id="line-1404"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1405"></span><span>  </span><span class="hs-comment">-- | Auth 'Option'</span><span>
</span><span id="line-1406"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213366"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1407"></span><span id="basicProxyAuth"><span class="annot"><span class="annottext">basicProxyAuth :: ByteString -&gt; ByteString -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#basicProxyAuth"><span class="hs-identifier hs-var hs-var">basicProxyAuth</span></a></span></span><span> </span><span id="local-6989586621679213365"><span class="annot"><span class="annottext">username :: ByteString
</span><a href="#local-6989586621679213365"><span class="hs-identifier hs-var">username</span></a></span></span><span> </span><span id="local-6989586621679213364"><span class="annot"><span class="annottext">password :: ByteString
</span><a href="#local-6989586621679213364"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1408"></span><span>  </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var">withRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">L.applyBasicProxyAuth</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213365"><span class="hs-identifier hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213364"><span class="hs-identifier hs-var">password</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1409"></span><span>
</span><span id="line-1410"></span><span class="hs-comment">-- | The 'Option' adds OAuth1 authentication.</span><span>
</span><span id="line-1411"></span><span class="hs-comment">--</span><span>
</span><span id="line-1412"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1413"></span><span id="local-6989586621679213362"><span class="annot"><a href="Network.HTTP.Req.html#oAuth1"><span class="hs-identifier hs-type">oAuth1</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-comment">-- | Consumer token</span><span>
</span><span id="line-1415"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1416"></span><span>  </span><span class="hs-comment">-- | Consumer secret</span><span>
</span><span id="line-1417"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1418"></span><span>  </span><span class="hs-comment">-- | OAuth token</span><span>
</span><span id="line-1419"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1420"></span><span>  </span><span class="hs-comment">-- | OAuth token secret</span><span>
</span><span id="line-1421"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1422"></span><span>  </span><span class="hs-comment">-- | Auth 'Option'</span><span>
</span><span id="line-1423"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213362"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1424"></span><span id="oAuth1"><span class="annot"><span class="annottext">oAuth1 :: ByteString
-&gt; ByteString -&gt; ByteString -&gt; ByteString -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#oAuth1"><span class="hs-identifier hs-var hs-var">oAuth1</span></a></span></span><span> </span><span id="local-6989586621679213361"><span class="annot"><span class="annottext">consumerToken :: ByteString
</span><a href="#local-6989586621679213361"><span class="hs-identifier hs-var">consumerToken</span></a></span></span><span> </span><span id="local-6989586621679213360"><span class="annot"><span class="annottext">consumerSecret :: ByteString
</span><a href="#local-6989586621679213360"><span class="hs-identifier hs-var">consumerSecret</span></a></span></span><span> </span><span id="local-6989586621679213359"><span class="annot"><span class="annottext">token :: ByteString
</span><a href="#local-6989586621679213359"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span id="local-6989586621679213358"><span class="annot"><span class="annottext">tokenSecret :: ByteString
</span><a href="#local-6989586621679213358"><span class="hs-identifier hs-var">tokenSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1425"></span><span>  </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#customAuth"><span class="hs-identifier hs-var">customAuth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; Request -&gt; IO Request
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth -&gt; Credential -&gt; Request -&gt; m Request
</span><span class="hs-identifier hs-var">OAuth.signOAuth</span></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679213356"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679213355"><span class="hs-identifier hs-var">creds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1426"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1427"></span><span>    </span><span id="local-6989586621679213356"><span class="annot"><span class="annottext">app :: OAuth
</span><a href="#local-6989586621679213356"><span class="hs-identifier hs-var hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1428"></span><span>      </span><span class="annot"><span class="annottext">OAuth
</span><span class="hs-identifier hs-var">OAuth.newOAuth</span></span><span>
</span><span id="line-1429"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">oauthConsumerKey :: ByteString
</span><span class="hs-identifier hs-var">OAuth.oauthConsumerKey</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213361"><span class="hs-identifier hs-var">consumerToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1430"></span><span>          </span><span class="annot"><span class="annottext">oauthConsumerSecret :: ByteString
</span><span class="hs-identifier hs-var">OAuth.oauthConsumerSecret</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213360"><span class="hs-identifier hs-var">consumerSecret</span></a></span><span>
</span><span id="line-1431"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1432"></span><span>    </span><span id="local-6989586621679213355"><span class="annot"><span class="annottext">creds :: Credential
</span><a href="#local-6989586621679213355"><span class="hs-identifier hs-var hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential
</span><span class="hs-identifier hs-var">OAuth.newCredential</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213359"><span class="hs-identifier hs-var">token</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213358"><span class="hs-identifier hs-var">tokenSecret</span></a></span><span>
</span><span id="line-1433"></span><span>
</span><span id="line-1434"></span><span class="hs-comment">-- | The 'Option' adds an OAuth2 bearer token. This is treated by many</span><span>
</span><span id="line-1435"></span><span class="hs-comment">-- services as the equivalent of a username and password.</span><span>
</span><span id="line-1436"></span><span class="hs-comment">--</span><span>
</span><span id="line-1437"></span><span class="hs-comment">-- The 'Option' is defined as:</span><span>
</span><span id="line-1438"></span><span class="hs-comment">--</span><span>
</span><span id="line-1439"></span><span class="hs-comment">-- &gt; oAuth2Bearer token = header &quot;Authorization&quot; (&quot;Bearer &quot; &lt;&gt; token)</span><span>
</span><span id="line-1440"></span><span class="hs-comment">--</span><span>
</span><span id="line-1441"></span><span class="hs-comment">-- See also: &lt;https://en.wikipedia.org/wiki/OAuth&gt;.</span><span>
</span><span id="line-1442"></span><span class="annot"><a href="Network.HTTP.Req.html#oAuth2Bearer"><span class="hs-identifier hs-type">oAuth2Bearer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1443"></span><span>  </span><span class="hs-comment">-- | Token</span><span>
</span><span id="line-1444"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1445"></span><span>  </span><span class="hs-comment">-- | Auth 'Option'</span><span>
</span><span id="line-1446"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span>
</span><span id="line-1447"></span><span id="oAuth2Bearer"><span class="annot"><span class="annottext">oAuth2Bearer :: ByteString -&gt; Option 'Https
</span><a href="Network.HTTP.Req.html#oAuth2Bearer"><span class="hs-identifier hs-var hs-var">oAuth2Bearer</span></a></span></span><span> </span><span id="local-6989586621679213350"><span class="annot"><span class="annottext">token :: ByteString
</span><a href="#local-6989586621679213350"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1448"></span><span>  </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Option 'Https
forall (scheme :: Scheme). (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#customAuth"><span class="hs-identifier hs-var">customAuth</span></a></span><span>
</span><span id="line-1449"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request)
-&gt; (Request -&gt; Request) -&gt; Request -&gt; IO Request
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Request -&gt; Request
</span><a href="Network.HTTP.Req.html#attachHeader"><span class="hs-identifier hs-var">attachHeader</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Authorization&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Bearer &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213350"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1450"></span><span>
</span><span id="line-1451"></span><span class="hs-comment">-- | The 'Option' adds a not-quite-standard OAuth2 bearer token (that seems</span><span>
</span><span id="line-1452"></span><span class="hs-comment">-- to be used only by GitHub). This will be treated by whatever services</span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- accept it as the equivalent of a username and password.</span><span>
</span><span id="line-1454"></span><span class="hs-comment">--</span><span>
</span><span id="line-1455"></span><span class="hs-comment">-- The 'Option' is defined as:</span><span>
</span><span id="line-1456"></span><span class="hs-comment">--</span><span>
</span><span id="line-1457"></span><span class="hs-comment">-- &gt; oAuth2Token token = header &quot;Authorization&quot; (&quot;token&quot; &lt;&gt; token)</span><span>
</span><span id="line-1458"></span><span class="hs-comment">--</span><span>
</span><span id="line-1459"></span><span class="hs-comment">-- See also: &lt;https://developer.github.com/v3/oauth#3-use-the-access-token-to-access-the-api&gt;.</span><span>
</span><span id="line-1460"></span><span class="annot"><a href="Network.HTTP.Req.html#oAuth2Token"><span class="hs-identifier hs-type">oAuth2Token</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1461"></span><span>  </span><span class="hs-comment">-- | Token</span><span>
</span><span id="line-1462"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1463"></span><span>  </span><span class="hs-comment">-- | Auth 'Option'</span><span>
</span><span id="line-1464"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-type">Https</span></a></span><span>
</span><span id="line-1465"></span><span id="oAuth2Token"><span class="annot"><span class="annottext">oAuth2Token :: ByteString -&gt; Option 'Https
</span><a href="Network.HTTP.Req.html#oAuth2Token"><span class="hs-identifier hs-var hs-var">oAuth2Token</span></a></span></span><span> </span><span id="local-6989586621679213349"><span class="annot"><span class="annottext">token :: ByteString
</span><a href="#local-6989586621679213349"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1466"></span><span>  </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Option 'Https
forall (scheme :: Scheme). (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#customAuth"><span class="hs-identifier hs-var">customAuth</span></a></span><span>
</span><span id="line-1467"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request)
-&gt; (Request -&gt; Request) -&gt; Request -&gt; IO Request
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Request -&gt; Request
</span><a href="Network.HTTP.Req.html#attachHeader"><span class="hs-identifier hs-var">attachHeader</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Authorization&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;token &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213349"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1468"></span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- | A helper to create custom authentication 'Option's. The given</span><span>
</span><span id="line-1470"></span><span class="hs-comment">-- 'IO'-enabled request transformation is applied after all other</span><span>
</span><span id="line-1471"></span><span class="hs-comment">-- modifications when constructing a request. Use wisely.</span><span>
</span><span id="line-1472"></span><span class="hs-comment">--</span><span>
</span><span id="line-1473"></span><span class="hs-comment">-- @since 1.1.0</span><span>
</span><span id="line-1474"></span><span id="local-6989586621679214031"><span class="annot"><a href="Network.HTTP.Req.html#customAuth"><span class="hs-identifier hs-type">customAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214031"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1475"></span><span id="customAuth"><span class="annot"><span class="annottext">customAuth :: (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#customAuth"><span class="hs-identifier hs-var hs-var">customAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
forall (scheme :: Scheme).
Endo ([(Text, Maybe Text)], Request)
-&gt; Maybe (Request -&gt; IO Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="annot"><span class="annottext">Endo ([(Text, Maybe Text)], Request)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Request -&gt; IO Request) -&gt; Option scheme)
-&gt; ((Request -&gt; IO Request) -&gt; Maybe (Request -&gt; IO Request))
-&gt; (Request -&gt; IO Request)
-&gt; Option scheme
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Maybe (Request -&gt; IO Request)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-1476"></span><span>
</span><span id="line-1477"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1478"></span><span class="hs-comment">-- Request&#8212;Optional parameters&#8212;Other</span><span>
</span><span id="line-1479"></span><span>
</span><span id="line-1480"></span><span class="hs-comment">-- | Specify the port to connect to explicitly. Normally, 'Url' you use</span><span>
</span><span id="line-1481"></span><span class="hs-comment">-- determines the default port: @80@ for HTTP and @443@ for HTTPS. This</span><span>
</span><span id="line-1482"></span><span class="hs-comment">-- 'Option' allows to choose an arbitrary port overwriting the defaults.</span><span>
</span><span id="line-1483"></span><span id="local-6989586621679214101"><span class="annot"><a href="Network.HTTP.Req.html#port"><span class="hs-identifier hs-type">port</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214101"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1484"></span><span id="port"><span class="annot"><span class="annottext">port :: Int -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#port"><span class="hs-identifier hs-var hs-var">port</span></a></span></span><span> </span><span id="local-6989586621679213348"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679213348"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var">withRequest</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Option scheme)
-&gt; (Request -&gt; Request) -&gt; Option scheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213347"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213347"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1485"></span><span>  </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213347"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">port :: Int
</span><span class="hs-identifier hs-var">L.port</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213348"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1486"></span><span>
</span><span id="line-1487"></span><span class="hs-comment">-- | This 'Option' controls whether gzipped data should be decompressed on</span><span>
</span><span id="line-1488"></span><span class="hs-comment">-- the fly. By default everything except for @\&quot;application\/x-tar\&quot;@ is</span><span>
</span><span id="line-1489"></span><span class="hs-comment">-- decompressed, i.e. we have:</span><span>
</span><span id="line-1490"></span><span class="hs-comment">--</span><span>
</span><span id="line-1491"></span><span class="hs-comment">-- &gt; decompress (/= &quot;application/x-tar&quot;)</span><span>
</span><span id="line-1492"></span><span class="hs-comment">--</span><span>
</span><span id="line-1493"></span><span class="hs-comment">-- You can also choose to decompress everything like this:</span><span>
</span><span id="line-1494"></span><span class="hs-comment">--</span><span>
</span><span id="line-1495"></span><span class="hs-comment">-- &gt; decompress (const True)</span><span>
</span><span id="line-1496"></span><span id="local-6989586621679213346"><span class="annot"><a href="Network.HTTP.Req.html#decompress"><span class="hs-identifier hs-type">decompress</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1497"></span><span>  </span><span class="hs-comment">-- | Predicate that is given MIME type, it</span><span>
</span><span id="line-1498"></span><span>  </span><span class="hs-comment">-- returns 'True' when content should be decompressed on the fly.</span><span>
</span><span id="line-1499"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1500"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213346"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1501"></span><span id="decompress"><span class="annot"><span class="annottext">decompress :: (ByteString -&gt; Bool) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#decompress"><span class="hs-identifier hs-var hs-var">decompress</span></a></span></span><span> </span><span id="local-6989586621679213345"><span class="annot"><span class="annottext">f :: ByteString -&gt; Bool
</span><a href="#local-6989586621679213345"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var">withRequest</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Option scheme)
-&gt; (Request -&gt; Request) -&gt; Option scheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213344"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213344"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1502"></span><span>  </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213344"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">decompress :: ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">L.decompress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="#local-6989586621679213345"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1503"></span><span>
</span><span id="line-1504"></span><span class="hs-comment">-- | Specify the number of microseconds to wait for response. The default</span><span>
</span><span id="line-1505"></span><span class="hs-comment">-- value is 30 seconds (defined in 'L.ManagerSettings' of connection</span><span>
</span><span id="line-1506"></span><span class="hs-comment">-- 'L.Manager').</span><span>
</span><span id="line-1507"></span><span id="local-6989586621679213342"><span class="annot"><a href="Network.HTTP.Req.html#responseTimeout"><span class="hs-identifier hs-type">responseTimeout</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1508"></span><span>  </span><span class="hs-comment">-- | Number of microseconds to wait</span><span>
</span><span id="line-1509"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1510"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213342"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1511"></span><span id="responseTimeout"><span class="annot"><span class="annottext">responseTimeout :: Int -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#responseTimeout"><span class="hs-identifier hs-var hs-var">responseTimeout</span></a></span></span><span> </span><span id="local-6989586621679213341"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679213341"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var">withRequest</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Option scheme)
-&gt; (Request -&gt; Request) -&gt; Option scheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213340"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213340"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1512"></span><span>  </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213340"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">responseTimeout :: ResponseTimeout
</span><span class="hs-identifier hs-var">L.responseTimeout</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ResponseTimeout
</span><span class="hs-identifier hs-var">LI.ResponseTimeoutMicro</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213341"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1513"></span><span>
</span><span id="line-1514"></span><span class="hs-comment">-- | HTTP version to send to the server, the default is HTTP 1.1.</span><span>
</span><span id="line-1515"></span><span id="local-6989586621679213337"><span class="annot"><a href="Network.HTTP.Req.html#httpVersion"><span class="hs-identifier hs-type">httpVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1516"></span><span>  </span><span class="hs-comment">-- | Major version number</span><span>
</span><span id="line-1517"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1518"></span><span>  </span><span class="hs-comment">-- | Minor version number</span><span>
</span><span id="line-1519"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1520"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213337"><span class="hs-identifier hs-type">scheme</span></a></span></span><span>
</span><span id="line-1521"></span><span id="httpVersion"><span class="annot"><span class="annottext">httpVersion :: Int -&gt; Int -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#httpVersion"><span class="hs-identifier hs-var hs-var">httpVersion</span></a></span></span><span> </span><span id="local-6989586621679213336"><span class="annot"><span class="annottext">major :: Int
</span><a href="#local-6989586621679213336"><span class="hs-identifier hs-var">major</span></a></span></span><span> </span><span id="local-6989586621679213335"><span class="annot"><span class="annottext">minor :: Int
</span><a href="#local-6989586621679213335"><span class="hs-identifier hs-var">minor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Option scheme
forall (scheme :: Scheme). (Request -&gt; Request) -&gt; Option scheme
</span><a href="Network.HTTP.Req.html#withRequest"><span class="hs-identifier hs-var">withRequest</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; Option scheme)
-&gt; (Request -&gt; Request) -&gt; Option scheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679213334"><span class="annot"><span class="annottext">x :: Request
</span><a href="#local-6989586621679213334"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1522"></span><span>  </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679213334"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">requestVersion :: HttpVersion
</span><span class="hs-identifier hs-var">L.requestVersion</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; HttpVersion
</span><span class="hs-identifier hs-var">Y.HttpVersion</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213336"><span class="hs-identifier hs-var">major</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213335"><span class="hs-identifier hs-var">minor</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1523"></span><span>
</span><span id="line-1524"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1525"></span><span class="hs-comment">-- Response interpretations</span><span>
</span><span id="line-1526"></span><span>
</span><span id="line-1527"></span><span class="hs-comment">-- | Make a request and ignore the body of the response.</span><span>
</span><span id="line-1528"></span><span class="hs-keyword">newtype</span><span> </span><span id="IgnoreResponse"><span class="annot"><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier hs-var">IgnoreResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IgnoreResponse"><span class="annot"><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier hs-var">IgnoreResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1529"></span><span>
</span><span id="line-1530"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213327"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier hs-type">IgnoreResponse</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1531"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="HttpResponseBody"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponseBody"><span class="hs-identifier hs-var">HttpResponseBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier hs-type">IgnoreResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1532"></span><span>  </span><span id="local-6989586621679213325"><span class="annot"><span class="annottext">toVanillaResponse :: IgnoreResponse -&gt; Response (HttpResponseBody IgnoreResponse)
</span><a href="Network.HTTP.Req.html#toVanillaResponse"><span class="hs-identifier hs-var hs-var hs-var hs-var">toVanillaResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier hs-type">IgnoreResponse</span></a></span><span> </span><span id="local-6989586621679213323"><span class="annot"><span class="annottext">r :: Response ()
</span><a href="#local-6989586621679213323"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ()
Response (HttpResponseBody IgnoreResponse)
</span><a href="#local-6989586621679213323"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1533"></span><span>  </span><span id="local-6989586621679213322"><span class="annot"><span class="annottext">getHttpResponse :: Response BodyReader -&gt; IO IgnoreResponse
</span><a href="#local-6989586621679213322"><span class="hs-identifier hs-var hs-var hs-var hs-var">getHttpResponse</span></a></span></span><span> </span><span id="local-6989586621679213321"><span class="annot"><span class="annottext">r :: Response BodyReader
</span><a href="#local-6989586621679213321"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IgnoreResponse -&gt; IO IgnoreResponse
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(IgnoreResponse -&gt; IO IgnoreResponse)
-&gt; IgnoreResponse -&gt; IO IgnoreResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response () -&gt; IgnoreResponse
</span><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier hs-var">IgnoreResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response BodyReader -&gt; Response ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213321"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1534"></span><span>
</span><span id="line-1535"></span><span class="hs-comment">-- | Use this as the fourth argument of 'req' to specify that you want it to</span><span>
</span><span id="line-1536"></span><span class="hs-comment">-- ignore the response body.</span><span>
</span><span id="line-1537"></span><span class="annot"><a href="Network.HTTP.Req.html#ignoreResponse"><span class="hs-identifier hs-type">ignoreResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#IgnoreResponse"><span class="hs-identifier hs-type">IgnoreResponse</span></a></span><span>
</span><span id="line-1538"></span><span id="ignoreResponse"><span class="annot"><span class="annottext">ignoreResponse :: Proxy IgnoreResponse
</span><a href="Network.HTTP.Req.html#ignoreResponse"><span class="hs-identifier hs-var hs-var">ignoreResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy IgnoreResponse
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-1539"></span><span>
</span><span id="line-1540"></span><span class="hs-comment">-- | Make a request and interpret the body of the response as JSON. The</span><span>
</span><span id="line-1541"></span><span class="hs-comment">-- 'handleHttpException' method of 'MonadHttp' instance corresponding to</span><span>
</span><span id="line-1542"></span><span class="hs-comment">-- monad in which you use 'req' will determine what to do in the case when</span><span>
</span><span id="line-1543"></span><span class="hs-comment">-- parsing fails (the 'JsonHttpException' constructor will be used).</span><span>
</span><span id="line-1544"></span><span class="hs-keyword">newtype</span><span> </span><span id="JsonResponse"><span class="annot"><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier hs-var">JsonResponse</span></a></span></span><span> </span><span id="local-6989586621679214011"><span class="annot"><a href="#local-6989586621679214011"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JsonResponse"><span class="annot"><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier hs-var">JsonResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><a href="#local-6989586621679214011"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1545"></span><span>
</span><span id="line-1546"></span><span id="local-6989586621679213319"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679213319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier hs-type">JsonResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213319"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1547"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="HttpResponseBody"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponseBody"><span class="hs-identifier hs-var">HttpResponseBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier hs-type">JsonResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213319"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679213319"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1548"></span><span>  </span><span id="local-6989586621679213315"><span class="annot"><span class="annottext">toVanillaResponse :: JsonResponse a -&gt; Response (HttpResponseBody (JsonResponse a))
</span><a href="#local-6989586621679213315"><span class="hs-identifier hs-var hs-var hs-var hs-var">toVanillaResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier hs-type">JsonResponse</span></a></span><span> </span><span id="local-6989586621679213314"><span class="annot"><span class="annottext">r :: Response a
</span><a href="#local-6989586621679213314"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response a
Response (HttpResponseBody (JsonResponse a))
</span><a href="#local-6989586621679213314"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1549"></span><span>  </span><span id="local-6989586621679213313"><span class="annot"><span class="annottext">getHttpResponse :: Response BodyReader -&gt; IO (JsonResponse a)
</span><a href="#local-6989586621679213313"><span class="hs-identifier hs-var hs-var hs-var hs-var">getHttpResponse</span></a></span></span><span> </span><span id="local-6989586621679213312"><span class="annot"><span class="annottext">r :: Response BodyReader
</span><a href="#local-6989586621679213312"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1550"></span><span>    </span><span id="local-6989586621679213311"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679213311"><span class="hs-identifier hs-var">chunks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BodyReader -&gt; IO [ByteString]
</span><span class="hs-identifier hs-var">L.brConsume</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response BodyReader -&gt; BodyReader
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">L.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213312"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1551"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String a
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">A.eitherDecode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromChunks</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679213311"><span class="hs-identifier hs-var">chunks</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1552"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679213306"><span class="annot"><span class="annottext">e :: String
</span><a href="#local-6989586621679213306"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; IO (JsonResponse a)
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; HttpException
</span><a href="Network.HTTP.Req.html#JsonHttpException"><span class="hs-identifier hs-var">JsonHttpException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679213306"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1553"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679213304"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679213304"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JsonResponse a -&gt; IO (JsonResponse a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(JsonResponse a -&gt; IO (JsonResponse a))
-&gt; JsonResponse a -&gt; IO (JsonResponse a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response a -&gt; JsonResponse a
forall a. Response a -&gt; JsonResponse a
</span><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier hs-var">JsonResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679213304"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Response BodyReader -&gt; Response a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213312"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1554"></span><span>  </span><span id="local-6989586621679213302"><span class="annot"><span class="annottext">acceptHeader :: Proxy (JsonResponse a) -&gt; Maybe ByteString
</span><a href="#local-6989586621679213302"><span class="hs-identifier hs-var hs-var hs-var hs-var">acceptHeader</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="hs-string">&quot;application/json&quot;</span></span></span><span>
</span><span id="line-1555"></span><span>
</span><span id="line-1556"></span><span class="hs-comment">-- | Use this as the fourth argument of 'req' to specify that you want it to</span><span>
</span><span id="line-1557"></span><span class="hs-comment">-- return the 'JsonResponse' interpretation.</span><span>
</span><span id="line-1558"></span><span id="local-6989586621679213301"><span class="annot"><a href="Network.HTTP.Req.html#jsonResponse"><span class="hs-identifier hs-type">jsonResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#JsonResponse"><span class="hs-identifier hs-type">JsonResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213301"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1559"></span><span id="jsonResponse"><span class="annot"><span class="annottext">jsonResponse :: Proxy (JsonResponse a)
</span><a href="Network.HTTP.Req.html#jsonResponse"><span class="hs-identifier hs-var hs-var">jsonResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (JsonResponse a)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-1560"></span><span>
</span><span id="line-1561"></span><span class="hs-comment">-- | Make a request and interpret the body of the response as a strict</span><span>
</span><span id="line-1562"></span><span class="hs-comment">-- 'ByteString'.</span><span>
</span><span id="line-1563"></span><span class="hs-keyword">newtype</span><span> </span><span id="BsResponse"><span class="annot"><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier hs-var">BsResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BsResponse"><span class="annot"><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier hs-var">BsResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-1564"></span><span>
</span><span id="line-1565"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213296"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier hs-type">BsResponse</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1566"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="HttpResponseBody"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponseBody"><span class="hs-identifier hs-var">HttpResponseBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier hs-type">BsResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-1567"></span><span>  </span><span id="local-6989586621679213295"><span class="annot"><span class="annottext">toVanillaResponse :: BsResponse -&gt; Response (HttpResponseBody BsResponse)
</span><a href="#local-6989586621679213295"><span class="hs-identifier hs-var hs-var hs-var hs-var">toVanillaResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier hs-type">BsResponse</span></a></span><span> </span><span id="local-6989586621679213294"><span class="annot"><span class="annottext">r :: Response ByteString
</span><a href="#local-6989586621679213294"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString
Response (HttpResponseBody BsResponse)
</span><a href="#local-6989586621679213294"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1568"></span><span>  </span><span id="local-6989586621679213293"><span class="annot"><span class="annottext">getHttpResponse :: Response BodyReader -&gt; IO BsResponse
</span><a href="#local-6989586621679213293"><span class="hs-identifier hs-var hs-var hs-var hs-var">getHttpResponse</span></a></span></span><span> </span><span id="local-6989586621679213292"><span class="annot"><span class="annottext">r :: Response BodyReader
</span><a href="#local-6989586621679213292"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1569"></span><span>    </span><span id="local-6989586621679213291"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679213291"><span class="hs-identifier hs-var">chunks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BodyReader -&gt; IO [ByteString]
</span><span class="hs-identifier hs-var">L.brConsume</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response BodyReader -&gt; BodyReader
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">L.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213292"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1570"></span><span>    </span><span class="annot"><span class="annottext">BsResponse -&gt; IO BsResponse
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(BsResponse -&gt; IO BsResponse) -&gt; BsResponse -&gt; IO BsResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; BsResponse
</span><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier hs-var">BsResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679213291"><span class="hs-identifier hs-var">chunks</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Response BodyReader -&gt; Response ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213292"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1571"></span><span>
</span><span id="line-1572"></span><span class="hs-comment">-- | Use this as the fourth argument of 'req' to specify that you want to</span><span>
</span><span id="line-1573"></span><span class="hs-comment">-- interpret the response body as a strict 'ByteString'.</span><span>
</span><span id="line-1574"></span><span class="annot"><a href="Network.HTTP.Req.html#bsResponse"><span class="hs-identifier hs-type">bsResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#BsResponse"><span class="hs-identifier hs-type">BsResponse</span></a></span><span>
</span><span id="line-1575"></span><span id="bsResponse"><span class="annot"><span class="annottext">bsResponse :: Proxy BsResponse
</span><a href="Network.HTTP.Req.html#bsResponse"><span class="hs-identifier hs-var hs-var">bsResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy BsResponse
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-1576"></span><span>
</span><span id="line-1577"></span><span class="hs-comment">-- | Make a request and interpret the body of the response as a lazy</span><span>
</span><span id="line-1578"></span><span class="hs-comment">-- 'BL.ByteString'.</span><span>
</span><span id="line-1579"></span><span class="hs-keyword">newtype</span><span> </span><span id="LbsResponse"><span class="annot"><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier hs-var">LbsResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LbsResponse"><span class="annot"><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier hs-var">LbsResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-1580"></span><span>
</span><span id="line-1581"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213285"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier hs-type">LbsResponse</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1582"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="HttpResponseBody"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponseBody"><span class="hs-identifier hs-var">HttpResponseBody</span></a></span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier hs-type">LbsResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span>
</span><span id="line-1583"></span><span>  </span><span id="local-6989586621679213284"><span class="annot"><span class="annottext">toVanillaResponse :: LbsResponse -&gt; Response (HttpResponseBody LbsResponse)
</span><a href="#local-6989586621679213284"><span class="hs-identifier hs-var hs-var hs-var hs-var">toVanillaResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier hs-type">LbsResponse</span></a></span><span> </span><span id="local-6989586621679213283"><span class="annot"><span class="annottext">r :: Response ByteString
</span><a href="#local-6989586621679213283"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString
Response (HttpResponseBody LbsResponse)
</span><a href="#local-6989586621679213283"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1584"></span><span>  </span><span id="local-6989586621679213282"><span class="annot"><span class="annottext">getHttpResponse :: Response BodyReader -&gt; IO LbsResponse
</span><a href="#local-6989586621679213282"><span class="hs-identifier hs-var hs-var hs-var hs-var">getHttpResponse</span></a></span></span><span> </span><span id="local-6989586621679213281"><span class="annot"><span class="annottext">r :: Response BodyReader
</span><a href="#local-6989586621679213281"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1585"></span><span>    </span><span id="local-6989586621679213280"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679213280"><span class="hs-identifier hs-var">chunks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BodyReader -&gt; IO [ByteString]
</span><span class="hs-identifier hs-var">L.brConsume</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response BodyReader -&gt; BodyReader
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">L.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213281"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1586"></span><span>    </span><span class="annot"><span class="annottext">LbsResponse -&gt; IO LbsResponse
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(LbsResponse -&gt; IO LbsResponse) -&gt; LbsResponse -&gt; IO LbsResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; LbsResponse
</span><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier hs-var">LbsResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromChunks</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679213280"><span class="hs-identifier hs-var">chunks</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Response BodyReader -&gt; Response ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213281"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1587"></span><span>
</span><span id="line-1588"></span><span class="hs-comment">-- | Use this as the fourth argument of 'req' to specify that you want to</span><span>
</span><span id="line-1589"></span><span class="hs-comment">-- interpret the response body as a lazy 'BL.ByteString'.</span><span>
</span><span id="line-1590"></span><span class="annot"><a href="Network.HTTP.Req.html#lbsResponse"><span class="hs-identifier hs-type">lbsResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#LbsResponse"><span class="hs-identifier hs-type">LbsResponse</span></a></span><span>
</span><span id="line-1591"></span><span id="lbsResponse"><span class="annot"><span class="annottext">lbsResponse :: Proxy LbsResponse
</span><a href="Network.HTTP.Req.html#lbsResponse"><span class="hs-identifier hs-var hs-var">lbsResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy LbsResponse
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-1592"></span><span>
</span><span id="line-1593"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1594"></span><span class="hs-comment">-- Helpers for response interpretations</span><span>
</span><span id="line-1595"></span><span>
</span><span id="line-1596"></span><span class="hs-comment">-- | Fetch beginning of response and return it together with new</span><span>
</span><span id="line-1597"></span><span class="hs-comment">-- @'L.Response' 'L.BodyReader'@ that can be passed to 'getHttpResponse' and</span><span>
</span><span id="line-1598"></span><span class="hs-comment">-- such.</span><span>
</span><span id="line-1599"></span><span class="annot"><a href="Network.HTTP.Req.html#grabPreview"><span class="hs-identifier hs-type">grabPreview</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1600"></span><span>  </span><span class="hs-comment">-- | How many bytes to fetch</span><span>
</span><span id="line-1601"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1602"></span><span>  </span><span class="hs-comment">-- | Response with body reader inside</span><span>
</span><span id="line-1603"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.BodyReader</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1604"></span><span>  </span><span class="hs-comment">-- | Preview 'ByteString' and new response with body reader inside</span><span>
</span><span id="line-1605"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.BodyReader</span></span><span class="hs-special">)</span><span>
</span><span id="line-1606"></span><span id="grabPreview"><span class="annot"><span class="annottext">grabPreview :: Int -&gt; Response BodyReader -&gt; IO (ByteString, Response BodyReader)
</span><a href="Network.HTTP.Req.html#grabPreview"><span class="hs-identifier hs-var hs-var">grabPreview</span></a></span></span><span> </span><span id="local-6989586621679213279"><span class="annot"><span class="annottext">nbytes :: Int
</span><a href="#local-6989586621679213279"><span class="hs-identifier hs-var">nbytes</span></a></span></span><span> </span><span id="local-6989586621679213278"><span class="annot"><span class="annottext">r :: Response BodyReader
</span><a href="#local-6989586621679213278"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1607"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213277"><span class="annot"><span class="annottext">br :: BodyReader
</span><a href="#local-6989586621679213277"><span class="hs-identifier hs-var hs-var">br</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response BodyReader -&gt; BodyReader
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">L.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213278"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1608"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679213276"><span class="annot"><span class="annottext">target :: ByteString
</span><a href="#local-6989586621679213276"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213275"><span class="annot"><span class="annottext">leftover :: ByteString
</span><a href="#local-6989586621679213275"><span class="hs-identifier hs-var">leftover</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213274"><span class="annot"><span class="annottext">done :: Bool
</span><a href="#local-6989586621679213274"><span class="hs-identifier hs-var">done</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BodyReader -&gt; Int -&gt; IO (ByteString, ByteString, Bool)
</span><a href="Network.HTTP.Req.html#brReadN"><span class="hs-identifier hs-var">brReadN</span></a></span><span> </span><span class="annot"><span class="annottext">BodyReader
</span><a href="#local-6989586621679213277"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213279"><span class="hs-identifier hs-var">nbytes</span></a></span><span>
</span><span id="line-1609"></span><span>  </span><span id="local-6989586621679213272"><span class="annot"><span class="annottext">IORef Int
</span><a href="#local-6989586621679213272"><span class="hs-identifier hs-var">nref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (IORef Int)
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1610"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213271"><span class="annot"><span class="annottext">br' :: BodyReader
</span><a href="#local-6989586621679213271"><span class="hs-identifier hs-var hs-var">br'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1611"></span><span>        </span><span id="local-6989586621679213270"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213270"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef Int -&gt; IO Int
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef Int
</span><a href="#local-6989586621679213272"><span class="hs-identifier hs-var">nref</span></a></span><span>
</span><span id="line-1612"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213269"><span class="annot"><span class="annottext">incn :: IO ()
</span><a href="#local-6989586621679213269"><span class="hs-identifier hs-var hs-var">incn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IORef Int -&gt; (Int -&gt; Int) -&gt; IO ()
forall a. IORef a -&gt; (a -&gt; a) -&gt; IO ()
</span><span class="hs-identifier hs-var">modifyIORef'</span></span><span> </span><span class="annot"><span class="annottext">IORef Int
</span><a href="#local-6989586621679213272"><span class="hs-identifier hs-var">nref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1613"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213270"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1614"></span><span>          </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1615"></span><span>            </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679213269"><span class="hs-identifier hs-var">incn</span></a></span><span>
</span><span id="line-1616"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">B.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213276"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-1617"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BodyReader
</span><a href="#local-6989586621679213271"><span class="hs-identifier hs-var">br'</span></a></span><span>
</span><span id="line-1618"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; BodyReader
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213276"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-1619"></span><span>          </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1620"></span><span>            </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679213269"><span class="hs-identifier hs-var">incn</span></a></span><span>
</span><span id="line-1621"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">B.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213275"><span class="hs-identifier hs-var">leftover</span></a></span><span>
</span><span id="line-1622"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BodyReader
</span><a href="#local-6989586621679213271"><span class="hs-identifier hs-var">br'</span></a></span><span>
</span><span id="line-1623"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; BodyReader
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213275"><span class="hs-identifier hs-var">leftover</span></a></span><span>
</span><span id="line-1624"></span><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1625"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679213274"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-1626"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; BodyReader
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">B.empty</span></span><span>
</span><span id="line-1627"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BodyReader
</span><a href="#local-6989586621679213277"><span class="hs-identifier hs-var">br</span></a></span><span>
</span><span id="line-1628"></span><span>  </span><span class="annot"><span class="annottext">(ByteString, Response BodyReader)
-&gt; IO (ByteString, Response BodyReader)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213276"><span class="hs-identifier hs-var">target</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Response BodyReader
</span><a href="#local-6989586621679213278"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">responseBody :: BodyReader
</span><span class="hs-identifier hs-var">L.responseBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BodyReader
</span><a href="#local-6989586621679213271"><span class="hs-identifier hs-var">br'</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1629"></span><span>
</span><span id="line-1630"></span><span class="hs-comment">-- | Consume N bytes from 'L.BodyReader', return the target chunk, the</span><span>
</span><span id="line-1631"></span><span class="hs-comment">-- leftover (may be empty), and whether we're done consuming the body.</span><span>
</span><span id="line-1632"></span><span class="annot"><a href="Network.HTTP.Req.html#brReadN"><span class="hs-identifier hs-type">brReadN</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1633"></span><span>  </span><span class="hs-comment">-- | Body reader to stream from</span><span>
</span><span id="line-1634"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">L.BodyReader</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1635"></span><span>  </span><span class="hs-comment">-- | How many bytes to consume</span><span>
</span><span id="line-1636"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1637"></span><span>  </span><span class="hs-comment">-- | Target chunk, the leftover, whether we're done</span><span>
</span><span id="line-1638"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1639"></span><span id="brReadN"><span class="annot"><span class="annottext">brReadN :: BodyReader -&gt; Int -&gt; IO (ByteString, ByteString, Bool)
</span><a href="Network.HTTP.Req.html#brReadN"><span class="hs-identifier hs-var hs-var">brReadN</span></a></span></span><span> </span><span id="local-6989586621679213265"><span class="annot"><span class="annottext">br :: BodyReader
</span><a href="#local-6989586621679213265"><span class="hs-identifier hs-var">br</span></a></span></span><span> </span><span id="local-6989586621679213264"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679213264"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; ([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString])
-&gt; IO (ByteString, ByteString, Bool)
</span><a href="#local-6989586621679213263"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-1640"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1641"></span><span>    </span><span id="local-6989586621679213263"><span class="annot"><span class="annottext">go :: Int
-&gt; ([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString])
-&gt; IO (ByteString, ByteString, Bool)
</span><a href="#local-6989586621679213263"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679213261"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213261"><span class="hs-identifier hs-var">tlen</span></a></span></span><span> </span><span id="local-6989586621679213260"><span class="annot"><span class="annottext">t :: [ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213260"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679213259"><span class="annot"><span class="annottext">l :: [ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213259"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1642"></span><span>      </span><span id="local-6989586621679213258"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213258"><span class="hs-identifier hs-var">chunk</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BodyReader
</span><a href="#local-6989586621679213265"><span class="hs-identifier hs-var">br</span></a></span><span>
</span><span id="line-1643"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">B.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213258"><span class="hs-identifier hs-var">chunk</span></a></span><span>
</span><span id="line-1644"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString, Bool) -&gt; IO (ByteString, ByteString, Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; ByteString
forall a. ([a] -&gt; [ByteString]) -&gt; ByteString
</span><a href="#local-6989586621679213257"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213260"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; ByteString
forall a. ([a] -&gt; [ByteString]) -&gt; ByteString
</span><a href="#local-6989586621679213257"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213259"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1645"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1646"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213256"><span class="annot"><span class="annottext">target :: ByteString
</span><a href="#local-6989586621679213256"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213255"><span class="annot"><span class="annottext">leftover :: ByteString
</span><a href="#local-6989586621679213255"><span class="hs-identifier hs-var">leftover</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">B.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213264"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213261"><span class="hs-identifier hs-var">tlen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213258"><span class="hs-identifier hs-var">chunk</span></a></span><span>
</span><span id="line-1647"></span><span>              </span><span id="local-6989586621679213253"><span class="annot"><span class="annottext">tlen' :: Int
</span><a href="#local-6989586621679213253"><span class="hs-identifier hs-var hs-var">tlen'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213256"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-1648"></span><span>              </span><span id="local-6989586621679213251"><span class="annot"><span class="annottext">t' :: [ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213251"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213260"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString]) -&gt; [ByteString] -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213256"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-1649"></span><span>              </span><span id="local-6989586621679213250"><span class="annot"><span class="annottext">l' :: [ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213250"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213259"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString]) -&gt; [ByteString] -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213255"><span class="hs-identifier hs-var">leftover</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213261"><span class="hs-identifier hs-var">tlen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213253"><span class="hs-identifier hs-var">tlen'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213264"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1651"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; ([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString])
-&gt; IO (ByteString, ByteString, Bool)
</span><a href="#local-6989586621679213263"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213261"><span class="hs-identifier hs-var">tlen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213253"><span class="hs-identifier hs-var">tlen'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213251"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213250"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-1652"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString, Bool) -&gt; IO (ByteString, ByteString, Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; ByteString
forall a. ([a] -&gt; [ByteString]) -&gt; ByteString
</span><a href="#local-6989586621679213257"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213251"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; ByteString
forall a. ([a] -&gt; [ByteString]) -&gt; ByteString
</span><a href="#local-6989586621679213257"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679213250"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-1653"></span><span>    </span><span id="local-6989586621679213257"><span class="annot"><span class="annottext">r :: ([a] -&gt; [ByteString]) -&gt; ByteString
</span><a href="#local-6989586621679213257"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679213249"><span class="annot"><span class="annottext">f :: [a] -&gt; [ByteString]
</span><a href="#local-6989586621679213249"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [ByteString]
</span><a href="#local-6989586621679213249"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1654"></span><span>
</span><span id="line-1655"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1656"></span><span class="hs-comment">-- Inspecting a response</span><span>
</span><span id="line-1657"></span><span>
</span><span id="line-1658"></span><span class="hs-comment">-- | Get the response body.</span><span>
</span><span id="line-1659"></span><span id="local-6989586621679213248"><span class="annot"><a href="Network.HTTP.Req.html#responseBody"><span class="hs-identifier hs-type">responseBody</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1660"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213248"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1661"></span><span>  </span><span class="annot"><a href="#local-6989586621679213248"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1662"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponseBody"><span class="hs-identifier hs-type">HttpResponseBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213248"><span class="hs-identifier hs-type">response</span></a></span></span><span>
</span><span id="line-1663"></span><span id="responseBody"><span class="annot"><span class="annottext">responseBody :: response -&gt; HttpResponseBody response
</span><a href="Network.HTTP.Req.html#responseBody"><span class="hs-identifier hs-var hs-var">responseBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (HttpResponseBody response) -&gt; HttpResponseBody response
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">L.responseBody</span></span><span> </span><span class="annot"><span class="annottext">(Response (HttpResponseBody response) -&gt; HttpResponseBody response)
-&gt; (response -&gt; Response (HttpResponseBody response))
-&gt; response
-&gt; HttpResponseBody response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">response -&gt; Response (HttpResponseBody response)
forall response.
HttpResponse response =&gt;
response -&gt; Response (HttpResponseBody response)
</span><a href="Network.HTTP.Req.html#toVanillaResponse"><span class="hs-identifier hs-var">toVanillaResponse</span></a></span><span>
</span><span id="line-1664"></span><span>
</span><span id="line-1665"></span><span class="hs-comment">-- | Get the response status code.</span><span>
</span><span id="line-1666"></span><span id="local-6989586621679213247"><span class="annot"><a href="Network.HTTP.Req.html#responseStatusCode"><span class="hs-identifier hs-type">responseStatusCode</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1667"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213247"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1668"></span><span>  </span><span class="annot"><a href="#local-6989586621679213247"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1669"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-1670"></span><span id="responseStatusCode"><span class="annot"><span class="annottext">responseStatusCode :: response -&gt; Int
</span><a href="Network.HTTP.Req.html#responseStatusCode"><span class="hs-identifier hs-var hs-var">responseStatusCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1671"></span><span>  </span><span class="annot"><span class="annottext">Status -&gt; Int
</span><span class="hs-identifier hs-var hs-var">Y.statusCode</span></span><span> </span><span class="annot"><span class="annottext">(Status -&gt; Int) -&gt; (response -&gt; Status) -&gt; response -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response (HttpResponseBody response) -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">L.responseStatus</span></span><span> </span><span class="annot"><span class="annottext">(Response (HttpResponseBody response) -&gt; Status)
-&gt; (response -&gt; Response (HttpResponseBody response))
-&gt; response
-&gt; Status
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">response -&gt; Response (HttpResponseBody response)
forall response.
HttpResponse response =&gt;
response -&gt; Response (HttpResponseBody response)
</span><a href="Network.HTTP.Req.html#toVanillaResponse"><span class="hs-identifier hs-var">toVanillaResponse</span></a></span><span>
</span><span id="line-1672"></span><span>
</span><span id="line-1673"></span><span class="hs-comment">-- | Get the response status message.</span><span>
</span><span id="line-1674"></span><span id="local-6989586621679213246"><span class="annot"><a href="Network.HTTP.Req.html#responseStatusMessage"><span class="hs-identifier hs-type">responseStatusMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1675"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213246"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1676"></span><span>  </span><span class="annot"><a href="#local-6989586621679213246"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1677"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-1678"></span><span id="responseStatusMessage"><span class="annot"><span class="annottext">responseStatusMessage :: response -&gt; ByteString
</span><a href="Network.HTTP.Req.html#responseStatusMessage"><span class="hs-identifier hs-var hs-var">responseStatusMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1679"></span><span>  </span><span class="annot"><span class="annottext">Status -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">Y.statusMessage</span></span><span> </span><span class="annot"><span class="annottext">(Status -&gt; ByteString)
-&gt; (response -&gt; Status) -&gt; response -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response (HttpResponseBody response) -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">L.responseStatus</span></span><span> </span><span class="annot"><span class="annottext">(Response (HttpResponseBody response) -&gt; Status)
-&gt; (response -&gt; Response (HttpResponseBody response))
-&gt; response
-&gt; Status
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">response -&gt; Response (HttpResponseBody response)
forall response.
HttpResponse response =&gt;
response -&gt; Response (HttpResponseBody response)
</span><a href="Network.HTTP.Req.html#toVanillaResponse"><span class="hs-identifier hs-var">toVanillaResponse</span></a></span><span>
</span><span id="line-1680"></span><span>
</span><span id="line-1681"></span><span class="hs-comment">-- | Lookup a particular header from a response.</span><span>
</span><span id="line-1682"></span><span id="local-6989586621679213244"><span class="annot"><a href="Network.HTTP.Req.html#responseHeader"><span class="hs-identifier hs-type">responseHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1683"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213244"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1684"></span><span>  </span><span class="hs-comment">-- | Response interpretation</span><span>
</span><span id="line-1685"></span><span>  </span><span class="annot"><a href="#local-6989586621679213244"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1686"></span><span>  </span><span class="hs-comment">-- | Header to lookup</span><span>
</span><span id="line-1687"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1688"></span><span>  </span><span class="hs-comment">-- | Header value if found</span><span>
</span><span id="line-1689"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-1690"></span><span id="responseHeader"><span class="annot"><span class="annottext">responseHeader :: response -&gt; ByteString -&gt; Maybe ByteString
</span><a href="Network.HTTP.Req.html#responseHeader"><span class="hs-identifier hs-var hs-var">responseHeader</span></a></span></span><span> </span><span id="local-6989586621679213243"><span class="annot"><span class="annottext">r :: response
</span><a href="#local-6989586621679213243"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679213242"><span class="annot"><span class="annottext">h :: ByteString
</span><a href="#local-6989586621679213242"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1691"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName -&gt; RequestHeaders -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; HeaderName
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213242"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RequestHeaders -&gt; Maybe ByteString)
-&gt; (response -&gt; RequestHeaders) -&gt; response -&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response (HttpResponseBody response) -&gt; RequestHeaders
forall body. Response body -&gt; RequestHeaders
</span><span class="hs-identifier hs-var hs-var">L.responseHeaders</span></span><span> </span><span class="annot"><span class="annottext">(Response (HttpResponseBody response) -&gt; RequestHeaders)
-&gt; (response -&gt; Response (HttpResponseBody response))
-&gt; response
-&gt; RequestHeaders
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">response -&gt; Response (HttpResponseBody response)
forall response.
HttpResponse response =&gt;
response -&gt; Response (HttpResponseBody response)
</span><a href="Network.HTTP.Req.html#toVanillaResponse"><span class="hs-identifier hs-var">toVanillaResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">response
</span><a href="#local-6989586621679213243"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1692"></span><span>
</span><span id="line-1693"></span><span class="hs-comment">-- | Get the response 'L.CookieJar'.</span><span>
</span><span id="line-1694"></span><span id="local-6989586621679213239"><span class="annot"><a href="Network.HTTP.Req.html#responseCookieJar"><span class="hs-identifier hs-type">responseCookieJar</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1695"></span><span>  </span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213239"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1696"></span><span>  </span><span class="annot"><a href="#local-6989586621679213239"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1697"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">L.CookieJar</span></span></span><span>
</span><span id="line-1698"></span><span id="responseCookieJar"><span class="annot"><span class="annottext">responseCookieJar :: response -&gt; CookieJar
</span><a href="Network.HTTP.Req.html#responseCookieJar"><span class="hs-identifier hs-var hs-var">responseCookieJar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (HttpResponseBody response) -&gt; CookieJar
forall body. Response body -&gt; CookieJar
</span><span class="hs-identifier hs-var hs-var">L.responseCookieJar</span></span><span> </span><span class="annot"><span class="annottext">(Response (HttpResponseBody response) -&gt; CookieJar)
-&gt; (response -&gt; Response (HttpResponseBody response))
-&gt; response
-&gt; CookieJar
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">response -&gt; Response (HttpResponseBody response)
forall response.
HttpResponse response =&gt;
response -&gt; Response (HttpResponseBody response)
</span><a href="Network.HTTP.Req.html#toVanillaResponse"><span class="hs-identifier hs-var">toVanillaResponse</span></a></span><span>
</span><span id="line-1699"></span><span>
</span><span id="line-1700"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1701"></span><span class="hs-comment">-- Response&#8212;Defining your own interpretation</span><span>
</span><span id="line-1702"></span><span>
</span><span id="line-1703"></span><span class="hs-comment">-- $new-response-interpretation</span><span>
</span><span id="line-1704"></span><span class="hs-comment">--</span><span>
</span><span id="line-1705"></span><span class="hs-comment">-- To create a new response interpretation you just need to make your data</span><span>
</span><span id="line-1706"></span><span class="hs-comment">-- type an instance of the 'HttpResponse' type class.</span><span>
</span><span id="line-1707"></span><span>
</span><span id="line-1708"></span><span class="hs-comment">-- | A type class for response interpretations. It allows to describe how to</span><span>
</span><span id="line-1709"></span><span class="hs-comment">-- consume response from a @'L.Response' 'L.BodyReader'@ and produce the</span><span>
</span><span id="line-1710"></span><span class="hs-comment">-- final result that is to be returned to the user.</span><span>
</span><span id="line-1711"></span><span class="hs-keyword">class</span><span> </span><span id="HttpResponse"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponse"><span class="hs-identifier hs-var">HttpResponse</span></a></span></span><span> </span><span id="local-6989586621679214443"><span class="annot"><a href="#local-6989586621679214443"><span class="hs-identifier hs-type">response</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1712"></span><span>  </span><span class="hs-comment">-- | The associated type is the type of body that can be extracted from an</span><span>
</span><span id="line-1713"></span><span>  </span><span class="hs-comment">-- instance of 'HttpResponse'.</span><span>
</span><span id="line-1714"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="HttpResponseBody"><span class="annot"><a href="Network.HTTP.Req.html#HttpResponseBody"><span class="hs-identifier hs-var">HttpResponseBody</span></a></span></span><span> </span><span id="local-6989586621679214443"><span class="annot"><a href="#local-6989586621679214443"><span class="hs-identifier hs-type">response</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-1715"></span><span>
</span><span id="line-1716"></span><span>  </span><span class="hs-comment">-- | The method describes how to get the underlying 'L.Response' record.</span><span>
</span><span id="line-1717"></span><span>  </span><span id="toVanillaResponse"><span class="annot"><a href="Network.HTTP.Req.html#toVanillaResponse"><span class="hs-identifier hs-type">toVanillaResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679214443"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Req.html#HttpResponseBody"><span class="hs-identifier hs-type">HttpResponseBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679214443"><span class="hs-identifier hs-type">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1718"></span><span>
</span><span id="line-1719"></span><span>  </span><span class="hs-comment">-- | This method describes how to consume response body and, more</span><span>
</span><span id="line-1720"></span><span>  </span><span class="hs-comment">-- generally, obtain @response@ value from @'L.Response' 'L.BodyReader'@.</span><span>
</span><span id="line-1721"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1722"></span><span>  </span><span class="hs-comment">-- __Note__: 'L.BodyReader' is nothing but @'IO' 'ByteString'@. You should</span><span>
</span><span id="line-1723"></span><span>  </span><span class="hs-comment">-- call this action repeatedly until it yields the empty 'ByteString'. In</span><span>
</span><span id="line-1724"></span><span>  </span><span class="hs-comment">-- that case streaming of response is finished (which apparently leads to</span><span>
</span><span id="line-1725"></span><span>  </span><span class="hs-comment">-- closing of the connection, so don't call the reader after it has</span><span>
</span><span id="line-1726"></span><span>  </span><span class="hs-comment">-- returned the empty 'ByteString' once) and you can concatenate the</span><span>
</span><span id="line-1727"></span><span>  </span><span class="hs-comment">-- chunks to obtain the final result. (Of course you could as well stream</span><span>
</span><span id="line-1728"></span><span>  </span><span class="hs-comment">-- the contents to a file or do whatever you want.)</span><span>
</span><span id="line-1729"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-comment">-- __Note__: signature of this function was changed in the version</span><span>
</span><span id="line-1731"></span><span>  </span><span class="hs-comment">-- /1.0.0/.</span><span>
</span><span id="line-1732"></span><span>  </span><span id="getHttpResponse"><span class="annot"><a href="Network.HTTP.Req.html#getHttpResponse"><span class="hs-identifier hs-type">getHttpResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1733"></span><span>    </span><span class="hs-comment">-- | Response with body reader inside</span><span>
</span><span id="line-1734"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">L.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.BodyReader</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1735"></span><span>    </span><span class="hs-comment">-- | The final result</span><span>
</span><span id="line-1736"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679214443"><span class="hs-identifier hs-type">response</span></a></span><span>
</span><span id="line-1737"></span><span>
</span><span id="line-1738"></span><span>  </span><span class="hs-comment">-- | The value of @\&quot;Accept\&quot;@ header. This is useful, for example, if a</span><span>
</span><span id="line-1739"></span><span>  </span><span class="hs-comment">-- website supports both @XML@ and @JSON@ responses, and decides what to</span><span>
</span><span id="line-1740"></span><span>  </span><span class="hs-comment">-- reply with based on what @Accept@ headers you have sent.</span><span>
</span><span id="line-1741"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1742"></span><span>  </span><span class="hs-comment">-- __Note__: manually specified 'Options' that set the @\&quot;Accept\&quot;@ header</span><span>
</span><span id="line-1743"></span><span>  </span><span class="hs-comment">-- will take precedence.</span><span>
</span><span id="line-1744"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1745"></span><span>  </span><span class="hs-comment">-- @since 2.1.0</span><span>
</span><span id="line-1746"></span><span>  </span><span id="acceptHeader"><span class="annot"><a href="Network.HTTP.Req.html#acceptHeader"><span class="hs-identifier hs-type">acceptHeader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679214443"><span class="hs-identifier hs-type">response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-1747"></span><span>  </span><span id="local-6989586621679213237"><span class="annot"><a href="Network.HTTP.Req.html#acceptHeader"><span class="hs-identifier hs-var hs-var">acceptHeader</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-1748"></span><span>
</span><span id="line-1749"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1750"></span><span class="hs-comment">-- Other</span><span>
</span><span id="line-1751"></span><span>
</span><span id="line-1752"></span><span class="hs-comment">-- | The main class for things that are &#8220;parts&#8221; of 'L.Request' in the sense</span><span>
</span><span id="line-1753"></span><span class="hs-comment">-- that if we have a 'L.Request', then we know how to apply an instance of</span><span>
</span><span id="line-1754"></span><span class="hs-comment">-- 'RequestComponent' changing\/overwriting something in it. 'Endo' is a</span><span>
</span><span id="line-1755"></span><span class="hs-comment">-- monoid of endomorphisms under composition, it's used to chain different</span><span>
</span><span id="line-1756"></span><span class="hs-comment">-- request components easier using @('&lt;&gt;')@.</span><span>
</span><span id="line-1757"></span><span class="hs-comment">--</span><span>
</span><span id="line-1758"></span><span class="hs-comment">-- __Note__: this type class is not a part of the public API.</span><span>
</span><span id="line-1759"></span><span class="hs-keyword">class</span><span> </span><span id="RequestComponent"><span class="annot"><a href="Network.HTTP.Req.html#RequestComponent"><span class="hs-identifier hs-var">RequestComponent</span></a></span></span><span> </span><span id="local-6989586621679214345"><span class="annot"><a href="#local-6989586621679214345"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1760"></span><span>  </span><span class="hs-comment">-- | Get a function that takes a 'L.Request' and changes it somehow</span><span>
</span><span id="line-1761"></span><span>  </span><span class="hs-comment">-- returning another 'L.Request'. For example, the 'HttpMethod' instance</span><span>
</span><span id="line-1762"></span><span>  </span><span class="hs-comment">-- of 'RequestComponent' just overwrites method. The function is wrapped</span><span>
</span><span id="line-1763"></span><span>  </span><span class="hs-comment">-- in 'Endo' so it's easier to chain such &#8220;modifying applications&#8221;</span><span>
</span><span id="line-1764"></span><span>  </span><span class="hs-comment">-- together building bigger and bigger 'RequestComponent's.</span><span>
</span><span id="line-1765"></span><span>  </span><span id="getRequestMod"><span class="annot"><a href="Network.HTTP.Req.html#getRequestMod"><span class="hs-identifier hs-type">getRequestMod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679214345"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Request</span></span><span>
</span><span id="line-1766"></span><span>
</span><span id="line-1767"></span><span class="hs-comment">-- | This wrapper is only used to attach a type-level tag to a given type.</span><span>
</span><span id="line-1768"></span><span class="hs-comment">-- This is necessary to define instances of 'RequestComponent' for any thing</span><span>
</span><span id="line-1769"></span><span class="hs-comment">-- that implements 'HttpMethod' or 'HttpBody'. Without the tag, GHC can't</span><span>
</span><span id="line-1770"></span><span class="hs-comment">-- see the difference between @'HttpMethod' method =&gt; 'RequestComponent'</span><span>
</span><span id="line-1771"></span><span class="hs-comment">-- method@ and @'HttpBody' body =&gt; 'RequestComponent' body@ when it decides</span><span>
</span><span id="line-1772"></span><span class="hs-comment">-- which instance to use (i.e. the constraints are taken into account later,</span><span>
</span><span id="line-1773"></span><span class="hs-comment">-- when instance is already chosen).</span><span>
</span><span id="line-1774"></span><span class="hs-keyword">newtype</span><span> </span><span id="Womb"><span class="annot"><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-var">Womb</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679214341"><span class="annot"><a href="#local-6989586621679214341"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679214342"><span class="annot"><a href="#local-6989586621679214342"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Womb"><span class="annot"><a href="Network.HTTP.Req.html#Womb"><span class="hs-identifier hs-var">Womb</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679214342"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1775"></span><span>
</span><span id="line-1776"></span><span class="hs-comment">-- | Exceptions that this library throws.</span><span>
</span><span id="line-1777"></span><span id="local-6989586621679213235"><span id="local-6989586621679213236"></span></span><span class="hs-keyword">data</span><span> </span><span id="HttpException"><span class="annot"><a href="Network.HTTP.Req.html#HttpException"><span class="hs-identifier hs-var">HttpException</span></a></span></span><span>
</span><span id="line-1778"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | A wrapper with an 'L.HttpException' from &quot;Network.HTTP.Client&quot;</span><span>
</span><span id="line-1779"></span><span>    </span><span id="VanillaHttpException"><span class="annot"><a href="Network.HTTP.Req.html#VanillaHttpException"><span class="hs-identifier hs-var">VanillaHttpException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.HttpException</span></span><span>
</span><span id="line-1780"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | A wrapper with Aeson-produced 'String' describing why decoding</span><span>
</span><span id="line-1781"></span><span>    </span><span class="hs-comment">-- failed</span><span>
</span><span id="line-1782"></span><span>    </span><span id="JsonHttpException"><span class="annot"><a href="Network.HTTP.Req.html#JsonHttpException"><span class="hs-identifier hs-var">JsonHttpException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1783"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213229"><span id="local-6989586621679213231"><span id="local-6989586621679213233"><span class="annot"><span class="annottext">Int -&gt; HttpException -&gt; ShowS
[HttpException] -&gt; ShowS
HttpException -&gt; String
(Int -&gt; HttpException -&gt; ShowS)
-&gt; (HttpException -&gt; String)
-&gt; ([HttpException] -&gt; ShowS)
-&gt; Show HttpException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HttpException] -&gt; ShowS
$cshowList :: [HttpException] -&gt; ShowS
show :: HttpException -&gt; String
$cshow :: HttpException -&gt; String
showsPrec :: Int -&gt; HttpException -&gt; ShowS
$cshowsPrec :: Int -&gt; HttpException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HttpException -&gt; Rep HttpException x)
-&gt; (forall x. Rep HttpException x -&gt; HttpException)
-&gt; Generic HttpException
forall x. Rep HttpException x -&gt; HttpException
forall x. HttpException -&gt; Rep HttpException x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep HttpException x -&gt; HttpException
$cfrom :: forall x. HttpException -&gt; Rep HttpException x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1784"></span><span>
</span><span id="line-1785"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213219"><span id="local-6989586621679213221"><span id="local-6989586621679213223"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Network.HTTP.Req.html#HttpException"><span class="hs-identifier hs-type">HttpException</span></a></span></span></span></span><span>
</span><span id="line-1786"></span><span>
</span><span id="line-1787"></span><span class="hs-comment">-- | A simple type isomorphic to 'Bool' that we only have for better error</span><span>
</span><span id="line-1788"></span><span class="hs-comment">-- messages. We use it as a kind and its data constructors as type-level</span><span>
</span><span id="line-1789"></span><span class="hs-comment">-- tags.</span><span>
</span><span id="line-1790"></span><span class="hs-comment">--</span><span>
</span><span id="line-1791"></span><span class="hs-comment">-- See also: 'HttpMethod' and 'HttpBody'.</span><span>
</span><span id="line-1792"></span><span class="hs-keyword">data</span><span> </span><span id="CanHaveBody"><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-var">CanHaveBody</span></a></span></span><span>
</span><span id="line-1793"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Indeed can have a body</span><span>
</span><span id="line-1794"></span><span>    </span><span id="CanHaveBody"><span class="annot"><a href="Network.HTTP.Req.html#CanHaveBody"><span class="hs-identifier hs-var">CanHaveBody</span></a></span></span><span>
</span><span id="line-1795"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Should not have a body</span><span>
</span><span id="line-1796"></span><span>    </span><span id="NoBody"><span class="annot"><a href="Network.HTTP.Req.html#NoBody"><span class="hs-identifier hs-var">NoBody</span></a></span></span><span>
</span><span id="line-1797"></span><span>
</span><span id="line-1798"></span><span class="hs-comment">-- | A type-level tag that specifies URL scheme used (and thus if HTTPS is</span><span>
</span><span id="line-1799"></span><span class="hs-comment">-- enabled). This is used to force TLS requirement for some authentication</span><span>
</span><span id="line-1800"></span><span class="hs-comment">-- 'Option's.</span><span>
</span><span id="line-1801"></span><span id="local-6989586621679213216"><span id="local-6989586621679213217"></span></span><span class="hs-keyword">data</span><span> </span><span id="Scheme"><span class="annot"><a href="Network.HTTP.Req.html#Scheme"><span class="hs-identifier hs-var">Scheme</span></a></span></span><span>
</span><span id="line-1802"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | HTTP</span><span>
</span><span id="line-1803"></span><span>    </span><span id="Http"><span class="annot"><a href="Network.HTTP.Req.html#Http"><span class="hs-identifier hs-var">Http</span></a></span></span><span>
</span><span id="line-1804"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | HTTPS</span><span>
</span><span id="line-1805"></span><span>    </span><span id="Https"><span class="annot"><a href="Network.HTTP.Req.html#Https"><span class="hs-identifier hs-var">Https</span></a></span></span><span>
</span><span id="line-1806"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213212"><span id="local-6989586621679213214"><span class="annot"><span class="annottext">Scheme -&gt; Scheme -&gt; Bool
(Scheme -&gt; Scheme -&gt; Bool)
-&gt; (Scheme -&gt; Scheme -&gt; Bool) -&gt; Eq Scheme
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Scheme -&gt; Scheme -&gt; Bool
$c/= :: Scheme -&gt; Scheme -&gt; Bool
== :: Scheme -&gt; Scheme -&gt; Bool
$c== :: Scheme -&gt; Scheme -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213197"><span id="local-6989586621679213199"><span id="local-6989586621679213201"><span id="local-6989586621679213203"><span id="local-6989586621679213205"><span id="local-6989586621679213207"><span id="local-6989586621679213209"><span class="annot"><span class="annottext">Eq Scheme
Eq Scheme =&gt;
(Scheme -&gt; Scheme -&gt; Ordering)
-&gt; (Scheme -&gt; Scheme -&gt; Bool)
-&gt; (Scheme -&gt; Scheme -&gt; Bool)
-&gt; (Scheme -&gt; Scheme -&gt; Bool)
-&gt; (Scheme -&gt; Scheme -&gt; Bool)
-&gt; (Scheme -&gt; Scheme -&gt; Scheme)
-&gt; (Scheme -&gt; Scheme -&gt; Scheme)
-&gt; Ord Scheme
Scheme -&gt; Scheme -&gt; Bool
Scheme -&gt; Scheme -&gt; Ordering
Scheme -&gt; Scheme -&gt; Scheme
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Scheme -&gt; Scheme -&gt; Scheme
$cmin :: Scheme -&gt; Scheme -&gt; Scheme
max :: Scheme -&gt; Scheme -&gt; Scheme
$cmax :: Scheme -&gt; Scheme -&gt; Scheme
&gt;= :: Scheme -&gt; Scheme -&gt; Bool
$c&gt;= :: Scheme -&gt; Scheme -&gt; Bool
&gt; :: Scheme -&gt; Scheme -&gt; Bool
$c&gt; :: Scheme -&gt; Scheme -&gt; Bool
&lt;= :: Scheme -&gt; Scheme -&gt; Bool
$c&lt;= :: Scheme -&gt; Scheme -&gt; Bool
&lt; :: Scheme -&gt; Scheme -&gt; Bool
$c&lt; :: Scheme -&gt; Scheme -&gt; Bool
compare :: Scheme -&gt; Scheme -&gt; Ordering
$ccompare :: Scheme -&gt; Scheme -&gt; Ordering
$cp1Ord :: Eq Scheme
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213191"><span id="local-6989586621679213193"><span id="local-6989586621679213195"><span class="annot"><span class="annottext">Int -&gt; Scheme -&gt; ShowS
[Scheme] -&gt; ShowS
Scheme -&gt; String
(Int -&gt; Scheme -&gt; ShowS)
-&gt; (Scheme -&gt; String) -&gt; ([Scheme] -&gt; ShowS) -&gt; Show Scheme
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Scheme] -&gt; ShowS
$cshowList :: [Scheme] -&gt; ShowS
show :: Scheme -&gt; String
$cshow :: Scheme -&gt; String
showsPrec :: Int -&gt; Scheme -&gt; ShowS
$cshowsPrec :: Int -&gt; Scheme -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="%24cHttps"><span id="%24cHttp"><span id="%24tScheme"><span id="local-6989586621679213162"><span id="local-6989586621679213164"><span id="local-6989586621679213166"><span id="local-6989586621679213168"><span id="local-6989586621679213170"><span id="local-6989586621679213172"><span id="local-6989586621679213174"><span id="local-6989586621679213176"><span id="local-6989586621679213178"><span id="local-6989586621679213180"><span id="local-6989586621679213182"><span id="local-6989586621679213184"><span id="local-6989586621679213186"><span id="local-6989586621679213188"><span class="annot"><span class="annottext">Typeable Scheme
DataType
Constr
Typeable Scheme =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; Scheme -&gt; c Scheme)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Scheme)
-&gt; (Scheme -&gt; Constr)
-&gt; (Scheme -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Scheme))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Scheme))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Scheme -&gt; Scheme)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme)
-&gt; Data Scheme
Scheme -&gt; DataType
Scheme -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Scheme -&gt; Scheme
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Scheme -&gt; c Scheme
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Scheme
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Scheme
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Scheme -&gt; c Scheme
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Scheme)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Scheme)
$cHttps :: Constr
$cHttp :: Constr
$tScheme :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Scheme -&gt; m Scheme
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Scheme -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Scheme -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Scheme -&gt; Scheme
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Scheme -&gt; Scheme
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Scheme)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Scheme)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Scheme)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Scheme)
dataTypeOf :: Scheme -&gt; DataType
$cdataTypeOf :: Scheme -&gt; DataType
toConstr :: Scheme -&gt; Constr
$ctoConstr :: Scheme -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Scheme
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Scheme
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Scheme -&gt; c Scheme
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Scheme -&gt; c Scheme
$cp1Data :: Typeable Scheme
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Scheme -&gt; Rep Scheme x)
-&gt; (forall x. Rep Scheme x -&gt; Scheme) -&gt; Generic Scheme
forall x. Rep Scheme x -&gt; Scheme
forall x. Scheme -&gt; Rep Scheme x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Scheme x -&gt; Scheme
$cfrom :: forall x. Scheme -&gt; Rep Scheme x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679213155"><span class="annot"><span class="annottext">Scheme -&gt; Q Exp
(Scheme -&gt; Q Exp) -&gt; Lift Scheme
forall t. (t -&gt; Q Exp) -&gt; Lift t
lift :: Scheme -&gt; Q Exp
$clift :: Scheme -&gt; Q Exp
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">TH.Lift</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1807"></span><span>
</span><span id="line-1808"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1809"></span><span class="hs-comment">-- Constants</span><span>
</span><span id="line-1810"></span><span>
</span><span id="line-1811"></span><span class="hs-comment">-- | Max length of preview fragment of response body.</span><span>
</span><span id="line-1812"></span><span id="local-6989586621679214373"><span class="annot"><a href="Network.HTTP.Req.html#bodyPreviewLength"><span class="hs-identifier hs-type">bodyPreviewLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679214373"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679214373"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1813"></span><span id="bodyPreviewLength"><span class="annot"><span class="annottext">bodyPreviewLength :: a
</span><a href="Network.HTTP.Req.html#bodyPreviewLength"><span class="hs-identifier hs-var hs-var">bodyPreviewLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1024</span></span><span>
</span><span id="line-1814"></span></pre></body></html>