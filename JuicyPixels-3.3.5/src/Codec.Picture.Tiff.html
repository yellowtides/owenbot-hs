<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- | Module implementing TIFF decoding.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Supported compression schemes:</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">--   * Uncompressed</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">--   * PackBits</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">--   * LZW</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Supported bit depth:</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">--   * 2 bits</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">--   * 4 bits</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">--   * 8 bits</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">--   * 16 bits</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Codec.Picture.Tiff</span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#decodeTiff"><span class="hs-identifier">decodeTiff</span></a></span><span>
</span><span id="line-30"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#decodeTiffWithMetadata"><span class="hs-identifier">decodeTiffWithMetadata</span></a></span><span>
</span><span id="line-31"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#decodeTiffWithPaletteAndMetadata"><span class="hs-identifier">decodeTiffWithPaletteAndMetadata</span></a></span><span>
</span><span id="line-32"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier">TiffSaveable</span></a></span><span>
</span><span id="line-33"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#encodeTiff"><span class="hs-identifier">encodeTiff</span></a></span><span>
</span><span id="line-34"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#writeTiff"><span class="hs-identifier">writeTiff</span></a></span><span>
</span><span id="line-35"></span><span>                         </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">mempty</span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">first</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forM_</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.ST</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runST</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer.Strict</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">execWriter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Writer</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Int8</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.|.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeShiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeShiftR</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary.Get</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Get</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary.Put</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">runPut</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Storable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">VS</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Storable.Mutable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lb</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Unsafe</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BU</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.Storable</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">sizeOf</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html"><span class="hs-identifier">Codec.Picture.Metadata.Exif</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.html"><span class="hs-identifier">Codec.Picture.Metadata</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.html#Metadatas"><span class="hs-identifier">Metadatas</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.InternalHelper.html"><span class="hs-identifier">Codec.Picture.InternalHelper</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.BitWriter.html"><span class="hs-identifier">Codec.Picture.BitWriter</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html"><span class="hs-identifier">Codec.Picture.Types</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.Gif.Internal.LZW.html"><span class="hs-identifier">Codec.Picture.Gif.Internal.LZW</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html"><span class="hs-identifier">Codec.Picture.Tiff.Internal.Types</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Metadata.html"><span class="hs-identifier">Codec.Picture.Tiff.Internal.Metadata</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.VectorByteConversion.html"><span class="hs-identifier">Codec.Picture.VectorByteConversion</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.Picture.VectorByteConversion.html#toByteString"><span class="hs-identifier">toByteString</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">data</span><span> </span><span id="TiffInfo"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-var">TiffInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TiffInfo"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-var">TiffInfo</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="tiffHeader"><span class="annot"><span class="annottext">TiffInfo -&gt; TiffHeader
</span><a href="Codec.Picture.Tiff.html#tiffHeader"><span class="hs-identifier hs-var hs-var">tiffHeader</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffHeader"><span class="hs-identifier hs-type">TiffHeader</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffWidth"><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffWidth"><span class="hs-identifier hs-var hs-var">tiffWidth</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffHeight"><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffHeight"><span class="hs-identifier hs-var hs-var">tiffHeight</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffColorspace"><span class="annot"><span class="annottext">TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var hs-var">tiffColorspace</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffColorspace"><span class="hs-identifier hs-type">TiffColorspace</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffSampleCount"><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffSampleCount"><span class="hs-identifier hs-var hs-var">tiffSampleCount</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffRowPerStrip"><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffRowPerStrip"><span class="hs-identifier hs-var hs-var">tiffRowPerStrip</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffPlaneConfiguration"><span class="annot"><span class="annottext">TiffInfo -&gt; TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.html#tiffPlaneConfiguration"><span class="hs-identifier hs-var hs-var">tiffPlaneConfiguration</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPlanarConfiguration"><span class="hs-identifier hs-type">TiffPlanarConfiguration</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffSampleFormat"><span class="annot"><span class="annottext">TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var hs-var">tiffSampleFormat</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFormat"><span class="hs-identifier hs-type">TiffSampleFormat</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffBitsPerSample"><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var hs-var">tiffBitsPerSample</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffCompression"><span class="annot"><span class="annottext">TiffInfo -&gt; TiffCompression
</span><a href="Codec.Picture.Tiff.html#tiffCompression"><span class="hs-identifier hs-var hs-var">tiffCompression</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCompression"><span class="hs-identifier hs-type">TiffCompression</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffStripSize"><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffStripSize"><span class="hs-identifier hs-var hs-var">tiffStripSize</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffOffsets"><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffOffsets"><span class="hs-identifier hs-var hs-var">tiffOffsets</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffPalette"><span class="annot"><span class="annottext">TiffInfo -&gt; Maybe (Image PixelRGB16)
</span><a href="Codec.Picture.Tiff.html#tiffPalette"><span class="hs-identifier hs-var hs-var">tiffPalette</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGB16"><span class="hs-identifier hs-type">PixelRGB16</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffYCbCrSubsampling"><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffYCbCrSubsampling"><span class="hs-identifier hs-var hs-var">tiffYCbCrSubsampling</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffExtraSample"><span class="annot"><span class="annottext">TiffInfo -&gt; Maybe ExtraSample
</span><a href="Codec.Picture.Tiff.html#tiffExtraSample"><span class="hs-identifier hs-var hs-var">tiffExtraSample</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSample"><span class="hs-identifier hs-type">ExtraSample</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffPredictor"><span class="annot"><span class="annottext">TiffInfo -&gt; Predictor
</span><a href="Codec.Picture.Tiff.html#tiffPredictor"><span class="hs-identifier hs-var hs-var">tiffPredictor</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Predictor"><span class="hs-identifier hs-type">Predictor</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiffMetadatas"><span class="annot"><span class="annottext">TiffInfo -&gt; Metadatas
</span><a href="Codec.Picture.Tiff.html#tiffMetadatas"><span class="hs-identifier hs-var hs-var">tiffMetadatas</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.html#Metadatas"><span class="hs-identifier hs-type">Metadatas</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-type">unLong</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifData"><span class="hs-identifier hs-type">ExifData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span id="unLong"><span class="annot"><span class="annottext">unLong :: String -&gt; ExifData -&gt; Get (Vector Word32)
</span><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var hs-var">unLong</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifLong"><span class="hs-identifier hs-type">ExifLong</span></a></span><span> </span><span id="local-6989586621679208605"><span class="annot"><span class="annottext">v :: Word32
</span><a href="#local-6989586621679208605"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Get (Vector Word32)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Get (Vector Word32))
-&gt; Vector Word32 -&gt; Get (Vector Word32)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208605"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifShort"><span class="hs-identifier hs-type">ExifShort</span></a></span><span> </span><span id="local-6989586621679208602"><span class="annot"><span class="annottext">v :: Word16
</span><a href="#local-6989586621679208602"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Get (Vector Word32)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Get (Vector Word32))
-&gt; Vector Word32 -&gt; Get (Vector Word32)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208602"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-type">ExifShorts</span></a></span><span> </span><span id="local-6989586621679208600"><span class="annot"><span class="annottext">v :: Vector Word16
</span><a href="#local-6989586621679208600"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Get (Vector Word32)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Get (Vector Word32))
-&gt; Vector Word32 -&gt; Get (Vector Word32)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Word32) -&gt; Vector Word16 -&gt; Vector Word32
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679208600"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifLongs"><span class="hs-identifier hs-type">ExifLongs</span></a></span><span> </span><span id="local-6989586621679208597"><span class="annot"><span class="annottext">v :: Vector Word32
</span><a href="#local-6989586621679208597"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Get (Vector Word32)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208597"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span id="local-6989586621679208596"><span class="annot"><span class="annottext">errMessage :: String
</span><a href="#local-6989586621679208596"><span class="hs-identifier hs-var">errMessage</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get (Vector Word32)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208596"><span class="hs-identifier hs-var">errMessage</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><a href="Codec.Picture.Tiff.html#findIFD"><span class="hs-identifier hs-type">findIFD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span>
</span><span id="line-100"></span><span id="findIFD"><span class="annot"><span class="annottext">findIFD :: String -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get ImageFileDirectory
</span><a href="Codec.Picture.Tiff.html#findIFD"><span class="hs-identifier hs-var hs-var">findIFD</span></a></span></span><span> </span><span id="local-6989586621679208594"><span class="annot"><span class="annottext">errorMessage :: String
</span><a href="#local-6989586621679208594"><span class="hs-identifier hs-var">errorMessage</span></a></span></span><span> </span><span id="local-6989586621679208593"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208593"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679208592"><span class="annot"><span class="annottext">lst :: [ImageFileDirectory]
</span><a href="#local-6989586621679208592"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208591"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679208591"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208591"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208592"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208591"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; ExifTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208593"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ImageFileDirectory
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208594"><span class="hs-identifier hs-var">errorMessage</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679208589"><span class="annot"><span class="annottext">x :: ImageFileDirectory
</span><a href="#local-6989586621679208589"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ImageFileDirectory
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208589"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Codec.Picture.Tiff.html#findPalette"><span class="hs-identifier hs-type">findPalette</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGB16"><span class="hs-identifier hs-type">PixelRGB16</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span id="findPalette"><span class="annot"><span class="annottext">findPalette :: [ImageFileDirectory] -&gt; Get (Maybe (Image PixelRGB16))
</span><a href="Codec.Picture.Tiff.html#findPalette"><span class="hs-identifier hs-var hs-var">findPalette</span></a></span></span><span> </span><span id="local-6989586621679208587"><span class="annot"><span class="annottext">ifds :: [ImageFileDirectory]
</span><a href="#local-6989586621679208587"><span class="hs-identifier hs-var">ifds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208586"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679208586"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208586"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208587"><span class="hs-identifier hs-var">ifds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208586"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; ExifTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagColorMap"><span class="hs-identifier hs-var">TagColorMap</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-type">ExifShorts</span></a></span><span> </span><span id="local-6989586621679208582"><span class="annot"><span class="annottext">vec :: Vector Word16
</span><a href="#local-6989586621679208582"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span class="hs-special">}</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Image PixelRGB16) -&gt; Get (Maybe (Image PixelRGB16))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Image PixelRGB16) -&gt; Get (Maybe (Image PixelRGB16)))
-&gt; (Vector Word16 -&gt; Maybe (Image PixelRGB16))
-&gt; Vector Word16
-&gt; Get (Maybe (Image PixelRGB16))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16 -&gt; Maybe (Image PixelRGB16)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB16 -&gt; Maybe (Image PixelRGB16))
-&gt; (Vector Word16 -&gt; Image PixelRGB16)
-&gt; Vector Word16
-&gt; Maybe (Image PixelRGB16)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Vector (PixelBaseComponent PixelRGB16)
-&gt; Image PixelRGB16
forall a. Int -&gt; Int -&gt; Vector (PixelBaseComponent a) -&gt; Image a
</span><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-var">Image</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208579"><span class="hs-identifier hs-var">pixelCount</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word16 -&gt; Get (Maybe (Image PixelRGB16)))
-&gt; Vector Word16 -&gt; Get (Maybe (Image PixelRGB16))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Word16) -&gt; Vector Word16
forall a. Storable a =&gt; Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">VS.generate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Word16 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679208582"><span class="hs-identifier hs-var">vec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word16
</span><a href="#local-6989586621679208576"><span class="hs-identifier hs-var">axx</span></a></span><span>
</span><span id="line-110"></span><span>                </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208579"><span class="annot"><span class="annottext">pixelCount :: Int
</span><a href="#local-6989586621679208579"><span class="hs-identifier hs-var hs-var">pixelCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word16 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679208582"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-111"></span><span>                      </span><span id="local-6989586621679208576"><span class="annot"><span class="annottext">axx :: Int -&gt; Word16
</span><a href="#local-6989586621679208576"><span class="hs-identifier hs-var hs-var">axx</span></a></span></span><span> </span><span id="local-6989586621679208574"><span class="annot"><span class="annottext">v :: Int
</span><a href="#local-6989586621679208574"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679208582"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word16 -&gt; Int -&gt; Word16
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208572"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208570"><span class="hs-identifier hs-var">color</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208579"><span class="hs-identifier hs-var">pixelCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>                          </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208572"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679208572"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208570"><span class="annot"><span class="annottext">color :: Int
</span><a href="#local-6989586621679208570"><span class="hs-identifier hs-var">color</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208574"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`divMod`</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Image PixelRGB16) -&gt; Get (Maybe (Image PixelRGB16))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Image PixelRGB16)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Codec.Picture.Tiff.html#findIFDData"><span class="hs-identifier hs-type">findIFDData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-117"></span><span id="findIFDData"><span class="annot"><span class="annottext">findIFDData :: String -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get Word32
</span><a href="Codec.Picture.Tiff.html#findIFDData"><span class="hs-identifier hs-var hs-var">findIFDData</span></a></span></span><span> </span><span id="local-6989586621679208566"><span class="annot"><span class="annottext">msg :: String
</span><a href="#local-6989586621679208566"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679208565"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208565"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679208564"><span class="annot"><span class="annottext">lst :: [ImageFileDirectory]
</span><a href="#local-6989586621679208564"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; Word32)
-&gt; Get ImageFileDirectory -&gt; Get Word32
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get ImageFileDirectory
</span><a href="Codec.Picture.Tiff.html#findIFD"><span class="hs-identifier hs-var">findIFD</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208566"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208565"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208564"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Codec.Picture.Tiff.html#findIFDDefaultData"><span class="hs-identifier hs-type">findIFDDefaultData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-120"></span><span id="findIFDDefaultData"><span class="annot"><span class="annottext">findIFDDefaultData :: Word32 -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get Word32
</span><a href="Codec.Picture.Tiff.html#findIFDDefaultData"><span class="hs-identifier hs-var hs-var">findIFDDefaultData</span></a></span></span><span> </span><span id="local-6989586621679208560"><span class="annot"><span class="annottext">d :: Word32
</span><a href="#local-6989586621679208560"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679208559"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208559"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679208558"><span class="annot"><span class="annottext">lst :: [ImageFileDirectory]
</span><a href="#local-6989586621679208558"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208557"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679208557"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208557"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208558"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208557"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; ExifTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208559"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get Word32
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208560"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679208556"><span class="annot"><span class="annottext">x :: ImageFileDirectory
</span><a href="#local-6989586621679208556"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get Word32
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Get Word32) -&gt; Word32 -&gt; Get Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208556"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Codec.Picture.Tiff.html#findIFDExt"><span class="hs-identifier hs-type">findIFDExt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifData"><span class="hs-identifier hs-type">ExifData</span></a></span><span>
</span><span id="line-126"></span><span id="findIFDExt"><span class="annot"><span class="annottext">findIFDExt :: String -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get ExifData
</span><a href="Codec.Picture.Tiff.html#findIFDExt"><span class="hs-identifier hs-var hs-var">findIFDExt</span></a></span></span><span> </span><span id="local-6989586621679208554"><span class="annot"><span class="annottext">msg :: String
</span><a href="#local-6989586621679208554"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679208553"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208553"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679208552"><span class="annot"><span class="annottext">lst :: [ImageFileDirectory]
</span><a href="#local-6989586621679208552"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679208551"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208551"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get ImageFileDirectory
</span><a href="Codec.Picture.Tiff.html#findIFD"><span class="hs-identifier hs-var">findIFD</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208554"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208553"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208552"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208551"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208549"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208549"><span class="hs-identifier hs-var">ofs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>               </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Get ExifData)
-&gt; (Word16 -&gt; ExifData) -&gt; Word16 -&gt; Get ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-var">ExifShorts</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word16 -&gt; ExifData)
-&gt; (Word16 -&gt; Vector Word16) -&gt; Word16 -&gt; ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Vector Word16
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Get ExifData) -&gt; Word16 -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208549"><span class="hs-identifier hs-var">ofs</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208546"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208546"><span class="hs-identifier hs-var">ofs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-134"></span><span>               </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Get ExifData)
-&gt; (Word32 -&gt; ExifData) -&gt; Word32 -&gt; Get ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifLongs"><span class="hs-identifier hs-var">ExifLongs</span></a></span><span>  </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; ExifData)
-&gt; (Word32 -&gt; Vector Word32) -&gt; Word32 -&gt; ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Get ExifData) -&gt; Word32 -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208546"><span class="hs-identifier hs-var">ofs</span></a></span><span>
</span><span id="line-135"></span><span>      </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208544"><span class="annot"><span class="annottext">ExifData
</span><a href="#local-6989586621679208544"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="#local-6989586621679208544"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Codec.Picture.Tiff.html#findIFDExtDefaultData"><span class="hs-identifier hs-type">findIFDExtDefaultData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-139"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span id="findIFDExtDefaultData"><span class="annot"><span class="annottext">findIFDExtDefaultData :: [Word32] -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get [Word32]
</span><a href="Codec.Picture.Tiff.html#findIFDExtDefaultData"><span class="hs-identifier hs-var hs-var">findIFDExtDefaultData</span></a></span></span><span> </span><span id="local-6989586621679208542"><span class="annot"><span class="annottext">d :: [Word32]
</span><a href="#local-6989586621679208542"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679208541"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208541"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679208540"><span class="annot"><span class="annottext">lst :: [ImageFileDirectory]
</span><a href="#local-6989586621679208540"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208539"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679208539"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208539"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208540"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208539"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; ExifTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208541"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Get [Word32]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Word32]
</span><a href="#local-6989586621679208542"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span> </span><span class="hs-special">}</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Get [Word32]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Word32]
</span><a href="#local-6989586621679208542"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679208537"><span class="annot"><span class="annottext">x :: ImageFileDirectory
</span><a href="#local-6989586621679208537"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; [Word32]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; [Word32]) -&gt; Get (Vector Word32) -&gt; Get [Word32]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifData -&gt; Get (Vector Word32)
</span><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208535"><span class="hs-identifier hs-var">errorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var hs-var">ifdExtended</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208537"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208535"><span class="annot"><span class="annottext">errorMessage :: String
</span><a href="#local-6989586621679208535"><span class="hs-identifier hs-var hs-var">errorMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>                    </span><span class="annot"><span class="hs-string">&quot;Can't parse tag &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208541"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ExifData -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var hs-var">ifdExtended</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679208537"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- It's temporary, remove once tiff decoding is better</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- handled.</span><span>
</span><span id="line-150"></span><span class="hs-comment">{-  
instance Show (Image PixelRGB16) where
    show _ = &quot;Image PixelRGB16&quot;
-}</span><span>
</span><span id="line-154"></span><span id="local-6989586621679208820"><span class="annot"><a href="Codec.Picture.Tiff.html#copyByteString"><span class="hs-identifier hs-type">copyByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208820"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679208820"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-156"></span><span id="copyByteString"><span class="annot"><span class="annottext">copyByteString :: ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#copyByteString"><span class="hs-identifier hs-var hs-var">copyByteString</span></a></span></span><span> </span><span id="local-6989586621679208532"><span class="annot"><span class="annottext">str :: ByteString
</span><a href="#local-6989586621679208532"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679208531"><span class="annot"><span class="annottext">vec :: STVector s Word8
</span><a href="#local-6989586621679208531"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span id="local-6989586621679208530"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208530"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208529"><span class="annot"><span class="annottext">startWrite :: Int
</span><a href="#local-6989586621679208529"><span class="hs-identifier hs-var">startWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208528"><span class="annot"><span class="annottext">from :: Word32
</span><a href="#local-6989586621679208528"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208527"><span class="annot"><span class="annottext">count :: Word32
</span><a href="#local-6989586621679208527"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208526"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208529"><span class="hs-identifier hs-var">startWrite</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208525"><span class="hs-identifier hs-var">fromi</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208525"><span class="annot"><span class="annottext">fromi :: Int
</span><a href="#local-6989586621679208525"><span class="hs-identifier hs-var hs-var">fromi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208528"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span id="local-6989586621679208524"><span class="annot"><span class="annottext">maxi :: Int
</span><a href="#local-6989586621679208524"><span class="hs-identifier hs-var hs-var">maxi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208525"><span class="hs-identifier hs-var">fromi</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208527"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679208526"><span class="annot"><span class="annottext">inner :: Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208526"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span id="local-6989586621679208523"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208523"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208522"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679208522"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208522"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208524"><span class="hs-identifier hs-var">maxi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208523"><span class="hs-identifier hs-var">writeIdx</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="#local-6989586621679208526"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span id="local-6989586621679208521"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208521"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208520"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679208520"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208519"><span class="annot"><span class="annottext">v :: Word8
</span><a href="#local-6989586621679208519"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208532"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><span class="hs-operator hs-var">`BU.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208520"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208531"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.unsafeWrite`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208521"><span class="hs-identifier hs-var">writeIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208519"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208526"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208521"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208530"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s Int) -&gt; Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208520"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679208516"><span class="annot"><a href="Codec.Picture.Tiff.html#unpackPackBit"><span class="hs-identifier hs-type">unpackPackBit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208516"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-167"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679208516"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-169"></span><span id="unpackPackBit"><span class="annot"><span class="annottext">unpackPackBit :: ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#unpackPackBit"><span class="hs-identifier hs-var hs-var">unpackPackBit</span></a></span></span><span> </span><span id="local-6989586621679208514"><span class="annot"><span class="annottext">str :: ByteString
</span><a href="#local-6989586621679208514"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679208513"><span class="annot"><span class="annottext">outVec :: STVector s Word8
</span><a href="#local-6989586621679208513"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span id="local-6989586621679208512"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208512"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208511"><span class="annot"><span class="annottext">writeIndex :: Int
</span><a href="#local-6989586621679208511"><span class="hs-identifier hs-var">writeIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208510"><span class="annot"><span class="annottext">offset :: Word32
</span><a href="#local-6989586621679208510"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208509"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208509"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208508"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208507"><span class="hs-identifier hs-var">fromi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208511"><span class="hs-identifier hs-var">writeIndex</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208507"><span class="annot"><span class="annottext">fromi :: Int
</span><a href="#local-6989586621679208507"><span class="hs-identifier hs-var hs-var">fromi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208510"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span id="local-6989586621679208506"><span class="annot"><span class="annottext">maxi :: Int
</span><a href="#local-6989586621679208506"><span class="hs-identifier hs-var hs-var">maxi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208507"><span class="hs-identifier hs-var">fromi</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208509"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>        </span><span id="local-6989586621679208505"><span class="annot"><span class="annottext">replicateByte :: Int -&gt; Word8 -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208505"><span class="hs-identifier hs-var hs-var">replicateByte</span></a></span></span><span> </span><span id="local-6989586621679208504"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208504"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208504"><span class="hs-identifier hs-var">writeIdx</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="#local-6989586621679208505"><span class="hs-identifier hs-var">replicateByte</span></a></span><span> </span><span id="local-6989586621679208503"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208503"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208502"><span class="annot"><span class="annottext">v :: Word8
</span><a href="#local-6989586621679208502"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679208501"><span class="annot"><span class="annottext">count :: Int
</span><a href="#local-6989586621679208501"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208513"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.unsafeWrite`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208503"><span class="hs-identifier hs-var">writeIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208502"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-176"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208505"><span class="hs-identifier hs-var">replicateByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208503"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208512"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208502"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s Int) -&gt; Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208501"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>        </span><span id="local-6989586621679208508"><span class="annot"><span class="annottext">loop :: Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208508"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679208500"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679208500"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679208499"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208499"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208500"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208506"><span class="hs-identifier hs-var">maxi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208499"><span class="hs-identifier hs-var">writeIdx</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="#local-6989586621679208508"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679208498"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679208498"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679208497"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208497"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s Int
</span><a href="#local-6989586621679208496"><span class="hs-identifier hs-var">choice</span></a></span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-comment">{-where v = fromIntegral (str `BU.unsafeIndex` i) :: Int8-}</span><span>
</span><span id="line-181"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208495"><span class="annot"><span class="annottext">v :: Int8
</span><a href="#local-6989586621679208495"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208514"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><span class="hs-operator hs-var">`B.index`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208498"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>                </span><span id="local-6989586621679208496"><span class="annot"><span class="annottext">choice :: ST s Int
</span><a href="#local-6989586621679208496"><span class="hs-identifier hs-var hs-var">choice</span></a></span></span><span>
</span><span id="line-184"></span><span>                    </span><span class="hs-comment">-- data</span><span>
</span><span id="line-185"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>    </span><span class="annot"><span class="annottext">Int8 -&gt; Int8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621679208495"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-186"></span><span>                        </span><span class="annot"><span class="annottext">ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
forall s.
ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#copyByteString"><span class="hs-identifier hs-var">copyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208514"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208513"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208512"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208497"><span class="hs-identifier hs-var">writeIdx</span></a></span><span>
</span><span id="line-187"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208498"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621679208495"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                            </span><span class="annot"><span class="annottext">ST s Int -&gt; (Int -&gt; ST s Int) -&gt; ST s Int
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208508"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208498"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621679208495"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                    </span><span class="hs-comment">-- run</span><span>
</span><span id="line-190"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">127</span></span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; Int8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621679208495"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>                        </span><span class="hs-comment">{-let nextByte = str `BU.unsafeIndex` (i + 1)-}</span><span>
</span><span id="line-192"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208492"><span class="annot"><span class="annottext">nextByte :: Word8
</span><a href="#local-6989586621679208492"><span class="hs-identifier hs-var hs-var">nextByte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208514"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><span class="hs-operator hs-var">`B.index`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208498"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                            </span><span id="local-6989586621679208491"><span class="annot"><span class="annottext">count :: Int
</span><a href="#local-6989586621679208491"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621679208495"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-194"></span><span>                        </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208505"><span class="hs-identifier hs-var">replicateByte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208497"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208492"><span class="hs-identifier hs-var">nextByte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208491"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-195"></span><span>                            </span><span class="annot"><span class="annottext">ST s Int -&gt; (Int -&gt; ST s Int) -&gt; ST s Int
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208508"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208498"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>                    </span><span class="hs-comment">-- noop</span><span>
</span><span id="line-198"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208508"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208497"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s Int) -&gt; Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208498"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679208745"><span class="annot"><a href="Codec.Picture.Tiff.html#uncompressAt"><span class="hs-identifier hs-type">uncompressAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCompression"><span class="hs-identifier hs-type">TiffCompression</span></a></span><span>
</span><span id="line-201"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208745"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679208745"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-203"></span><span id="uncompressAt"><span class="annot"><span class="annottext">uncompressAt :: TiffCompression
-&gt; ByteString
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; (Word32, Word32)
-&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#uncompressAt"><span class="hs-identifier hs-var hs-var">uncompressAt</span></a></span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionNone"><span class="hs-identifier hs-type">CompressionNone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
forall s.
ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#copyByteString"><span class="hs-identifier hs-var">copyByteString</span></a></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Codec.Picture.Tiff.html#uncompressAt"><span class="hs-identifier hs-var">uncompressAt</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionPackBit"><span class="hs-identifier hs-type">CompressionPackBit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
forall s.
ByteString
-&gt; STVector s Word8 -&gt; Int -&gt; Int -&gt; (Word32, Word32) -&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#unpackPackBit"><span class="hs-identifier hs-var">unpackPackBit</span></a></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Codec.Picture.Tiff.html#uncompressAt"><span class="hs-identifier hs-var">uncompressAt</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionLZW"><span class="hs-identifier hs-type">CompressionLZW</span></a></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-glyph">\</span><span id="local-6989586621679208486"><span class="annot"><span class="annottext">str :: ByteString
</span><a href="#local-6989586621679208486"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679208485"><span class="annot"><span class="annottext">outVec :: STVector s Word8
</span><a href="#local-6989586621679208485"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span id="local-6989586621679208484"><span class="annot"><span class="annottext">_stride :: Int
</span><a href="#local-6989586621679208484"><span class="hs-identifier hs-var">_stride</span></a></span></span><span> </span><span id="local-6989586621679208483"><span class="annot"><span class="annottext">writeIndex :: Int
</span><a href="#local-6989586621679208483"><span class="hs-identifier hs-var">writeIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208482"><span class="annot"><span class="annottext">offset :: Word32
</span><a href="#local-6989586621679208482"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208481"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208481"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208480"><span class="annot"><span class="annottext">toDecode :: ByteString
</span><a href="#local-6989586621679208480"><span class="hs-identifier hs-var hs-var">toDecode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208481"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208482"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208486"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">BoolReader s () -&gt; ST s ()
forall s a. BoolReader s a -&gt; ST s a
</span><a href="Codec.Picture.BitWriter.html#runBoolReader"><span class="hs-identifier hs-var">runBoolReader</span></a></span><span> </span><span class="annot"><span class="annottext">(BoolReader s () -&gt; ST s ()) -&gt; BoolReader s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; STVector s Word8 -&gt; Int -&gt; BoolReader s ()
forall s. ByteString -&gt; STVector s Word8 -&gt; Int -&gt; BoolReader s ()
</span><a href="Codec.Picture.Gif.Internal.LZW.html#decodeLzwTiff"><span class="hs-identifier hs-var">decodeLzwTiff</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208480"><span class="hs-identifier hs-var">toDecode</span></a></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208485"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208483"><span class="hs-identifier hs-var">writeIndex</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Codec.Picture.Tiff.html#uncompressAt"><span class="hs-identifier hs-var">uncompressAt</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ByteString
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; (Word32, Word32)
-&gt; ST s Int
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unhandled compression&quot;</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-keyword">class</span><span> </span><span id="Unpackable"><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-var">Unpackable</span></a></span></span><span> </span><span id="local-6989586621679208803"><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span id="local-6989586621679208803"><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679208809"><span id="outAlloc"><span class="annot"><a href="Codec.Picture.Tiff.html#outAlloc"><span class="hs-identifier hs-type">outAlloc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679208809"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208809"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-type">StorageType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">-- | Final image and size, return offset and vector</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679208807"><span id="allocTempBuffer"><span class="annot"><a href="Codec.Picture.Tiff.html#allocTempBuffer"><span class="hs-identifier hs-type">allocTempBuffer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208807"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-type">StorageType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-218"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679208807"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208807"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>    </span><span id="offsetStride"><span class="annot"><a href="Codec.Picture.Tiff.html#offsetStride"><span class="hs-identifier hs-type">offsetStride</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679208805"><span id="mergeBackTempBuffer"><span class="annot"><a href="Codec.Picture.Tiff.html#mergeBackTempBuffer"><span class="hs-identifier hs-type">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span><span>    </span><span class="hs-comment">-- ^ Type witness, just for the type checker.</span><span>
</span><span id="line-223"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span>
</span><span id="line-224"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208805"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-comment">-- ^ Temporary buffer handling decompression.</span><span>
</span><span id="line-225"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- ^ Line size in pixels</span><span>
</span><span id="line-226"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- ^ Write index, in bytes</span><span>
</span><span id="line-227"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>  </span><span class="hs-comment">-- ^ size, in bytes</span><span>
</span><span id="line-228"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- ^ Stride</span><span>
</span><span id="line-229"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208805"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-type">StorageType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208803"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Final buffer</span><span>
</span><span id="line-230"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679208805"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | The Word8 instance is just a passthrough, to avoid</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- copying memory twice</span><span>
</span><span id="line-234"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679208465"><span class="annot"><span class="annottext">offsetStride :: Word8 -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208465"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208464"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679208464"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679208463"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208463"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208464"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208463"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679208462"><span class="annot"><span class="annottext">allocTempBuffer :: Word8
-&gt; STVector s (StorageType Word8) -&gt; Int -&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208462"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208461"><span class="annot"><span class="annottext">buff :: STVector s (StorageType Word8)
</span><a href="#local-6989586621679208461"><span class="hs-identifier hs-var">buff</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STVector s Word8 -&gt; ST s (STVector s Word8)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
STVector s (StorageType Word8)
</span><a href="#local-6989586621679208461"><span class="hs-identifier hs-var">buff</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679208460"><span class="annot"><span class="annottext">mergeBackTempBuffer :: Word8
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Word8)
-&gt; ST s ()
</span><a href="#local-6989586621679208460"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679208459"><span class="annot"><span class="annottext">outAlloc :: Word8 -&gt; Int -&gt; ST s (STVector s (StorageType Word8))
</span><a href="#local-6989586621679208459"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208458"><span class="annot"><span class="annottext">count :: Int
</span><a href="#local-6989586621679208458"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ST s (MVector (PrimState (ST s)) Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; a -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208458"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- M.new</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679208452"><span class="annot"><span class="annottext">offsetStride :: Word16 -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208452"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679208451"><span class="annot"><span class="annottext">outAlloc :: Word16 -&gt; Int -&gt; ST s (STVector s (StorageType Word16))
</span><a href="#local-6989586621679208451"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s (StorageType Word16))
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679208449"><span class="annot"><span class="annottext">allocTempBuffer :: Word16
-&gt; STVector s (StorageType Word16)
-&gt; Int
-&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208449"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208448"><span class="annot"><span class="annottext">s :: Int
</span><a href="#local-6989586621679208448"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s (STVector s Word8)) -&gt; Int -&gt; ST s (STVector s Word8)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208448"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679208447"><span class="annot"><span class="annottext">mergeBackTempBuffer :: Word16
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Word16)
-&gt; ST s ()
</span><a href="#local-6989586621679208447"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-type">EndianLittle</span></a></span><span> </span><span id="local-6989586621679208445"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208445"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208444"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208444"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208443"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208443"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208442"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208442"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208441"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Word16)
</span><a href="#local-6989586621679208441"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208440"><span class="hs-identifier hs-var">looperLe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208444"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208440"><span class="annot"><span class="annottext">looperLe :: Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208440"><span class="hs-identifier hs-var hs-var">looperLe</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208439"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208439"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208439"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208443"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>          </span><span class="annot"><a href="#local-6989586621679208440"><span class="hs-identifier hs-var">looperLe</span></a></span><span> </span><span id="local-6989586621679208438"><span class="annot"><span class="annottext">writeIndex :: Int
</span><a href="#local-6989586621679208438"><span class="hs-identifier hs-var">writeIndex</span></a></span></span><span> </span><span id="local-6989586621679208437"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208437"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>              </span><span id="local-6989586621679208436"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208436"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208445"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208437"><span class="hs-identifier hs-var">readIndex</span></a></span><span>
</span><span id="line-253"></span><span>              </span><span id="local-6989586621679208434"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208434"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208445"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208437"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208433"><span class="annot"><span class="annottext">finalValue :: Word16
</span><a href="#local-6989586621679208433"><span class="hs-identifier hs-var hs-var">finalValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208434"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int -&gt; Word16
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208436"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-256"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Word16)
MVector (PrimState (ST s)) Word16
</span><a href="#local-6989586621679208441"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word16 -&gt; Int -&gt; Word16 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208438"><span class="hs-identifier hs-var">writeIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208433"><span class="hs-identifier hs-var">finalValue</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208440"><span class="hs-identifier hs-var">looperLe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208438"><span class="hs-identifier hs-var">writeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208442"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208437"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="Codec.Picture.Tiff.html#mergeBackTempBuffer"><span class="hs-identifier hs-var">mergeBackTempBuffer</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-type">EndianBig</span></a></span><span> </span><span id="local-6989586621679208430"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208430"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208429"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208429"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208428"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208428"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208427"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208427"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208426"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Word16)
</span><a href="#local-6989586621679208426"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>         </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208425"><span class="hs-identifier hs-var">looperBe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208429"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208425"><span class="annot"><span class="annottext">looperBe :: Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208425"><span class="hs-identifier hs-var hs-var">looperBe</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208424"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208424"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208424"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208428"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>          </span><span class="annot"><a href="#local-6989586621679208425"><span class="hs-identifier hs-var">looperBe</span></a></span><span> </span><span id="local-6989586621679208423"><span class="annot"><span class="annottext">writeIndex :: Int
</span><a href="#local-6989586621679208423"><span class="hs-identifier hs-var">writeIndex</span></a></span></span><span> </span><span id="local-6989586621679208422"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208422"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>              </span><span id="local-6989586621679208421"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208421"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208430"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208422"><span class="hs-identifier hs-var">readIndex</span></a></span><span>
</span><span id="line-264"></span><span>              </span><span id="local-6989586621679208420"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208420"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208430"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208422"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208419"><span class="annot"><span class="annottext">finalValue :: Word16
</span><a href="#local-6989586621679208419"><span class="hs-identifier hs-var hs-var">finalValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208421"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int -&gt; Word16
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208420"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-267"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Word16)
MVector (PrimState (ST s)) Word16
</span><a href="#local-6989586621679208426"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word16 -&gt; Int -&gt; Word16 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208423"><span class="hs-identifier hs-var">writeIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208419"><span class="hs-identifier hs-var">finalValue</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208425"><span class="hs-identifier hs-var">looperBe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208423"><span class="hs-identifier hs-var">writeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208427"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208422"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679208414"><span class="annot"><span class="annottext">offsetStride :: Word32 -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208414"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679208413"><span class="annot"><span class="annottext">outAlloc :: Word32 -&gt; Int -&gt; ST s (STVector s (StorageType Word32))
</span><a href="#local-6989586621679208413"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s (StorageType Word32))
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-276"></span><span>  </span><span id="local-6989586621679208412"><span class="annot"><span class="annottext">allocTempBuffer :: Word32
-&gt; STVector s (StorageType Word32)
-&gt; Int
-&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208412"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208411"><span class="annot"><span class="annottext">s :: Int
</span><a href="#local-6989586621679208411"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s (STVector s Word8)) -&gt; Int -&gt; ST s (STVector s Word8)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208411"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679208410"><span class="annot"><span class="annottext">mergeBackTempBuffer :: Word32
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Word32)
-&gt; ST s ()
</span><a href="#local-6989586621679208410"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-type">EndianLittle</span></a></span><span> </span><span id="local-6989586621679208409"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208409"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208408"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208408"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208407"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208407"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208406"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208406"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208405"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Word32)
</span><a href="#local-6989586621679208405"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208404"><span class="hs-identifier hs-var">looperLe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208408"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208404"><span class="annot"><span class="annottext">looperLe :: Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208404"><span class="hs-identifier hs-var hs-var">looperLe</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208403"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208403"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208403"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208407"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><a href="#local-6989586621679208404"><span class="hs-identifier hs-var">looperLe</span></a></span><span> </span><span id="local-6989586621679208402"><span class="annot"><span class="annottext">writeIndex :: Int
</span><a href="#local-6989586621679208402"><span class="hs-identifier hs-var">writeIndex</span></a></span></span><span> </span><span id="local-6989586621679208401"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208401"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>              </span><span id="local-6989586621679208400"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208400"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208409"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208401"><span class="hs-identifier hs-var">readIndex</span></a></span><span>
</span><span id="line-282"></span><span>              </span><span id="local-6989586621679208399"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208399"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208409"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208401"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>              </span><span id="local-6989586621679208398"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208398"><span class="hs-identifier hs-var">v3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208409"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208401"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>              </span><span id="local-6989586621679208397"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208397"><span class="hs-identifier hs-var">v4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208409"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208401"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208396"><span class="annot"><span class="annottext">finalValue :: Word32
</span><a href="#local-6989586621679208396"><span class="hs-identifier hs-var hs-var">finalValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208397"><span class="hs-identifier hs-var">v4</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-287"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208398"><span class="hs-identifier hs-var">v3</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-288"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208399"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-289"></span><span>                    </span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208400"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-290"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Word32)
MVector (PrimState (ST s)) Word32
</span><a href="#local-6989586621679208405"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word32 -&gt; Int -&gt; Word32 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208402"><span class="hs-identifier hs-var">writeIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208396"><span class="hs-identifier hs-var">finalValue</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208404"><span class="hs-identifier hs-var">looperLe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208402"><span class="hs-identifier hs-var">writeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208406"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208401"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><a href="Codec.Picture.Tiff.html#mergeBackTempBuffer"><span class="hs-identifier hs-var">mergeBackTempBuffer</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-type">EndianBig</span></a></span><span> </span><span id="local-6989586621679208395"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208395"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208394"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208394"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208393"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208393"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208392"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208392"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208391"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Word32)
</span><a href="#local-6989586621679208391"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>         </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208390"><span class="hs-identifier hs-var">looperBe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208394"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208390"><span class="annot"><span class="annottext">looperBe :: Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208390"><span class="hs-identifier hs-var hs-var">looperBe</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208389"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208389"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208389"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208393"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>          </span><span class="annot"><a href="#local-6989586621679208390"><span class="hs-identifier hs-var">looperBe</span></a></span><span> </span><span id="local-6989586621679208388"><span class="annot"><span class="annottext">writeIndex :: Int
</span><a href="#local-6989586621679208388"><span class="hs-identifier hs-var">writeIndex</span></a></span></span><span> </span><span id="local-6989586621679208387"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208387"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>              </span><span id="local-6989586621679208386"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208386"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208395"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208387"><span class="hs-identifier hs-var">readIndex</span></a></span><span>
</span><span id="line-298"></span><span>              </span><span id="local-6989586621679208385"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208385"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208395"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208387"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>              </span><span id="local-6989586621679208384"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208384"><span class="hs-identifier hs-var">v3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208395"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208387"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>              </span><span id="local-6989586621679208383"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208383"><span class="hs-identifier hs-var">v4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208395"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208387"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208382"><span class="annot"><span class="annottext">finalValue :: Word32
</span><a href="#local-6989586621679208382"><span class="hs-identifier hs-var hs-var">finalValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208386"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-303"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208385"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-304"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208384"><span class="hs-identifier hs-var">v3</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-305"></span><span>                    </span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208383"><span class="hs-identifier hs-var">v4</span></a></span><span>
</span><span id="line-306"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Word32)
MVector (PrimState (ST s)) Word32
</span><a href="#local-6989586621679208391"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word32 -&gt; Int -&gt; Word32 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208388"><span class="hs-identifier hs-var">writeIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208382"><span class="hs-identifier hs-var">finalValue</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208390"><span class="hs-identifier hs-var">looperBe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208388"><span class="hs-identifier hs-var">writeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208392"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208387"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621679208377"><span class="annot"><span class="annottext">offsetStride :: Float -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208377"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621679208376"><span class="annot"><span class="annottext">outAlloc :: Float -&gt; Int -&gt; ST s (STVector s (StorageType Float))
</span><a href="#local-6989586621679208376"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s (StorageType Float))
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621679208375"><span class="annot"><span class="annottext">allocTempBuffer :: Float
-&gt; STVector s (StorageType Float) -&gt; Int -&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208375"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208374"><span class="annot"><span class="annottext">s :: Int
</span><a href="#local-6989586621679208374"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s (STVector s Word8)) -&gt; Int -&gt; ST s (STVector s Word8)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208374"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><a href="Codec.Picture.Tiff.html#mergeBackTempBuffer"><span class="hs-identifier hs-type">mergeBackTempBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679208373"><span class="annot"><a href="#local-6989586621679208373"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-317"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span>
</span><span id="line-318"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208373"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-319"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-320"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-321"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-322"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-323"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208373"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-type">StorageType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679208373"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679208372"><span class="annot"><span class="annottext">mergeBackTempBuffer :: Float
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Float)
-&gt; ST s ()
</span><a href="#local-6989586621679208372"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208371"><span class="annot"><span class="annottext">endianness :: Endianness
</span><a href="#local-6989586621679208371"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span id="local-6989586621679208370"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208370"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span id="local-6989586621679208369"><span class="annot"><span class="annottext">lineSize :: Int
</span><a href="#local-6989586621679208369"><span class="hs-identifier hs-var">lineSize</span></a></span></span><span> </span><span id="local-6989586621679208368"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208368"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208367"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208367"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208366"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208366"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208365"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Float)
</span><a href="#local-6989586621679208365"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679208364"><span class="hs-identifier hs-type">outVecWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.STVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208373"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-327"></span><span>            </span><span id="local-6989586621679208364"><span class="annot"><span class="annottext">outVecWord32 :: STVector s Word32
</span><a href="#local-6989586621679208364"><span class="hs-identifier hs-var hs-var">outVecWord32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector s Float -&gt; STVector s Word32
forall a b s.
(Storable a, Storable b) =&gt;
MVector s a -&gt; MVector s b
</span><span class="hs-identifier hs-var">M.unsafeCast</span></span><span> </span><span class="annot"><span class="annottext">MVector s Float
STVector s (StorageType Float)
</span><a href="#local-6989586621679208365"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-328"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word32
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Word32)
-&gt; ST s ()
forall a s.
Unpackable a =&gt;
a
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType a)
-&gt; ST s ()
</span><a href="Codec.Picture.Tiff.html#mergeBackTempBuffer"><span class="hs-identifier hs-var">mergeBackTempBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>                               </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208371"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-330"></span><span>                               </span><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208370"><span class="hs-identifier hs-var">tempVec</span></a></span><span>
</span><span id="line-331"></span><span>                               </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208369"><span class="hs-identifier hs-var">lineSize</span></a></span><span>
</span><span id="line-332"></span><span>                               </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208368"><span class="hs-identifier hs-var">index</span></a></span><span>
</span><span id="line-333"></span><span>                               </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208367"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-334"></span><span>                               </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208366"><span class="hs-identifier hs-var">stride</span></a></span><span>
</span><span id="line-335"></span><span>                               </span><span class="annot"><span class="annottext">STVector s Word32
STVector s (StorageType Word32)
</span><a href="#local-6989586621679208364"><span class="hs-identifier hs-var">outVecWord32</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-keyword">data</span><span> </span><span id="Pack4"><span class="annot"><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-var">Pack4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Pack4"><span class="annot"><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-var">Pack4</span></a></span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-type">Pack4</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-type">Pack4</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679208357"><span class="annot"><span class="annottext">allocTempBuffer :: Pack4
-&gt; STVector s (StorageType Pack4) -&gt; Int -&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208357"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679208356"><span class="annot"><span class="annottext">offsetStride :: Pack4 -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208356"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621679208355"><span class="annot"><span class="annottext">outAlloc :: Pack4 -&gt; Int -&gt; ST s (STVector s (StorageType Pack4))
</span><a href="#local-6989586621679208355"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s (StorageType Pack4))
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621679208354"><span class="annot"><span class="annottext">mergeBackTempBuffer :: Pack4
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Pack4)
-&gt; ST s ()
</span><a href="#local-6989586621679208354"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208353"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208353"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span id="local-6989586621679208352"><span class="annot"><span class="annottext">lineSize :: Int
</span><a href="#local-6989586621679208352"><span class="hs-identifier hs-var">lineSize</span></a></span></span><span> </span><span id="local-6989586621679208351"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208351"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208350"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208350"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208349"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208349"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208348"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Pack4)
</span><a href="#local-6989586621679208348"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208347"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208351"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208346"><span class="hs-identifier hs-var">pxCount</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208346"><span class="annot"><span class="annottext">pxCount :: Int
</span><a href="#local-6989586621679208346"><span class="hs-identifier hs-var hs-var">pxCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208352"><span class="hs-identifier hs-var">lineSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208349"><span class="hs-identifier hs-var">stride</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>          </span><span id="local-6989586621679208345"><span class="annot"><span class="annottext">maxWrite :: Int
</span><a href="#local-6989586621679208345"><span class="hs-identifier hs-var hs-var">maxWrite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STVector s Word8 -&gt; Int
forall a s. Storable a =&gt; MVector s a -&gt; Int
</span><span class="hs-identifier hs-var">M.length</span></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
STVector s (StorageType Pack4)
</span><a href="#local-6989586621679208348"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span id="local-6989586621679208347"><span class="annot"><span class="annottext">inner :: Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208347"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span id="local-6989586621679208343"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208343"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208342"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208342"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>
</span><span id="line-350"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208343"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208350"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208342"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208345"><span class="hs-identifier hs-var">maxWrite</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>          </span><span class="annot"><a href="#local-6989586621679208347"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span id="local-6989586621679208340"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208340"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208339"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208339"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208338"><span class="annot"><span class="annottext">line :: Int
</span><a href="#local-6989586621679208338"><span class="hs-identifier hs-var">line</span></a></span></span><span>
</span><span id="line-352"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208338"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208347"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208340"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208339"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208338"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208349"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208346"><span class="hs-identifier hs-var">pxCount</span></a></span><span>
</span><span id="line-353"></span><span>          </span><span class="annot"><a href="#local-6989586621679208347"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span id="local-6989586621679208337"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208337"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208336"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208336"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208335"><span class="annot"><span class="annottext">line :: Int
</span><a href="#local-6989586621679208335"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>            </span><span id="local-6989586621679208334"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208334"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208353"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208337"><span class="hs-identifier hs-var">readIdx</span></a></span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208333"><span class="annot"><span class="annottext">high :: Word8
</span><a href="#local-6989586621679208333"><span class="hs-identifier hs-var hs-var">high</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208334"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0xF</span></span><span>
</span><span id="line-356"></span><span>                </span><span id="local-6989586621679208332"><span class="annot"><span class="annottext">low :: Word8
</span><a href="#local-6989586621679208332"><span class="hs-identifier hs-var hs-var">low</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208334"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0xF</span></span><span>
</span><span id="line-357"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack4)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208348"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208336"><span class="hs-identifier hs-var">writeIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208333"><span class="hs-identifier hs-var">high</span></a></span><span>
</span><span id="line-358"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208336"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208349"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208345"><span class="hs-identifier hs-var">maxWrite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-359"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack4)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208348"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208336"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208349"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208332"><span class="hs-identifier hs-var">low</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208347"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208337"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208336"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208349"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208335"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-keyword">data</span><span> </span><span id="Pack2"><span class="annot"><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-var">Pack2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Pack2"><span class="annot"><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-var">Pack2</span></a></span></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-type">Pack2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-type">Pack2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621679208325"><span class="annot"><span class="annottext">allocTempBuffer :: Pack2
-&gt; STVector s (StorageType Pack2) -&gt; Int -&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208325"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679208324"><span class="annot"><span class="annottext">offsetStride :: Pack2 -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208324"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679208323"><span class="annot"><span class="annottext">outAlloc :: Pack2 -&gt; Int -&gt; ST s (STVector s (StorageType Pack2))
</span><a href="#local-6989586621679208323"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s (StorageType Pack2))
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679208322"><span class="annot"><span class="annottext">mergeBackTempBuffer :: Pack2
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Pack2)
-&gt; ST s ()
</span><a href="#local-6989586621679208322"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208321"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208321"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span id="local-6989586621679208320"><span class="annot"><span class="annottext">lineSize :: Int
</span><a href="#local-6989586621679208320"><span class="hs-identifier hs-var">lineSize</span></a></span></span><span> </span><span id="local-6989586621679208319"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208319"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208318"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208318"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208317"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208316"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Pack2)
</span><a href="#local-6989586621679208316"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208315"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208319"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208314"><span class="hs-identifier hs-var">pxCount</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208314"><span class="annot"><span class="annottext">pxCount :: Int
</span><a href="#local-6989586621679208314"><span class="hs-identifier hs-var hs-var">pxCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208320"><span class="hs-identifier hs-var">lineSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>          </span><span id="local-6989586621679208313"><span class="annot"><span class="annottext">maxWrite :: Int
</span><a href="#local-6989586621679208313"><span class="hs-identifier hs-var hs-var">maxWrite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STVector s Word8 -&gt; Int
forall a s. Storable a =&gt; MVector s a -&gt; Int
</span><span class="hs-identifier hs-var">M.length</span></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
STVector s (StorageType Pack2)
</span><a href="#local-6989586621679208316"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-375"></span><span>          </span><span id="local-6989586621679208315"><span class="annot"><span class="annottext">inner :: Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208315"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span id="local-6989586621679208312"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208312"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208311"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208311"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208312"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208318"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208311"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208313"><span class="hs-identifier hs-var">maxWrite</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>          </span><span class="annot"><a href="#local-6989586621679208315"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span id="local-6989586621679208310"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208310"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208309"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208309"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208308"><span class="annot"><span class="annottext">line :: Int
</span><a href="#local-6989586621679208308"><span class="hs-identifier hs-var">line</span></a></span></span><span>
</span><span id="line-378"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208308"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208315"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208310"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208309"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208308"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208314"><span class="hs-identifier hs-var">pxCount</span></a></span><span>
</span><span id="line-379"></span><span>          </span><span class="annot"><a href="#local-6989586621679208315"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span id="local-6989586621679208307"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208307"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208306"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208305"><span class="annot"><span class="annottext">line :: Int
</span><a href="#local-6989586621679208305"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>            </span><span id="local-6989586621679208304"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208304"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208321"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208307"><span class="hs-identifier hs-var">readIdx</span></a></span><span>
</span><span id="line-381"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208303"><span class="annot"><span class="annottext">v0 :: Word8
</span><a href="#local-6989586621679208303"><span class="hs-identifier hs-var hs-var">v0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="hs-number">6</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0x3</span></span><span>
</span><span id="line-382"></span><span>                </span><span id="local-6989586621679208302"><span class="annot"><span class="annottext">v1 :: Word8
</span><a href="#local-6989586621679208302"><span class="hs-identifier hs-var hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0x3</span></span><span>
</span><span id="line-383"></span><span>                </span><span id="local-6989586621679208301"><span class="annot"><span class="annottext">v2 :: Word8
</span><a href="#local-6989586621679208301"><span class="hs-identifier hs-var hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0x3</span></span><span>
</span><span id="line-384"></span><span>                </span><span id="local-6989586621679208300"><span class="annot"><span class="annottext">v3 :: Word8
</span><a href="#local-6989586621679208300"><span class="hs-identifier hs-var hs-var">v3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0x3</span></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack2)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208316"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208303"><span class="hs-identifier hs-var">v0</span></a></span><span>
</span><span id="line-387"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208313"><span class="hs-identifier hs-var">maxWrite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-388"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack2)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208316"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208302"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208313"><span class="hs-identifier hs-var">maxWrite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-391"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack2)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208316"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208301"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208313"><span class="hs-identifier hs-var">maxWrite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-394"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack2)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208316"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208300"><span class="hs-identifier hs-var">v3</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208315"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208307"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208306"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208317"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208305"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-keyword">data</span><span> </span><span id="Pack12"><span class="annot"><a href="Codec.Picture.Tiff.html#Pack12"><span class="hs-identifier hs-var">Pack12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Pack12"><span class="annot"><a href="Codec.Picture.Tiff.html#Pack12"><span class="hs-identifier hs-var">Pack12</span></a></span></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Pack12"><span class="hs-identifier hs-type">Pack12</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Pack12"><span class="hs-identifier hs-type">Pack12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621679208294"><span class="annot"><span class="annottext">allocTempBuffer :: Pack12
-&gt; STVector s (StorageType Pack12)
-&gt; Int
-&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208294"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679208293"><span class="annot"><span class="annottext">offsetStride :: Pack12 -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208293"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679208292"><span class="annot"><span class="annottext">outAlloc :: Pack12 -&gt; Int -&gt; ST s (STVector s (StorageType Pack12))
</span><a href="#local-6989586621679208292"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s (StorageType Pack12))
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621679208291"><span class="annot"><span class="annottext">mergeBackTempBuffer :: Pack12
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType Pack12)
-&gt; ST s ()
</span><a href="#local-6989586621679208291"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208290"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208290"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span id="local-6989586621679208289"><span class="annot"><span class="annottext">lineSize :: Int
</span><a href="#local-6989586621679208289"><span class="hs-identifier hs-var">lineSize</span></a></span></span><span> </span><span id="local-6989586621679208288"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208288"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208287"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208287"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679208286"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208286"><span class="hs-identifier hs-var">stride</span></a></span></span><span> </span><span id="local-6989586621679208285"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType Pack12)
</span><a href="#local-6989586621679208285"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208284"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208288"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208283"><span class="hs-identifier hs-var">pxCount</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208283"><span class="annot"><span class="annottext">pxCount :: Int
</span><a href="#local-6989586621679208283"><span class="hs-identifier hs-var hs-var">pxCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208289"><span class="hs-identifier hs-var">lineSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208286"><span class="hs-identifier hs-var">stride</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>          </span><span id="local-6989586621679208282"><span class="annot"><span class="annottext">maxWrite :: Int
</span><a href="#local-6989586621679208282"><span class="hs-identifier hs-var hs-var">maxWrite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector s Word16 -&gt; Int
forall a s. Storable a =&gt; MVector s a -&gt; Int
</span><span class="hs-identifier hs-var">M.length</span></span><span> </span><span class="annot"><span class="annottext">MVector s Word16
STVector s (StorageType Pack12)
</span><a href="#local-6989586621679208285"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-410"></span><span>          </span><span id="local-6989586621679208284"><span class="annot"><span class="annottext">inner :: Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208284"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span id="local-6989586621679208281"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208281"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208280"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208280"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>
</span><span id="line-411"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208281"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208287"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208280"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208282"><span class="hs-identifier hs-var">maxWrite</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>          </span><span class="annot"><a href="#local-6989586621679208284"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span id="local-6989586621679208279"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208279"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208278"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208278"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208277"><span class="annot"><span class="annottext">line :: Int
</span><a href="#local-6989586621679208277"><span class="hs-identifier hs-var">line</span></a></span></span><span>
</span><span id="line-413"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208277"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208284"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208279"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208278"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208277"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208286"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208283"><span class="hs-identifier hs-var">pxCount</span></a></span><span>
</span><span id="line-414"></span><span>          </span><span class="annot"><a href="#local-6989586621679208284"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span id="local-6989586621679208276"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208276"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span id="local-6989586621679208275"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208275"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span id="local-6989586621679208274"><span class="annot"><span class="annottext">line :: Int
</span><a href="#local-6989586621679208274"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-415"></span><span>            </span><span id="local-6989586621679208273"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208273"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208290"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208276"><span class="hs-identifier hs-var">readIdx</span></a></span><span>
</span><span id="line-416"></span><span>            </span><span id="local-6989586621679208272"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208272"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208276"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208287"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-417"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208290"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208276"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ST s Word8
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-419"></span><span>            </span><span id="local-6989586621679208271"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208271"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208276"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208287"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-420"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208290"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208276"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ST s Word8
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208270"><span class="annot"><span class="annottext">high0 :: Word16
</span><a href="#local-6989586621679208270"><span class="hs-identifier hs-var hs-var">high0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208273"><span class="hs-identifier hs-var">v0</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int -&gt; Word16
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span>
</span><span id="line-424"></span><span>                </span><span id="local-6989586621679208269"><span class="annot"><span class="annottext">low0 :: Word16
</span><a href="#local-6989586621679208269"><span class="hs-identifier hs-var hs-var">low0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208272"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int -&gt; Word16
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0xF</span></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span>                </span><span id="local-6989586621679208268"><span class="annot"><span class="annottext">p0 :: Word16
</span><a href="#local-6989586621679208268"><span class="hs-identifier hs-var hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208270"><span class="hs-identifier hs-var">high0</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208269"><span class="hs-identifier hs-var">low0</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>                </span><span id="local-6989586621679208267"><span class="annot"><span class="annottext">high1 :: Word16
</span><a href="#local-6989586621679208267"><span class="hs-identifier hs-var hs-var">high1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208272"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="hs-number">0xF</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int -&gt; Word16
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-429"></span><span>                </span><span id="local-6989586621679208266"><span class="annot"><span class="annottext">low1 :: Word16
</span><a href="#local-6989586621679208266"><span class="hs-identifier hs-var hs-var">low1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208271"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-430"></span><span>                </span><span id="local-6989586621679208265"><span class="annot"><span class="annottext">p1 :: Word16
</span><a href="#local-6989586621679208265"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208267"><span class="hs-identifier hs-var">high1</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208266"><span class="hs-identifier hs-var">low1</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack12)
MVector (PrimState (ST s)) Word16
</span><a href="#local-6989586621679208285"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word16 -&gt; Int -&gt; Word16 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208275"><span class="hs-identifier hs-var">writeIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208268"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208275"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208286"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208282"><span class="hs-identifier hs-var">maxWrite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-434"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType Pack12)
MVector (PrimState (ST s)) Word16
</span><a href="#local-6989586621679208285"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word16 -&gt; Int -&gt; Word16 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208275"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208286"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208265"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; ST s ()
</span><a href="#local-6989586621679208284"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208276"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208275"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208286"><span class="hs-identifier hs-var">stride</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208274"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-keyword">data</span><span> </span><span id="YCbCrSubsampling"><span class="annot"><a href="Codec.Picture.Tiff.html#YCbCrSubsampling"><span class="hs-identifier hs-var">YCbCrSubsampling</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="YCbCrSubsampling"><span class="annot"><a href="Codec.Picture.Tiff.html#YCbCrSubsampling"><span class="hs-identifier hs-var">YCbCrSubsampling</span></a></span></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="ycbcrWidth"><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrWidth"><span class="hs-identifier hs-var hs-var">ycbcrWidth</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ycbcrHeight"><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrHeight"><span class="hs-identifier hs-var hs-var">ycbcrHeight</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ycbcrImageWidth"><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrImageWidth"><span class="hs-identifier hs-var hs-var">ycbcrImageWidth</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ycbcrStripHeight"><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrStripHeight"><span class="hs-identifier hs-var hs-var">ycbcrStripHeight</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#YCbCrSubsampling"><span class="hs-identifier hs-type">YCbCrSubsampling</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StorageType"><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-var">StorageType</span></a></span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#YCbCrSubsampling"><span class="hs-identifier hs-type">YCbCrSubsampling</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621679208255"><span class="annot"><span class="annottext">offsetStride :: YCbCrSubsampling -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679208255"><span class="hs-identifier hs-var hs-var hs-var hs-var">offsetStride</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621679208254"><span class="annot"><span class="annottext">outAlloc :: YCbCrSubsampling
-&gt; Int -&gt; ST s (STVector s (StorageType YCbCrSubsampling))
</span><a href="#local-6989586621679208254"><span class="hs-identifier hs-var hs-var hs-var hs-var">outAlloc</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s (StorageType YCbCrSubsampling))
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-450"></span><span>  </span><span id="local-6989586621679208253"><span class="annot"><span class="annottext">allocTempBuffer :: YCbCrSubsampling
-&gt; STVector s (StorageType YCbCrSubsampling)
-&gt; Int
-&gt; ST s (STVector s Word8)
</span><a href="#local-6989586621679208253"><span class="hs-identifier hs-var hs-var hs-var hs-var">allocTempBuffer</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (STVector s Word8)
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">M.new</span></span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621679208252"><span class="annot"><span class="annottext">mergeBackTempBuffer :: YCbCrSubsampling
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType YCbCrSubsampling)
-&gt; ST s ()
</span><a href="#local-6989586621679208252"><span class="hs-identifier hs-var hs-var hs-var hs-var">mergeBackTempBuffer</span></a></span></span><span> </span><span id="local-6989586621679208251"><span class="annot"><span class="annottext">subSampling :: YCbCrSubsampling
</span><a href="#local-6989586621679208251"><span class="hs-identifier hs-var">subSampling</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208250"><span class="annot"><span class="annottext">tempVec :: STVector s Word8
</span><a href="#local-6989586621679208250"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208249"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679208249"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679208248"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208248"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208247"><span class="annot"><span class="annottext">outVec :: STVector s (StorageType YCbCrSubsampling)
</span><a href="#local-6989586621679208247"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-452"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; (Int, Int) -&gt; ST s Int) -&gt; Int -&gt; [(Int, Int)] -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">foldM_</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; ST s Int
</span><a href="#local-6989586621679208246"><span class="hs-identifier hs-var">unpacker</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208245"><span class="hs-identifier hs-var">bx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208244"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679208244"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208244"><span class="hs-identifier hs-var">by</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208243"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208242"><span class="hs-identifier hs-var">lineCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208245"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208245"><span class="hs-identifier hs-var">bx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208241"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208240"><span class="hs-identifier hs-var">imgWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208241"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679208241"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrWidth"><span class="hs-identifier hs-var hs-var">ycbcrWidth</span></a></span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling
</span><a href="#local-6989586621679208251"><span class="hs-identifier hs-var">subSampling</span></a></span><span>
</span><span id="line-455"></span><span>          </span><span id="local-6989586621679208243"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679208243"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrHeight"><span class="hs-identifier hs-var hs-var">ycbcrHeight</span></a></span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling
</span><a href="#local-6989586621679208251"><span class="hs-identifier hs-var">subSampling</span></a></span><span>
</span><span id="line-456"></span><span>          </span><span id="local-6989586621679208240"><span class="annot"><span class="annottext">imgWidth :: Int
</span><a href="#local-6989586621679208240"><span class="hs-identifier hs-var hs-var">imgWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrImageWidth"><span class="hs-identifier hs-var hs-var">ycbcrImageWidth</span></a></span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling
</span><a href="#local-6989586621679208251"><span class="hs-identifier hs-var">subSampling</span></a></span><span>
</span><span id="line-457"></span><span>          </span><span id="local-6989586621679208242"><span class="annot"><span class="annottext">lineCount :: Int
</span><a href="#local-6989586621679208242"><span class="hs-identifier hs-var hs-var">lineCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; Int
</span><a href="Codec.Picture.Tiff.html#ycbcrStripHeight"><span class="hs-identifier hs-var hs-var">ycbcrStripHeight</span></a></span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling
</span><a href="#local-6989586621679208251"><span class="hs-identifier hs-var">subSampling</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span>          </span><span id="local-6989586621679208239"><span class="annot"><span class="annottext">lumaCount :: Int
</span><a href="#local-6989586621679208239"><span class="hs-identifier hs-var hs-var">lumaCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208241"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208243"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-460"></span><span>          </span><span id="local-6989586621679208238"><span class="annot"><span class="annottext">blockSize :: Int
</span><a href="#local-6989586621679208238"><span class="hs-identifier hs-var hs-var">blockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208239"><span class="hs-identifier hs-var">lumaCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span>          </span><span id="local-6989586621679208237"><span class="annot"><span class="annottext">maxOut :: Int
</span><a href="#local-6989586621679208237"><span class="hs-identifier hs-var hs-var">maxOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STVector s Word8 -&gt; Int
forall a s. Storable a =&gt; MVector s a -&gt; Int
</span><span class="hs-identifier hs-var">M.length</span></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
STVector s (StorageType YCbCrSubsampling)
</span><a href="#local-6989586621679208247"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>          </span><span id="local-6989586621679208246"><span class="annot"><span class="annottext">unpacker :: Int -&gt; (Int, Int) -&gt; ST s Int
</span><a href="#local-6989586621679208246"><span class="hs-identifier hs-var hs-var">unpacker</span></a></span></span><span> </span><span id="local-6989586621679208236"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208236"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208236"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208248"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208236"><span class="hs-identifier hs-var">readIdx</span></a></span><span>
</span><span id="line-465"></span><span>          </span><span class="annot"><a href="#local-6989586621679208246"><span class="hs-identifier hs-var">unpacker</span></a></span><span> </span><span id="local-6989586621679208235"><span class="annot"><span class="annottext">readIdx :: Int
</span><a href="#local-6989586621679208235"><span class="hs-identifier hs-var">readIdx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208234"><span class="annot"><span class="annottext">bx :: Int
</span><a href="#local-6989586621679208234"><span class="hs-identifier hs-var">bx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208233"><span class="annot"><span class="annottext">by :: Int
</span><a href="#local-6989586621679208233"><span class="hs-identifier hs-var">by</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>              </span><span id="local-6989586621679208232"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208232"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208250"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208235"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208239"><span class="hs-identifier hs-var">lumaCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>              </span><span id="local-6989586621679208231"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208231"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208250"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208235"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208239"><span class="hs-identifier hs-var">lumaCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208230"><span class="annot"><span class="annottext">pixelIndices :: [Int]
</span><a href="#local-6989586621679208230"><span class="hs-identifier hs-var hs-var">pixelIndices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>                        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208249"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208233"><span class="hs-identifier hs-var">by</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208229"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208240"><span class="hs-identifier hs-var">imgWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208234"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208228"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679208229"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208229"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208243"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208228"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208228"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208241"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span>                  </span><span id="local-6989586621679208227"><span class="annot"><span class="annottext">writer :: Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208227"><span class="hs-identifier hs-var hs-var">writer</span></a></span></span><span> </span><span id="local-6989586621679208226"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208226"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span id="local-6989586621679208225"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208225"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208225"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208237"><span class="hs-identifier hs-var">maxOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208226"><span class="hs-identifier hs-var">readIndex</span></a></span><span>
</span><span id="line-473"></span><span>                  </span><span class="annot"><a href="#local-6989586621679208227"><span class="hs-identifier hs-var">writer</span></a></span><span> </span><span id="local-6989586621679208223"><span class="annot"><span class="annottext">readIndex :: Int
</span><a href="#local-6989586621679208223"><span class="hs-identifier hs-var">readIndex</span></a></span></span><span> </span><span id="local-6989586621679208222"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208222"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-474"></span><span>                    </span><span id="local-6989586621679208221"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208221"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STVector s Word8
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208250"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; ST s Word8
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; m a
</span><span class="hs-operator hs-var">`M.read`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208223"><span class="hs-identifier hs-var">readIndex</span></a></span><span>
</span><span id="line-475"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType YCbCrSubsampling)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208247"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208222"><span class="hs-identifier hs-var">writeIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208221"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-476"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType YCbCrSubsampling)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208247"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208222"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208232"><span class="hs-identifier hs-var">cb</span></a></span><span>
</span><span id="line-477"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STVector s (StorageType YCbCrSubsampling)
MVector (PrimState (ST s)) Word8
</span><a href="#local-6989586621679208247"><span class="hs-identifier hs-var">outVec</span></a></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) Word8 -&gt; Int -&gt; Word8 -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Storable a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-operator hs-var">`M.write`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208222"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208231"><span class="hs-identifier hs-var">cr</span></a></span><span>
</span><span id="line-478"></span><span>                    </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s Int) -&gt; Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208223"><span class="hs-identifier hs-var">readIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>              </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; ST s Int) -&gt; Int -&gt; [Int] -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">foldM_</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679208227"><span class="hs-identifier hs-var">writer</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208235"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679208230"><span class="hs-identifier hs-var">pixelIndices</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s Int) -&gt; Int -&gt; ST s Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208235"><span class="hs-identifier hs-var">readIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208238"><span class="hs-identifier hs-var">blockSize</span></a></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span id="local-6989586621679208685"><span id="local-6989586621679208686"><span class="annot"><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-type">gatherStrips</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#Unpackable"><span class="hs-identifier hs-type">Unpackable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208686"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-485"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Pixel"><span class="hs-identifier hs-type">Pixel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208685"><span class="hs-identifier hs-type">pixel</span></a></span><span>
</span><span id="line-486"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#StorageType"><span class="hs-identifier hs-type">StorageType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208686"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelBaseComponent"><span class="hs-identifier hs-type">PixelBaseComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208685"><span class="hs-identifier hs-type">pixel</span></a></span><span>
</span><span id="line-487"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679208686"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208685"><span class="hs-identifier hs-type">pixel</span></a></span></span></span><span>
</span><span id="line-489"></span><span id="gatherStrips"><span class="annot"><span class="annottext">gatherStrips :: comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var hs-var">gatherStrips</span></a></span></span><span> </span><span id="local-6989586621679208219"><span class="annot"><span class="annottext">comp :: comp
</span><a href="#local-6989586621679208219"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679208218"><span class="annot"><span class="annottext">str :: ByteString
</span><a href="#local-6989586621679208218"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679208217"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (Image pixel)) -&gt; Image pixel
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (Image pixel)) -&gt; Image pixel)
-&gt; (forall s. ST s (Image pixel)) -&gt; Image pixel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208216"><span class="annot"><span class="annottext">width :: Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int) -&gt; Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffWidth"><span class="hs-identifier hs-var hs-var">tiffWidth</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-491"></span><span>      </span><span id="local-6989586621679208215"><span class="annot"><span class="annottext">height :: Int
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int) -&gt; Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffHeight"><span class="hs-identifier hs-var hs-var">tiffHeight</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-492"></span><span>      </span><span id="local-6989586621679208214"><span class="annot"><span class="annottext">sampleCount :: Int
</span><a href="#local-6989586621679208214"><span class="hs-identifier hs-var hs-var">sampleCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffSampleCount"><span class="hs-identifier hs-var hs-var">tiffSampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-493"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int) -&gt; Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffSampleCount"><span class="hs-identifier hs-var hs-var">tiffSampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-494"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Int) -&gt; Vector Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span>      </span><span id="local-6989586621679208212"><span class="annot"><span class="annottext">rowPerStrip :: Int
</span><a href="#local-6989586621679208212"><span class="hs-identifier hs-var hs-var">rowPerStrip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int) -&gt; Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffRowPerStrip"><span class="hs-identifier hs-var hs-var">tiffRowPerStrip</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-497"></span><span>      </span><span id="local-6989586621679208211"><span class="annot"><span class="annottext">endianness :: Endianness
</span><a href="#local-6989586621679208211"><span class="hs-identifier hs-var hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffHeader -&gt; Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrEndianness"><span class="hs-identifier hs-var hs-var">hdrEndianness</span></a></span><span> </span><span class="annot"><span class="annottext">(TiffHeader -&gt; Endianness) -&gt; TiffHeader -&gt; Endianness
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffHeader
</span><a href="Codec.Picture.Tiff.html#tiffHeader"><span class="hs-identifier hs-var hs-var">tiffHeader</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>      </span><span id="local-6989586621679208209"><span class="annot"><span class="annottext">stripCount :: Int
</span><a href="#local-6989586621679208209"><span class="hs-identifier hs-var hs-var">stripCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Int) -&gt; Vector Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffOffsets"><span class="hs-identifier hs-var hs-var">tiffOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-500"></span><span>      </span><span id="local-6989586621679208208"><span class="annot"><span class="annottext">compression :: TiffCompression
</span><a href="#local-6989586621679208208"><span class="hs-identifier hs-var hs-var">compression</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffCompression
</span><a href="Codec.Picture.Tiff.html#tiffCompression"><span class="hs-identifier hs-var hs-var">tiffCompression</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621679208207"><span class="annot"><span class="annottext">MVector s (PixelBaseComponent pixel)
</span><a href="#local-6989586621679208207"><span class="hs-identifier hs-var">outVec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">comp -&gt; Int -&gt; ST s (STVector s (StorageType comp))
forall a s.
Unpackable a =&gt;
a -&gt; Int -&gt; ST s (STVector s (StorageType a))
</span><a href="Codec.Picture.Tiff.html#outAlloc"><span class="hs-identifier hs-var">outAlloc</span></a></span><span> </span><span class="annot"><span class="annottext">comp
</span><a href="#local-6989586621679208219"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s (MVector s (PixelBaseComponent pixel)))
-&gt; Int -&gt; ST s (MVector s (PixelBaseComponent pixel))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208214"><span class="hs-identifier hs-var">sampleCount</span></a></span><span>
</span><span id="line-503"></span><span>  </span><span id="local-6989586621679208206"><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208206"><span class="hs-identifier hs-var">tempVec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">comp
-&gt; STVector s (StorageType comp) -&gt; Int -&gt; ST s (STVector s Word8)
forall a s.
Unpackable a =&gt;
a -&gt; STVector s (StorageType a) -&gt; Int -&gt; ST s (STVector s Word8)
</span><a href="Codec.Picture.Tiff.html#allocTempBuffer"><span class="hs-identifier hs-var">allocTempBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">comp
</span><a href="#local-6989586621679208219"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s (PixelBaseComponent pixel)
STVector s (StorageType comp)
</span><a href="#local-6989586621679208207"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-504"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208212"><span class="hs-identifier hs-var">rowPerStrip</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208214"><span class="hs-identifier hs-var">sampleCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208205"><span class="annot"><span class="annottext">mutableImage :: MutableImage s pixel
</span><a href="#local-6989586621679208205"><span class="hs-identifier hs-var hs-var">mutableImage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">$WMutableImage :: forall s a.
Int -&gt; Int -&gt; STVector s (PixelBaseComponent a) -&gt; MutableImage s a
</span><a href="Codec.Picture.Types.html#%24WMutableImage"><span class="hs-identifier hs-type hs-type">MutableImage</span></a></span><span>
</span><span id="line-507"></span><span>                   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mutableImageWidth :: Int
</span><a href="Codec.Picture.Types.html#mutableImageWidth"><span class="hs-identifier hs-var">mutableImageWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-508"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mutableImageHeight :: Int
</span><a href="Codec.Picture.Types.html#mutableImageHeight"><span class="hs-identifier hs-var">mutableImageHeight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">height</span></a></span><span>
</span><span id="line-509"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mutableImageData :: MVector s (PixelBaseComponent pixel)
</span><a href="Codec.Picture.Types.html#mutableImageData"><span class="hs-identifier hs-var">mutableImageData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector s (PixelBaseComponent pixel)
</span><a href="#local-6989586621679208207"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-510"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.html#tiffPlaneConfiguration"><span class="hs-identifier hs-var hs-var">tiffPlaneConfiguration</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigContig"><span class="hs-identifier hs-type">PlanarConfigContig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Int, Int, Word32, Word32) -&gt; ST s ())
-&gt; Vector (Int, Int, Word32, Word32) -&gt; ST s ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Vector a -&gt; m ()
</span><span class="hs-identifier hs-var">V.mapM_</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int, Word32, Word32) -&gt; ST s ()
</span><a href="#local-6989586621679208197"><span class="hs-identifier hs-var">unpacker</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Int, Int, Word32, Word32)
</span><a href="#local-6989586621679208196"><span class="hs-identifier hs-var">sizes</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208197"><span class="annot"><span class="annottext">unpacker :: (Int, Int, Word32, Word32) -&gt; ST s ()
</span><a href="#local-6989586621679208197"><span class="hs-identifier hs-var hs-var">unpacker</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208195"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679208195"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208194"><span class="annot"><span class="annottext">stripSampleCount :: Int
</span><a href="#local-6989586621679208194"><span class="hs-identifier hs-var">stripSampleCount</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208193"><span class="annot"><span class="annottext">offset :: Word32
</span><a href="#local-6989586621679208193"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208192"><span class="annot"><span class="annottext">packedSize :: Word32
</span><a href="#local-6989586621679208192"><span class="hs-identifier hs-var">packedSize</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-515"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208191"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208191"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208190"><span class="annot"><span class="annottext">tempStride :: Int
</span><a href="#local-6989586621679208190"><span class="hs-identifier hs-var">tempStride</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">comp -&gt; Int -&gt; Int -&gt; (Int, Int)
forall a. Unpackable a =&gt; a -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="Codec.Picture.Tiff.html#offsetStride"><span class="hs-identifier hs-var">offsetStride</span></a></span><span> </span><span class="annot"><span class="annottext">comp
</span><a href="#local-6989586621679208219"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208195"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-516"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TiffCompression
-&gt; ByteString
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; (Word32, Word32)
-&gt; ST s Int
forall s.
TiffCompression
-&gt; ByteString
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; (Word32, Word32)
-&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#uncompressAt"><span class="hs-identifier hs-var">uncompressAt</span></a></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="#local-6989586621679208208"><span class="hs-identifier hs-var">compression</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208218"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208206"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208190"><span class="hs-identifier hs-var">tempStride</span></a></span><span>
</span><span id="line-517"></span><span>                                    </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208191"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208193"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208192"><span class="hs-identifier hs-var">packedSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208736"><span id="local-6989586621679208737"><span class="annot"><a href="#local-6989586621679208189"><span class="hs-identifier hs-type">typ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.MVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679208737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679208736"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-519"></span><span>                      </span><span id="local-6989586621679208189"><span class="annot"><span class="annottext">typ :: MVector s a -&gt; a
</span><a href="#local-6989586621679208189"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; MVector s a -&gt; a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-520"></span><span>                      </span><span id="local-6989586621679208186"><span class="annot"><span class="annottext">sampleSize :: Int
</span><a href="#local-6989586621679208186"><span class="hs-identifier hs-var hs-var">sampleSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PixelBaseComponent pixel -&gt; Int
forall a. Storable a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">sizeOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MVector s (PixelBaseComponent pixel) -&gt; PixelBaseComponent pixel
forall s a. MVector s a -&gt; a
</span><a href="#local-6989586621679208189"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s (PixelBaseComponent pixel)
</span><a href="#local-6989586621679208207"><span class="hs-identifier hs-var">outVec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>                  </span><span class="annot"><span class="annottext">comp
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType comp)
-&gt; ST s ()
forall a s.
Unpackable a =&gt;
a
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType a)
-&gt; ST s ()
</span><a href="Codec.Picture.Tiff.html#mergeBackTempBuffer"><span class="hs-identifier hs-var">mergeBackTempBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">comp
</span><a href="#local-6989586621679208219"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208211"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208206"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208214"><span class="hs-identifier hs-var">sampleCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>                                      </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208195"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208194"><span class="hs-identifier hs-var">stripSampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208186"><span class="hs-identifier hs-var">sampleSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">MVector s (PixelBaseComponent pixel)
STVector s (StorageType comp)
</span><a href="#local-6989586621679208207"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span>              </span><span id="local-6989586621679208185"><span class="annot"><span class="annottext">fullStripSampleCount :: Int
</span><a href="#local-6989586621679208185"><span class="hs-identifier hs-var hs-var">fullStripSampleCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208212"><span class="hs-identifier hs-var">rowPerStrip</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208214"><span class="hs-identifier hs-var">sampleCount</span></a></span><span>
</span><span id="line-526"></span><span>              </span><span id="local-6989586621679208184"><span class="annot"><span class="annottext">startWriteOffset :: Vector Int
</span><a href="#local-6989586621679208184"><span class="hs-identifier hs-var hs-var">startWriteOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Int) -&gt; Vector Int
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208209"><span class="hs-identifier hs-var">stripCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208185"><span class="hs-identifier hs-var">fullStripSampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>              </span><span id="local-6989586621679208182"><span class="annot"><span class="annottext">stripSampleCounts :: Vector Int
</span><a href="#local-6989586621679208182"><span class="hs-identifier hs-var hs-var">stripSampleCounts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Vector Int -&gt; Vector Int
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679208181"><span class="hs-identifier hs-var">strip</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679208184"><span class="hs-identifier hs-var">startWriteOffset</span></a></span><span>
</span><span id="line-528"></span><span>                  </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>                      </span><span id="local-6989586621679208181"><span class="annot"><span class="annottext">strip :: Int -&gt; Int
</span><a href="#local-6989586621679208181"><span class="hs-identifier hs-var hs-var">strip</span></a></span></span><span> </span><span id="local-6989586621679208180"><span class="annot"><span class="annottext">start :: Int
</span><a href="#local-6989586621679208180"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208185"><span class="hs-identifier hs-var">fullStripSampleCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208214"><span class="hs-identifier hs-var">sampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208180"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>              </span><span id="local-6989586621679208196"><span class="annot"><span class="annottext">sizes :: Vector (Int, Int, Word32, Word32)
</span><a href="#local-6989586621679208196"><span class="hs-identifier hs-var hs-var">sizes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
-&gt; Vector Int
-&gt; Vector Word32
-&gt; Vector Word32
-&gt; Vector (Int, Int, Word32, Word32)
forall a b c d.
Vector a -&gt; Vector b -&gt; Vector c -&gt; Vector d -&gt; Vector (a, b, c, d)
</span><span class="hs-identifier hs-var">V.zip4</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679208184"><span class="hs-identifier hs-var">startWriteOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679208182"><span class="hs-identifier hs-var">stripSampleCounts</span></a></span><span>
</span><span id="line-532"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffOffsets"><span class="hs-identifier hs-var hs-var">tiffOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffStripSize"><span class="hs-identifier hs-var hs-var">tiffStripSize</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigSeparate"><span class="hs-identifier hs-type">PlanarConfigSeparate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Int, Word32, Word32) -&gt; ST s ())
-&gt; Vector (Int, Word32, Word32) -&gt; ST s ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Vector a -&gt; m ()
</span><span class="hs-identifier hs-var">V.mapM_</span></span><span> </span><span class="annot"><span class="annottext">(Int, Word32, Word32) -&gt; ST s ()
</span><a href="#local-6989586621679208176"><span class="hs-identifier hs-var">unpacker</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Int, Word32, Word32)
</span><a href="#local-6989586621679208175"><span class="hs-identifier hs-var">sizes</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208176"><span class="annot"><span class="annottext">unpacker :: (Int, Word32, Word32) -&gt; ST s ()
</span><a href="#local-6989586621679208176"><span class="hs-identifier hs-var hs-var">unpacker</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208174"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679208174"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208173"><span class="annot"><span class="annottext">offset :: Word32
</span><a href="#local-6989586621679208173"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208172"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208172"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208171"><span class="annot"><span class="annottext">writeIdx :: Int
</span><a href="#local-6989586621679208171"><span class="hs-identifier hs-var">writeIdx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208170"><span class="annot"><span class="annottext">tempStride :: Int
</span><a href="#local-6989586621679208170"><span class="hs-identifier hs-var">tempStride</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">comp -&gt; Int -&gt; Int -&gt; (Int, Int)
forall a. Unpackable a =&gt; a -&gt; Int -&gt; Int -&gt; (Int, Int)
</span><a href="Codec.Picture.Tiff.html#offsetStride"><span class="hs-identifier hs-var">offsetStride</span></a></span><span> </span><span class="annot"><span class="annottext">comp
</span><a href="#local-6989586621679208219"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208174"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">stride</span></a></span><span>
</span><span id="line-537"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TiffCompression
-&gt; ByteString
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; (Word32, Word32)
-&gt; ST s Int
forall s.
TiffCompression
-&gt; ByteString
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; (Word32, Word32)
-&gt; ST s Int
</span><a href="Codec.Picture.Tiff.html#uncompressAt"><span class="hs-identifier hs-var">uncompressAt</span></a></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="#local-6989586621679208208"><span class="hs-identifier hs-var">compression</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208218"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208206"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208170"><span class="hs-identifier hs-var">tempStride</span></a></span><span>
</span><span id="line-538"></span><span>                                    </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208171"><span class="hs-identifier hs-var">writeIdx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208173"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208172"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>                  </span><span class="annot"><span class="annottext">comp
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType comp)
-&gt; ST s ()
forall a s.
Unpackable a =&gt;
a
-&gt; Endianness
-&gt; STVector s Word8
-&gt; Int
-&gt; Int
-&gt; Word32
-&gt; Int
-&gt; STVector s (StorageType a)
-&gt; ST s ()
</span><a href="Codec.Picture.Tiff.html#mergeBackTempBuffer"><span class="hs-identifier hs-var">mergeBackTempBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">comp
</span><a href="#local-6989586621679208219"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208211"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">STVector s Word8
</span><a href="#local-6989586621679208206"><span class="hs-identifier hs-var">tempVec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208214"><span class="hs-identifier hs-var">sampleCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>                                      </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208174"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208172"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">stride</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s (PixelBaseComponent pixel)
STVector s (StorageType comp)
</span><a href="#local-6989586621679208207"><span class="hs-identifier hs-var">outVec</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span>              </span><span id="local-6989586621679208169"><span class="annot"><span class="annottext">stride :: Int
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var hs-var">stride</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Int) -&gt; Vector Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffOffsets"><span class="hs-identifier hs-var hs-var">tiffOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-543"></span><span>              </span><span id="local-6989586621679208168"><span class="annot"><span class="annottext">idxVector :: Vector Int
</span><a href="#local-6989586621679208168"><span class="hs-identifier hs-var hs-var">idxVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vector Int
forall a. Num a =&gt; a -&gt; Int -&gt; Vector a
</span><span class="hs-identifier hs-var">V.enumFromN</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208169"><span class="hs-identifier hs-var">stride</span></a></span><span>
</span><span id="line-544"></span><span>              </span><span id="local-6989586621679208175"><span class="annot"><span class="annottext">sizes :: Vector (Int, Word32, Word32)
</span><a href="#local-6989586621679208175"><span class="hs-identifier hs-var hs-var">sizes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int
-&gt; Vector Word32 -&gt; Vector Word32 -&gt; Vector (Int, Word32, Word32)
forall a b c. Vector a -&gt; Vector b -&gt; Vector c -&gt; Vector (a, b, c)
</span><span class="hs-identifier hs-var">V.zip3</span></span><span> </span><span class="annot"><span class="annottext">Vector Int
</span><a href="#local-6989586621679208168"><span class="hs-identifier hs-var">idxVector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffOffsets"><span class="hs-identifier hs-var hs-var">tiffOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffStripSize"><span class="hs-identifier hs-var hs-var">tiffStripSize</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffInfo -&gt; Predictor
</span><a href="Codec.Picture.Tiff.html#tiffPredictor"><span class="hs-identifier hs-var hs-var">tiffPredictor</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208217"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="annot"><span class="annottext">Predictor -&gt; Predictor -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Predictor
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PredictorHorizontalDifferencing"><span class="hs-identifier hs-var">PredictorHorizontalDifferencing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208164"><span class="annot"><span class="annottext">f :: p -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679208164"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679208163"><span class="annot"><span class="annottext">c1 :: a
</span><a href="#local-6989586621679208163"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679208162"><span class="annot"><span class="annottext">c2 :: a
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679208163"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679208162"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208215"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679208161"><span class="annot"><span class="annottext">y :: Int
</span><a href="#local-6989586621679208161"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-549"></span><span>      </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208216"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679208160"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679208160"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-550"></span><span>        </span><span id="local-6989586621679208159"><span class="annot"><span class="annottext">pixel
</span><a href="#local-6989586621679208159"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) pixel -&gt; Int -&gt; Int -&gt; ST s pixel
forall a (m :: * -&gt; *).
(Pixel a, PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; Int -&gt; Int -&gt; m a
</span><a href="Codec.Picture.Types.html#readPixel"><span class="hs-identifier hs-var">readPixel</span></a></span><span> </span><span class="annot"><span class="annottext">MutableImage s pixel
MutableImage (PrimState (ST s)) pixel
</span><a href="#local-6989586621679208205"><span class="hs-identifier hs-var">mutableImage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208161"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-551"></span><span>        </span><span id="local-6989586621679208157"><span class="annot"><span class="annottext">pixel
</span><a href="#local-6989586621679208157"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) pixel -&gt; Int -&gt; Int -&gt; ST s pixel
forall a (m :: * -&gt; *).
(Pixel a, PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; Int -&gt; Int -&gt; m a
</span><a href="Codec.Picture.Types.html#readPixel"><span class="hs-identifier hs-var">readPixel</span></a></span><span> </span><span class="annot"><span class="annottext">MutableImage s pixel
MutableImage (PrimState (ST s)) pixel
</span><a href="#local-6989586621679208205"><span class="hs-identifier hs-var">mutableImage</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208161"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-552"></span><span>        </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) pixel
-&gt; Int -&gt; Int -&gt; pixel -&gt; ST s ()
forall a (m :: * -&gt; *).
(Pixel a, PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; Int -&gt; Int -&gt; a -&gt; m ()
</span><a href="Codec.Picture.Types.html#writePixel"><span class="hs-identifier hs-var">writePixel</span></a></span><span> </span><span class="annot"><span class="annottext">MutableImage s pixel
MutableImage (PrimState (ST s)) pixel
</span><a href="#local-6989586621679208205"><span class="hs-identifier hs-var">mutableImage</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679208161"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">(pixel -&gt; ST s ()) -&gt; pixel -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; PixelBaseComponent pixel
 -&gt; PixelBaseComponent pixel
 -&gt; PixelBaseComponent pixel)
-&gt; pixel -&gt; pixel -&gt; pixel
forall a.
Pixel a =&gt;
(Int
 -&gt; PixelBaseComponent a
 -&gt; PixelBaseComponent a
 -&gt; PixelBaseComponent a)
-&gt; a -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#mixWith"><span class="hs-identifier hs-var">mixWith</span></a></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; PixelBaseComponent pixel
-&gt; PixelBaseComponent pixel
-&gt; PixelBaseComponent pixel
forall a p. Num a =&gt; p -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679208164"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">pixel
</span><a href="#local-6989586621679208159"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">pixel
</span><a href="#local-6989586621679208157"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) pixel -&gt; ST s (Image pixel)
forall a (m :: * -&gt; *).
(Storable (PixelBaseComponent a), PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; m (Image a)
</span><a href="Codec.Picture.Types.html#unsafeFreezeImage"><span class="hs-identifier hs-var">unsafeFreezeImage</span></a></span><span> </span><span class="annot"><span class="annottext">MutableImage s pixel
MutableImage (PrimState (ST s)) pixel
</span><a href="#local-6989586621679208205"><span class="hs-identifier hs-var">mutableImage</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="annot"><a href="Codec.Picture.Tiff.html#ifdSingleLong"><span class="hs-identifier hs-type">ifdSingleLong</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span id="ifdSingleLong"><span class="annot"><span class="annottext">ifdSingleLong :: ExifTag -&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdSingleLong"><span class="hs-identifier hs-var hs-var">ifdSingleLong</span></a></span></span><span> </span><span id="local-6989586621679208152"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208152"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiLong"><span class="hs-identifier hs-var">ifdMultiLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208152"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; (Word32 -&gt; Vector Word32)
-&gt; Word32
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="annot"><a href="Codec.Picture.Tiff.html#ifdSingleShort"><span class="hs-identifier hs-type">ifdSingleShort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-560"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span id="ifdSingleShort"><span class="annot"><span class="annottext">ifdSingleShort :: Endianness -&gt; ExifTag -&gt; Word16 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdSingleShort"><span class="hs-identifier hs-var hs-var">ifdSingleShort</span></a></span></span><span> </span><span id="local-6989586621679208149"><span class="annot"><span class="annottext">endian :: Endianness
</span><a href="#local-6989586621679208149"><span class="hs-identifier hs-var">endian</span></a></span></span><span> </span><span id="local-6989586621679208148"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208148"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness
-&gt; ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiShort"><span class="hs-identifier hs-var">ifdMultiShort</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208149"><span class="hs-identifier hs-var">endian</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208148"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; (Word16 -&gt; Vector Word32)
-&gt; Word16
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Vector Word32)
-&gt; (Word16 -&gt; Word32) -&gt; Word16 -&gt; Vector Word32
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span class="annot"><a href="Codec.Picture.Tiff.html#ifdMultiLong"><span class="hs-identifier hs-type">ifdMultiLong</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span id="ifdMultiLong"><span class="annot"><span class="annottext">ifdMultiLong :: ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiLong"><span class="hs-identifier hs-var hs-var">ifdMultiLong</span></a></span></span><span> </span><span id="local-6989586621679208146"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208146"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679208145"><span class="annot"><span class="annottext">v :: Vector Word32
</span><a href="#local-6989586621679208145"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; Writer [ImageFileDirectory] ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; Writer [ImageFileDirectory] ())
-&gt; (ImageFileDirectory -&gt; [ImageFileDirectory])
-&gt; ImageFileDirectory
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; [ImageFileDirectory]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; Writer [ImageFileDirectory] ())
-&gt; ImageFileDirectory -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">$WImageFileDirectory :: ExifTag
-&gt; IfdType -&gt; Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory
</span><a href="Codec.Picture.Tiff.Internal.Types.html#%24WImageFileDirectory"><span class="hs-identifier hs-type hs-type">ImageFileDirectory</span></a></span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdIdentifier :: ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var">ifdIdentifier</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208146"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdType :: IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208145"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208143"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="#local-6989586621679208142"><span class="hs-identifier hs-var">extended</span></a></span><span>
</span><span id="line-570"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208143"><span class="annot"><span class="annottext">offset :: Word32
</span><a href="#local-6989586621679208143"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208142"><span class="annot"><span class="annottext">extended :: ExifData
</span><a href="#local-6989586621679208142"><span class="hs-identifier hs-var">extended</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208145"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifLongs"><span class="hs-identifier hs-var">ExifLongs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208145"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Word32 -&gt; Word32
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208145"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="annot"><a href="Codec.Picture.Tiff.html#ifdMultiShort"><span class="hs-identifier hs-type">ifdMultiShort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-576"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span id="ifdMultiShort"><span class="annot"><span class="annottext">ifdMultiShort :: Endianness
-&gt; ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiShort"><span class="hs-identifier hs-var hs-var">ifdMultiShort</span></a></span></span><span> </span><span id="local-6989586621679208140"><span class="annot"><span class="annottext">endian :: Endianness
</span><a href="#local-6989586621679208140"><span class="hs-identifier hs-var">endian</span></a></span></span><span> </span><span id="local-6989586621679208139"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208139"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679208138"><span class="annot"><span class="annottext">v :: Vector Word32
</span><a href="#local-6989586621679208138"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; Writer [ImageFileDirectory] ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; Writer [ImageFileDirectory] ())
-&gt; (ImageFileDirectory -&gt; [ImageFileDirectory])
-&gt; ImageFileDirectory
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; [ImageFileDirectory]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; Writer [ImageFileDirectory] ())
-&gt; ImageFileDirectory -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">$WImageFileDirectory :: ExifTag
-&gt; IfdType -&gt; Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory
</span><a href="Codec.Picture.Tiff.Internal.Types.html#%24WImageFileDirectory"><span class="hs-identifier hs-type hs-type">ImageFileDirectory</span></a></span><span>
</span><span id="line-578"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdIdentifier :: ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var">ifdIdentifier</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208139"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-579"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdType :: IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span>
</span><span id="line-580"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208137"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-581"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208136"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-582"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="#local-6989586621679208135"><span class="hs-identifier hs-var">extended</span></a></span><span>
</span><span id="line-583"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-584"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679208137"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679208137"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208138"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-585"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679208136"><span class="annot"><span class="annottext">offset :: Word32
</span><a href="#local-6989586621679208136"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208135"><span class="annot"><span class="annottext">extended :: ExifData
</span><a href="#local-6989586621679208135"><span class="hs-identifier hs-var">extended</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208137"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector Word16 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-var">ExifShorts</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word16 -&gt; ExifData) -&gt; Vector Word16 -&gt; ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word16) -&gt; Vector Word32 -&gt; Vector Word16
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208138"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208137"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-588"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208134"><span class="annot"><span class="annottext">v1 :: Word32
</span><a href="#local-6989586621679208134"><span class="hs-identifier hs-var hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32) -&gt; Word32 -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Word32
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208138"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-589"></span><span>                        </span><span id="local-6989586621679208133"><span class="annot"><span class="annottext">v2 :: Word32
</span><a href="#local-6989586621679208133"><span class="hs-identifier hs-var hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32) -&gt; Word32 -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208138"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int -&gt; Word32
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-590"></span><span>                    </span><span class="hs-keyword">in</span><span>
</span><span id="line-591"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208140"><span class="hs-identifier hs-var">endian</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-592"></span><span>                      </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-type">EndianLittle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208133"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208134"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>                      </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-type">EndianBig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208134"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208133"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208140"><span class="hs-identifier hs-var">endian</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-596"></span><span>                    </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-type">EndianLittle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Word32 -&gt; Word32
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208138"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>                    </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-type">EndianBig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Word32 -&gt; Word32
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208138"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679208129"><span class="annot"><span class="annottext">putP :: ByteString -&gt; TiffInfo -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span id="local-6989586621679208127"><span class="annot"><span class="annottext">rawData :: ByteString
</span><a href="#local-6989586621679208127"><span class="hs-identifier hs-var">rawData</span></a></span></span><span> </span><span id="local-6989586621679208126"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (TiffHeader, [[ImageFileDirectory]]) -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208127"><span class="hs-identifier hs-var">rawData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffHeader
</span><a href="Codec.Picture.Tiff.html#tiffHeader"><span class="hs-identifier hs-var hs-var">tiffHeader</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208125"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-601"></span><span>    </span><span id="local-6989586621679208124"><span class="annot"><span class="annottext">endianness :: Endianness
</span><a href="#local-6989586621679208124"><span class="hs-identifier hs-var hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffHeader -&gt; Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrEndianness"><span class="hs-identifier hs-var hs-var">hdrEndianness</span></a></span><span> </span><span class="annot"><span class="annottext">(TiffHeader -&gt; Endianness) -&gt; TiffHeader -&gt; Endianness
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffHeader
</span><a href="Codec.Picture.Tiff.html#tiffHeader"><span class="hs-identifier hs-var hs-var">tiffHeader</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621679208123"><span class="annot"><span class="annottext">ifdShort :: ExifTag -&gt; Word16 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208123"><span class="hs-identifier hs-var hs-var">ifdShort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; ExifTag -&gt; Word16 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdSingleShort"><span class="hs-identifier hs-var">ifdSingleShort</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208124"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-604"></span><span>    </span><span id="local-6989586621679208122"><span class="annot"><span class="annottext">ifdShorts :: ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208122"><span class="hs-identifier hs-var hs-var">ifdShorts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness
-&gt; ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiShort"><span class="hs-identifier hs-var">ifdMultiShort</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679208124"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span>    </span><span id="local-6989586621679208125"><span class="annot"><span class="annottext">list :: [ImageFileDirectory]
</span><a href="#local-6989586621679208125"><span class="hs-identifier hs-var hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer [ImageFileDirectory] () -&gt; [ImageFileDirectory]
forall w a. Writer w a -&gt; w
</span><span class="hs-identifier hs-var">execWriter</span></span><span> </span><span class="annot"><span class="annottext">(Writer [ImageFileDirectory] () -&gt; [ImageFileDirectory])
-&gt; Writer [ImageFileDirectory] () -&gt; [ImageFileDirectory]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdSingleLong"><span class="hs-identifier hs-var">ifdSingleLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagImageWidth"><span class="hs-identifier hs-var">TagImageWidth</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffWidth"><span class="hs-identifier hs-var hs-var">tiffWidth</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-608"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdSingleLong"><span class="hs-identifier hs-var">ifdSingleLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagImageLength"><span class="hs-identifier hs-var">TagImageLength</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffHeight"><span class="hs-identifier hs-var hs-var">tiffHeight</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-609"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208122"><span class="hs-identifier hs-var">ifdShorts</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagBitsPerSample"><span class="hs-identifier hs-var">TagBitsPerSample</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-610"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdSingleLong"><span class="hs-identifier hs-var">ifdSingleLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagSamplesPerPixel"><span class="hs-identifier hs-var">TagSamplesPerPixel</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffSampleCount"><span class="hs-identifier hs-var hs-var">tiffSampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-611"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdSingleLong"><span class="hs-identifier hs-var">ifdSingleLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagRowPerStrip"><span class="hs-identifier hs-var">TagRowPerStrip</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; Word32 -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffRowPerStrip"><span class="hs-identifier hs-var hs-var">tiffRowPerStrip</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-612"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Word16 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208123"><span class="hs-identifier hs-var">ifdShort</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagPhotometricInterpretation"><span class="hs-identifier hs-var">TagPhotometricInterpretation</span></a></span><span>
</span><span id="line-613"></span><span>                                  </span><span class="annot"><span class="annottext">(Word16 -&gt; Writer [ImageFileDirectory] ())
-&gt; (TiffColorspace -&gt; Word16)
-&gt; TiffColorspace
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#packPhotometricInterpretation"><span class="hs-identifier hs-var">packPhotometricInterpretation</span></a></span><span>
</span><span id="line-614"></span><span>                                  </span><span class="annot"><span class="annottext">(TiffColorspace -&gt; Writer [ImageFileDirectory] ())
-&gt; TiffColorspace -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var hs-var">tiffColorspace</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-615"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Word16 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208123"><span class="hs-identifier hs-var">ifdShort</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagPlanarConfiguration"><span class="hs-identifier hs-var">TagPlanarConfiguration</span></a></span><span>
</span><span id="line-616"></span><span>              </span><span class="annot"><span class="annottext">(Word16 -&gt; Writer [ImageFileDirectory] ())
-&gt; (TiffPlanarConfiguration -&gt; Word16)
-&gt; TiffPlanarConfiguration
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#constantToPlaneConfiguration"><span class="hs-identifier hs-var">constantToPlaneConfiguration</span></a></span><span> </span><span class="annot"><span class="annottext">(TiffPlanarConfiguration -&gt; Writer [ImageFileDirectory] ())
-&gt; TiffPlanarConfiguration -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.html#tiffPlaneConfiguration"><span class="hs-identifier hs-var hs-var">tiffPlaneConfiguration</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-617"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiLong"><span class="hs-identifier hs-var">ifdMultiLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagSampleFormat"><span class="hs-identifier hs-var">TagSampleFormat</span></a></span><span>
</span><span id="line-618"></span><span>                                  </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; ([TiffSampleFormat] -&gt; Vector Word32)
-&gt; [TiffSampleFormat]
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-619"></span><span>                                  </span><span class="annot"><span class="annottext">([Word32] -&gt; Vector Word32)
-&gt; ([TiffSampleFormat] -&gt; [Word32])
-&gt; [TiffSampleFormat]
-&gt; Vector Word32
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Word32) -&gt; [TiffSampleFormat] -&gt; [Word32]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#packSampleFormat"><span class="hs-identifier hs-var">packSampleFormat</span></a></span><span>
</span><span id="line-620"></span><span>                                  </span><span class="annot"><span class="annottext">([TiffSampleFormat] -&gt; Writer [ImageFileDirectory] ())
-&gt; [TiffSampleFormat] -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var hs-var">tiffSampleFormat</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-621"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Word16 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208123"><span class="hs-identifier hs-var">ifdShort</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagCompression"><span class="hs-identifier hs-var">TagCompression</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Writer [ImageFileDirectory] ())
-&gt; (TiffCompression -&gt; Word16)
-&gt; TiffCompression
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TiffCompression -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#packCompression"><span class="hs-identifier hs-var">packCompression</span></a></span><span>
</span><span id="line-622"></span><span>                                    </span><span class="annot"><span class="annottext">(TiffCompression -&gt; Writer [ImageFileDirectory] ())
-&gt; TiffCompression -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; TiffCompression
</span><a href="Codec.Picture.Tiff.html#tiffCompression"><span class="hs-identifier hs-var hs-var">tiffCompression</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-623"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiLong"><span class="hs-identifier hs-var">ifdMultiLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagStripOffsets"><span class="hs-identifier hs-var">TagStripOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffOffsets"><span class="hs-identifier hs-var hs-var">tiffOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span>      </span><span class="annot"><span class="annottext">ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="Codec.Picture.Tiff.html#ifdMultiLong"><span class="hs-identifier hs-var">ifdMultiLong</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagStripByteCounts"><span class="hs-identifier hs-var">TagStripByteCounts</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; Writer [ImageFileDirectory] ())
-&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffStripSize"><span class="hs-identifier hs-var hs-var">tiffStripSize</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span>      </span><span class="annot"><span class="annottext">Writer [ImageFileDirectory] ()
-&gt; (ExtraSample -&gt; Writer [ImageFileDirectory] ())
-&gt; Maybe ExtraSample
-&gt; Writer [ImageFileDirectory] ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Writer [ImageFileDirectory] ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExifTag -&gt; Word16 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208123"><span class="hs-identifier hs-var">ifdShort</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagExtraSample"><span class="hs-identifier hs-var">TagExtraSample</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Writer [ImageFileDirectory] ())
-&gt; (ExtraSample -&gt; Word16)
-&gt; ExtraSample
-&gt; Writer [ImageFileDirectory] ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ExtraSample -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#codeOfExtraSample"><span class="hs-identifier hs-var">codeOfExtraSample</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>          </span><span class="annot"><span class="annottext">(Maybe ExtraSample -&gt; Writer [ImageFileDirectory] ())
-&gt; Maybe ExtraSample -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Maybe ExtraSample
</span><a href="Codec.Picture.Tiff.html#tiffExtraSample"><span class="hs-identifier hs-var hs-var">tiffExtraSample</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208102"><span class="annot"><span class="annottext">subSampling :: Vector Word32
</span><a href="#local-6989586621679208102"><span class="hs-identifier hs-var hs-var">subSampling</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffYCbCrSubsampling"><span class="hs-identifier hs-var hs-var">tiffYCbCrSubsampling</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208126"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-632"></span><span>      </span><span class="annot"><span class="annottext">Bool
-&gt; Writer [ImageFileDirectory] () -&gt; Writer [ImageFileDirectory] ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Word32 -&gt; Bool
forall a. Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.null</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208102"><span class="hs-identifier hs-var">subSampling</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Writer [ImageFileDirectory] () -&gt; Writer [ImageFileDirectory] ())
-&gt; Writer [ImageFileDirectory] () -&gt; Writer [ImageFileDirectory] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-633"></span><span>           </span><span class="annot"><span class="annottext">ExifTag -&gt; Vector Word32 -&gt; Writer [ImageFileDirectory] ()
</span><a href="#local-6989586621679208122"><span class="hs-identifier hs-var">ifdShorts</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagYCbCrSubsampling"><span class="hs-identifier hs-var">TagYCbCrSubsampling</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208102"><span class="hs-identifier hs-var">subSampling</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span>  </span><span id="local-6989586621679208099"><span class="annot"><span class="annottext">getP :: ByteString -&gt; Get TiffInfo
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span id="local-6989586621679208097"><span class="annot"><span class="annottext">rawData :: ByteString
</span><a href="#local-6989586621679208097"><span class="hs-identifier hs-var">rawData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679208096"><span class="annot"><span class="annottext">hdr :: TiffHeader
</span><a href="#local-6989586621679208096"><span class="hs-identifier hs-var">hdr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208095"><span class="annot"><span class="annottext">[[ImageFileDirectory]]
</span><a href="#local-6989586621679208095"><span class="hs-identifier hs-var">cleanedFull</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Get (TiffHeader, [[ImageFileDirectory]])
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208097"><span class="hs-identifier hs-var">rawData</span></a></span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208094"><span class="annot"><span class="annottext">cleaned :: [ImageFileDirectory]
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var hs-var">cleaned</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[ImageFileDirectory]] -&gt; [ImageFileDirectory]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[ImageFileDirectory]]
</span><a href="#local-6989586621679208095"><span class="hs-identifier hs-var">cleanedFull</span></a></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621679208092"><span class="annot"><span class="annottext">dataFind :: String -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var hs-var">dataFind</span></a></span></span><span> </span><span id="local-6989586621679208091"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679208091"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679208090"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get Word32
</span><a href="Codec.Picture.Tiff.html#findIFDData"><span class="hs-identifier hs-var">findIFDData</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208091"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208090"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">cleaned</span></a></span><span>
</span><span id="line-640"></span><span>        </span><span id="local-6989586621679208089"><span class="annot"><span class="annottext">dataDefault :: Word32 -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208089"><span class="hs-identifier hs-var hs-var">dataDefault</span></a></span></span><span> </span><span id="local-6989586621679208088"><span class="annot"><span class="annottext">def :: Word32
</span><a href="#local-6989586621679208088"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621679208087"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208087"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get Word32
</span><a href="Codec.Picture.Tiff.html#findIFDDefaultData"><span class="hs-identifier hs-var">findIFDDefaultData</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679208088"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208087"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">cleaned</span></a></span><span>
</span><span id="line-641"></span><span>        </span><span id="local-6989586621679208086"><span class="annot"><span class="annottext">extFind :: String -&gt; ExifTag -&gt; Get ExifData
</span><a href="#local-6989586621679208086"><span class="hs-identifier hs-var hs-var">extFind</span></a></span></span><span> </span><span id="local-6989586621679208085"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679208085"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679208084"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208084"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get ExifData
</span><a href="Codec.Picture.Tiff.html#findIFDExt"><span class="hs-identifier hs-var">findIFDExt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679208085"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208084"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">cleaned</span></a></span><span>
</span><span id="line-642"></span><span>        </span><span id="local-6989586621679208083"><span class="annot"><span class="annottext">extDefault :: [Word32] -&gt; ExifTag -&gt; Get [Word32]
</span><a href="#local-6989586621679208083"><span class="hs-identifier hs-var hs-var">extDefault</span></a></span></span><span> </span><span id="local-6989586621679208082"><span class="annot"><span class="annottext">def :: [Word32]
</span><a href="#local-6989586621679208082"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621679208081"><span class="annot"><span class="annottext">tag :: ExifTag
</span><a href="#local-6989586621679208081"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; ExifTag -&gt; [ImageFileDirectory] -&gt; Get [Word32]
</span><a href="Codec.Picture.Tiff.html#findIFDExtDefaultData"><span class="hs-identifier hs-var">findIFDExtDefaultData</span></a></span><span> </span><span class="annot"><span class="annottext">[Word32]
</span><a href="#local-6989586621679208082"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="#local-6989586621679208081"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">cleaned</span></a></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><span class="annottext">TiffHeader
-&gt; Word32
-&gt; Word32
-&gt; TiffColorspace
-&gt; Word32
-&gt; Word32
-&gt; TiffPlanarConfiguration
-&gt; [TiffSampleFormat]
-&gt; Vector Word32
-&gt; TiffCompression
-&gt; Vector Word32
-&gt; Vector Word32
-&gt; Maybe (Image PixelRGB16)
-&gt; Vector Word32
-&gt; Maybe ExtraSample
-&gt; Predictor
-&gt; Metadatas
-&gt; TiffInfo
</span><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-var">TiffInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679208096"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-645"></span><span>        </span><span class="annot"><span class="annottext">(Word32
 -&gt; Word32
 -&gt; TiffColorspace
 -&gt; Word32
 -&gt; Word32
 -&gt; TiffPlanarConfiguration
 -&gt; [TiffSampleFormat]
 -&gt; Vector Word32
 -&gt; TiffCompression
 -&gt; Vector Word32
 -&gt; Vector Word32
 -&gt; Maybe (Image PixelRGB16)
 -&gt; Vector Word32
 -&gt; Maybe ExtraSample
 -&gt; Predictor
 -&gt; Metadatas
 -&gt; TiffInfo)
-&gt; Get Word32
-&gt; Get
     (Word32
      -&gt; TiffColorspace
      -&gt; Word32
      -&gt; Word32
      -&gt; TiffPlanarConfiguration
      -&gt; [TiffSampleFormat]
      -&gt; Vector Word32
      -&gt; TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">dataFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find width&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagImageWidth"><span class="hs-identifier hs-var">TagImageWidth</span></a></span><span>
</span><span id="line-646"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Word32
   -&gt; TiffColorspace
   -&gt; Word32
   -&gt; Word32
   -&gt; TiffPlanarConfiguration
   -&gt; [TiffSampleFormat]
   -&gt; Vector Word32
   -&gt; TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get Word32
-&gt; Get
     (TiffColorspace
      -&gt; Word32
      -&gt; Word32
      -&gt; TiffPlanarConfiguration
      -&gt; [TiffSampleFormat]
      -&gt; Vector Word32
      -&gt; TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">dataFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find height&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagImageLength"><span class="hs-identifier hs-var">TagImageLength</span></a></span><span>
</span><span id="line-647"></span><span>        </span><span class="annot"><span class="annottext">Get
  (TiffColorspace
   -&gt; Word32
   -&gt; Word32
   -&gt; TiffPlanarConfiguration
   -&gt; [TiffSampleFormat]
   -&gt; Vector Word32
   -&gt; TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get TiffColorspace
-&gt; Get
     (Word32
      -&gt; Word32
      -&gt; TiffPlanarConfiguration
      -&gt; [TiffSampleFormat]
      -&gt; Vector Word32
      -&gt; TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">dataFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find color space&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagPhotometricInterpretation"><span class="hs-identifier hs-var">TagPhotometricInterpretation</span></a></span><span>
</span><span id="line-648"></span><span>                     </span><span class="annot"><span class="annottext">Get Word32 -&gt; (Word32 -&gt; Get TiffColorspace) -&gt; Get TiffColorspace
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#unpackPhotometricInterpretation"><span class="hs-identifier hs-var">unpackPhotometricInterpretation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Word32
   -&gt; Word32
   -&gt; TiffPlanarConfiguration
   -&gt; [TiffSampleFormat]
   -&gt; Vector Word32
   -&gt; TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get Word32
-&gt; Get
     (Word32
      -&gt; TiffPlanarConfiguration
      -&gt; [TiffSampleFormat]
      -&gt; Vector Word32
      -&gt; TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">dataFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find sample per pixel&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagSamplesPerPixel"><span class="hs-identifier hs-var">TagSamplesPerPixel</span></a></span><span>
</span><span id="line-650"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Word32
   -&gt; TiffPlanarConfiguration
   -&gt; [TiffSampleFormat]
   -&gt; Vector Word32
   -&gt; TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get Word32
-&gt; Get
     (TiffPlanarConfiguration
      -&gt; [TiffSampleFormat]
      -&gt; Vector Word32
      -&gt; TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">dataFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find row per strip&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagRowPerStrip"><span class="hs-identifier hs-var">TagRowPerStrip</span></a></span><span>
</span><span id="line-651"></span><span>        </span><span class="annot"><span class="annottext">Get
  (TiffPlanarConfiguration
   -&gt; [TiffSampleFormat]
   -&gt; Vector Word32
   -&gt; TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get TiffPlanarConfiguration
-&gt; Get
     ([TiffSampleFormat]
      -&gt; Vector Word32
      -&gt; TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208089"><span class="hs-identifier hs-var">dataDefault</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagPlanarConfiguration"><span class="hs-identifier hs-var">TagPlanarConfiguration</span></a></span><span>
</span><span id="line-652"></span><span>                     </span><span class="annot"><span class="annottext">Get Word32
-&gt; (Word32 -&gt; Get TiffPlanarConfiguration)
-&gt; Get TiffPlanarConfiguration
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#planarConfgOfConstant"><span class="hs-identifier hs-var">planarConfgOfConstant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>        </span><span class="annot"><span class="annottext">Get
  ([TiffSampleFormat]
   -&gt; Vector Word32
   -&gt; TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get [TiffSampleFormat]
-&gt; Get
     (Vector Word32
      -&gt; TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word32] -&gt; ExifTag -&gt; Get [Word32]
</span><a href="#local-6989586621679208083"><span class="hs-identifier hs-var">extDefault</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagSampleFormat"><span class="hs-identifier hs-var">TagSampleFormat</span></a></span><span>
</span><span id="line-654"></span><span>                     </span><span class="annot"><span class="annottext">Get [Word32]
-&gt; ([Word32] -&gt; Get [TiffSampleFormat]) -&gt; Get [TiffSampleFormat]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Get TiffSampleFormat)
-&gt; [Word32] -&gt; Get [TiffSampleFormat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#unpackSampleFormat"><span class="hs-identifier hs-var">unpackSampleFormat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Vector Word32
   -&gt; TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get (Vector Word32)
-&gt; Get
     (TiffCompression
      -&gt; Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get ExifData
</span><a href="#local-6989586621679208086"><span class="hs-identifier hs-var">extFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find bit per sample&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagBitsPerSample"><span class="hs-identifier hs-var">TagBitsPerSample</span></a></span><span>
</span><span id="line-656"></span><span>                     </span><span class="annot"><span class="annottext">Get ExifData
-&gt; (ExifData -&gt; Get (Vector Word32)) -&gt; Get (Vector Word32)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifData -&gt; Get (Vector Word32)
</span><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find bit depth&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>        </span><span class="annot"><span class="annottext">Get
  (TiffCompression
   -&gt; Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get TiffCompression
-&gt; Get
     (Vector Word32
      -&gt; Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208092"><span class="hs-identifier hs-var">dataFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find Compression&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagCompression"><span class="hs-identifier hs-var">TagCompression</span></a></span><span>
</span><span id="line-658"></span><span>                     </span><span class="annot"><span class="annottext">Get Word32
-&gt; (Word32 -&gt; Get TiffCompression) -&gt; Get TiffCompression
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#unPackCompression"><span class="hs-identifier hs-var">unPackCompression</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Vector Word32
   -&gt; Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get (Vector Word32)
-&gt; Get
     (Vector Word32
      -&gt; Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get ExifData
</span><a href="#local-6989586621679208086"><span class="hs-identifier hs-var">extFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find byte counts&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagStripByteCounts"><span class="hs-identifier hs-var">TagStripByteCounts</span></a></span><span>
</span><span id="line-660"></span><span>                     </span><span class="annot"><span class="annottext">Get ExifData
-&gt; (ExifData -&gt; Get (Vector Word32)) -&gt; Get (Vector Word32)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifData -&gt; Get (Vector Word32)
</span><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find bit per sample&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Vector Word32
   -&gt; Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get (Vector Word32)
-&gt; Get
     (Maybe (Image PixelRGB16)
      -&gt; Vector Word32
      -&gt; Maybe ExtraSample
      -&gt; Predictor
      -&gt; Metadatas
      -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ExifTag -&gt; Get ExifData
</span><a href="#local-6989586621679208086"><span class="hs-identifier hs-var">extFind</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Strip offsets missing&quot;</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagStripOffsets"><span class="hs-identifier hs-var">TagStripOffsets</span></a></span><span>
</span><span id="line-662"></span><span>                     </span><span class="annot"><span class="annottext">Get ExifData
-&gt; (ExifData -&gt; Get (Vector Word32)) -&gt; Get (Vector Word32)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExifData -&gt; Get (Vector Word32)
</span><a href="Codec.Picture.Tiff.html#unLong"><span class="hs-identifier hs-var">unLong</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Can't find strip offsets&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Maybe (Image PixelRGB16)
   -&gt; Vector Word32
   -&gt; Maybe ExtraSample
   -&gt; Predictor
   -&gt; Metadatas
   -&gt; TiffInfo)
-&gt; Get (Maybe (Image PixelRGB16))
-&gt; Get
     (Vector Word32
      -&gt; Maybe ExtraSample -&gt; Predictor -&gt; Metadatas -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; Get (Maybe (Image PixelRGB16))
</span><a href="Codec.Picture.Tiff.html#findPalette"><span class="hs-identifier hs-var">findPalette</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">cleaned</span></a></span><span>
</span><span id="line-664"></span><span>        </span><span class="annot"><span class="annottext">Get
  (Vector Word32
   -&gt; Maybe ExtraSample -&gt; Predictor -&gt; Metadatas -&gt; TiffInfo)
-&gt; Get (Vector Word32)
-&gt; Get (Maybe ExtraSample -&gt; Predictor -&gt; Metadatas -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Word32] -&gt; Vector Word32) -&gt; Get [Word32] -&gt; Get (Vector Word32)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; ExifTag -&gt; Get [Word32]
</span><a href="#local-6989586621679208083"><span class="hs-identifier hs-var">extDefault</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagYCbCrSubsampling"><span class="hs-identifier hs-var">TagYCbCrSubsampling</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>        </span><span class="annot"><span class="annottext">Get (Maybe ExtraSample -&gt; Predictor -&gt; Metadatas -&gt; TiffInfo)
-&gt; Get (Maybe ExtraSample)
-&gt; Get (Predictor -&gt; Metadatas -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ExtraSample -&gt; Get (Maybe ExtraSample)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe ExtraSample
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-666"></span><span>        </span><span class="annot"><span class="annottext">Get (Predictor -&gt; Metadatas -&gt; TiffInfo)
-&gt; Get Predictor -&gt; Get (Metadatas -&gt; TiffInfo)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; ExifTag -&gt; Get Word32
</span><a href="#local-6989586621679208089"><span class="hs-identifier hs-var">dataDefault</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagPredictor"><span class="hs-identifier hs-var">TagPredictor</span></a></span><span>
</span><span id="line-667"></span><span>                     </span><span class="annot"><span class="annottext">Get Word32 -&gt; (Word32 -&gt; Get Predictor) -&gt; Get Predictor
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get Predictor
</span><a href="Codec.Picture.Tiff.Internal.Types.html#predictorOfConstant"><span class="hs-identifier hs-var">predictorOfConstant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>        </span><span class="annot"><span class="annottext">Get (Metadatas -&gt; TiffInfo) -&gt; Get Metadatas -&gt; Get TiffInfo
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Metadatas -&gt; Get Metadatas
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; Metadatas
</span><a href="Codec.Picture.Tiff.Internal.Metadata.html#extractTiffMetadata"><span class="hs-identifier hs-var">extractTiffMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679208094"><span class="hs-identifier hs-var">cleaned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="annot"><a href="Codec.Picture.Tiff.html#palette16Of"><span class="hs-identifier hs-type">palette16Of</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGB16"><span class="hs-identifier hs-type">PixelRGB16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Palette%27"><span class="hs-identifier hs-type">Palette'</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGB16"><span class="hs-identifier hs-type">PixelRGB16</span></a></span><span>
</span><span id="line-671"></span><span id="palette16Of"><span class="annot"><span class="annottext">palette16Of :: Image PixelRGB16 -&gt; Palette' PixelRGB16
</span><a href="Codec.Picture.Tiff.html#palette16Of"><span class="hs-identifier hs-var hs-var">palette16Of</span></a></span></span><span> </span><span id="local-6989586621679208071"><span class="annot"><span class="annottext">p :: Image PixelRGB16
</span><a href="#local-6989586621679208071"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">$WPalette' :: forall px. Int -&gt; Vector (PixelBaseComponent px) -&gt; Palette' px
</span><a href="Codec.Picture.Types.html#%24WPalette%27"><span class="hs-identifier hs-type hs-type">Palette'</span></a></span><span>
</span><span id="line-672"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_paletteSize :: Int
</span><a href="Codec.Picture.Types.html#_paletteSize"><span class="hs-identifier hs-var">_paletteSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16 -&gt; Int
forall a. Image a -&gt; Int
</span><a href="Codec.Picture.Types.html#imageWidth"><span class="hs-identifier hs-var hs-var">imageWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16
</span><a href="#local-6989586621679208071"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_paletteData :: Vector (PixelBaseComponent PixelRGB16)
</span><a href="Codec.Picture.Types.html#_paletteData"><span class="hs-identifier hs-var">_paletteData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16 -&gt; Vector (PixelBaseComponent PixelRGB16)
forall a. Image a -&gt; Vector (PixelBaseComponent a)
</span><a href="Codec.Picture.Types.html#imageData"><span class="hs-identifier hs-var hs-var">imageData</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16
</span><a href="#local-6989586621679208071"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-type">unpack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PalettedImage"><span class="hs-identifier hs-type">PalettedImage</span></a></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- | while mandatory some images don't put correct</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- rowperstrip. So replacing 0 with actual image height.</span><span>
</span><span id="line-679"></span><span id="unpack"><span class="annot"><span class="annottext">unpack :: ByteString -&gt; TiffInfo -&gt; Either String PalettedImage
</span><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var hs-var">unpack</span></a></span></span><span> </span><span id="local-6989586621679208063"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679208063"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679208062"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208062"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffRowPerStrip :: TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffRowPerStrip"><span class="hs-identifier hs-var">tiffRowPerStrip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; TiffInfo -&gt; Either String PalettedImage
</span><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208063"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">(TiffInfo -&gt; Either String PalettedImage)
-&gt; TiffInfo -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208062"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffRowPerStrip :: Word32
</span><a href="Codec.Picture.Tiff.html#tiffRowPerStrip"><span class="hs-identifier hs-var">tiffRowPerStrip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffHeight"><span class="hs-identifier hs-var hs-var">tiffHeight</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208062"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-681"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span id="local-6989586621679208061"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679208061"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679208060"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208060"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPaleted"><span class="hs-identifier hs-var">TiffPaleted</span></a></span><span>
</span><span id="line-682"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffBitsPerSample :: TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208058"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208058"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-683"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleFormat :: TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var">tiffSampleFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208057"><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208057"><span class="hs-identifier hs-var">format</span></a></span></span><span>
</span><span id="line-684"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffPalette :: TiffInfo -&gt; Maybe (Image PixelRGB16)
</span><a href="Codec.Picture.Tiff.html#tiffPalette"><span class="hs-identifier hs-var">tiffPalette</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679208056"><span class="annot"><span class="annottext">p :: Image PixelRGB16
</span><a href="#local-6989586621679208056"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-685"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208058"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208057"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat] -&gt; [TiffSampleFormat] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Palette' PixelRGB16 -&gt; PalettedImage)
-&gt; Palette' PixelRGB16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word8 -&gt; Palette' PixelRGB16 -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#PalettedRGB16"><span class="hs-identifier hs-var">PalettedRGB16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208061"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208060"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Palette' PixelRGB16 -&gt; Either String PalettedImage)
-&gt; Palette' PixelRGB16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16 -&gt; Palette' PixelRGB16
</span><a href="Codec.Picture.Tiff.html#palette16Of"><span class="hs-identifier hs-var">palette16Of</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16
</span><a href="#local-6989586621679208056"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-688"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208058"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208057"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat] -&gt; [TiffSampleFormat] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-689"></span><span>      </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Palette' PixelRGB16 -&gt; PalettedImage)
-&gt; Palette' PixelRGB16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word8 -&gt; Palette' PixelRGB16 -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#PalettedRGB16"><span class="hs-identifier hs-var">PalettedRGB16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pack4 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack4
</span><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-var">Pack4</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208061"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208060"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Palette' PixelRGB16 -&gt; Either String PalettedImage)
-&gt; Palette' PixelRGB16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16 -&gt; Palette' PixelRGB16
</span><a href="Codec.Picture.Tiff.html#palette16Of"><span class="hs-identifier hs-var">palette16Of</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16
</span><a href="#local-6989586621679208056"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208058"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208057"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat] -&gt; [TiffSampleFormat] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-691"></span><span>      </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Palette' PixelRGB16 -&gt; PalettedImage)
-&gt; Palette' PixelRGB16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word8 -&gt; Palette' PixelRGB16 -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#PalettedRGB16"><span class="hs-identifier hs-var">PalettedRGB16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pack2 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack2
</span><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-var">Pack2</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208061"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208060"><span class="hs-identifier hs-var">nfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Palette' PixelRGB16 -&gt; Either String PalettedImage)
-&gt; Palette' PixelRGB16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16 -&gt; Palette' PixelRGB16
</span><a href="Codec.Picture.Tiff.html#palette16Of"><span class="hs-identifier hs-var">palette16Of</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16
</span><a href="#local-6989586621679208056"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span id="local-6989586621679208052"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679208052"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679208051"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208051"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCMYK"><span class="hs-identifier hs-var">TiffCMYK</span></a></span><span>
</span><span id="line-694"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffBitsPerSample :: TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208049"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208049"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-695"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleFormat :: TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var">tiffSampleFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208048"><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208048"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208049"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208048"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-697"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelCMYK8 -&gt; PalettedImage)
-&gt; Image PixelCMYK8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelCMYK8 -&gt; DynamicImage)
-&gt; Image PixelCMYK8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelCMYK8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageCMYK8"><span class="hs-identifier hs-var">ImageCMYK8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelCMYK8 -&gt; Either String PalettedImage)
-&gt; Image PixelCMYK8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelCMYK8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208052"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208051"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208049"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208048"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-700"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelCMYK16 -&gt; PalettedImage)
-&gt; Image PixelCMYK16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelCMYK16 -&gt; DynamicImage)
-&gt; Image PixelCMYK16
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelCMYK16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageCMYK16"><span class="hs-identifier hs-var">ImageCMYK16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelCMYK16 -&gt; Either String PalettedImage)
-&gt; Image PixelCMYK16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelCMYK16
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208052"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208051"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span id="local-6989586621679208043"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679208043"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679208042"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208042"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochromeWhite0"><span class="hs-identifier hs-var">TiffMonochromeWhite0</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-703"></span><span>    </span><span id="local-6989586621679208040"><span class="annot"><span class="annottext">PalettedImage
</span><a href="#local-6989586621679208040"><span class="hs-identifier hs-var">img</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; TiffInfo -&gt; Either String PalettedImage
</span><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208043"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208042"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PalettedImage
</span><a href="#local-6989586621679208040"><span class="hs-identifier hs-var">img</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-705"></span><span>      </span><span class="annot"><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-type">TrueColorImage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#ImageY8"><span class="hs-identifier hs-type">ImageY8</span></a></span><span> </span><span id="local-6989586621679208037"><span class="annot"><span class="annottext">i :: Image Word8
</span><a href="#local-6989586621679208037"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image Word8 -&gt; PalettedImage)
-&gt; Image Word8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image Word8 -&gt; DynamicImage) -&gt; Image Word8 -&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY8"><span class="hs-identifier hs-var">ImageY8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word8 -&gt; Either String PalettedImage)
-&gt; Image Word8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8) -&gt; Image Word8 -&gt; Image Word8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Image Word8
</span><a href="#local-6989586621679208037"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-706"></span><span>      </span><span class="annot"><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-type">TrueColorImage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#ImageY16"><span class="hs-identifier hs-type">ImageY16</span></a></span><span> </span><span id="local-6989586621679208033"><span class="annot"><span class="annottext">i :: Image Word16
</span><a href="#local-6989586621679208033"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image Word16 -&gt; PalettedImage)
-&gt; Image Word16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image Word16 -&gt; DynamicImage) -&gt; Image Word16 -&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY16"><span class="hs-identifier hs-var">ImageY16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word16 -&gt; Either String PalettedImage)
-&gt; Image Word16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Word16) -&gt; Image Word16 -&gt; Image Word16
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Image Word16
</span><a href="#local-6989586621679208033"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-707"></span><span>      </span><span class="annot"><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-type">TrueColorImage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#ImageYA8"><span class="hs-identifier hs-type">ImageYA8</span></a></span><span> </span><span id="local-6989586621679208031"><span class="annot"><span class="annottext">i :: Image PixelYA8
</span><a href="#local-6989586621679208031"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208030"><span class="annot"><span class="annottext">negative :: PixelYA8 -&gt; PixelYA8
</span><a href="#local-6989586621679208030"><span class="hs-identifier hs-var hs-var">negative</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#PixelYA8"><span class="hs-identifier hs-type">PixelYA8</span></a></span><span> </span><span id="local-6989586621679208028"><span class="annot"><span class="annottext">y :: Word8
</span><a href="#local-6989586621679208028"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679208027"><span class="annot"><span class="annottext">a :: Word8
</span><a href="#local-6989586621679208027"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; PixelYA8
</span><a href="Codec.Picture.Types.html#PixelYA8"><span class="hs-identifier hs-var">PixelYA8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208028"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679208027"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-708"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYA8 -&gt; PalettedImage)
-&gt; Image PixelYA8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYA8 -&gt; DynamicImage)
-&gt; Image PixelYA8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYA8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYA8"><span class="hs-identifier hs-var">ImageYA8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYA8 -&gt; Either String PalettedImage)
-&gt; Image PixelYA8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PixelYA8 -&gt; PixelYA8) -&gt; Image PixelYA8 -&gt; Image PixelYA8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="annot"><span class="annottext">PixelYA8 -&gt; PixelYA8
</span><a href="#local-6989586621679208030"><span class="hs-identifier hs-var">negative</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelYA8
</span><a href="#local-6989586621679208031"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-709"></span><span>      </span><span class="annot"><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-type">TrueColorImage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#ImageYA16"><span class="hs-identifier hs-type">ImageYA16</span></a></span><span> </span><span id="local-6989586621679208025"><span class="annot"><span class="annottext">i :: Image PixelYA16
</span><a href="#local-6989586621679208025"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208024"><span class="annot"><span class="annottext">negative :: PixelYA16 -&gt; PixelYA16
</span><a href="#local-6989586621679208024"><span class="hs-identifier hs-var hs-var">negative</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#PixelYA16"><span class="hs-identifier hs-type">PixelYA16</span></a></span><span> </span><span id="local-6989586621679208022"><span class="annot"><span class="annottext">y :: Word16
</span><a href="#local-6989586621679208022"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679208021"><span class="annot"><span class="annottext">a :: Word16
</span><a href="#local-6989586621679208021"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; PixelYA16
</span><a href="Codec.Picture.Types.html#PixelYA16"><span class="hs-identifier hs-var">PixelYA16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208022"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679208021"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-710"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYA16 -&gt; PalettedImage)
-&gt; Image PixelYA16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYA16 -&gt; DynamicImage)
-&gt; Image PixelYA16
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYA16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYA16"><span class="hs-identifier hs-var">ImageYA16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYA16 -&gt; Either String PalettedImage)
-&gt; Image PixelYA16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PixelYA16 -&gt; PixelYA16) -&gt; Image PixelYA16 -&gt; Image PixelYA16
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="annot"><span class="annottext">PixelYA16 -&gt; PixelYA16
</span><a href="#local-6989586621679208024"><span class="hs-identifier hs-var">negative</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelYA16
</span><a href="#local-6989586621679208025"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-711"></span><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String PalettedImage
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unsupported color type used with colorspace MonochromeWhite0&quot;</span></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span id="local-6989586621679208020"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679208019"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-714"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffBitsPerSample :: TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208018"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-715"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleFormat :: TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var">tiffSampleFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208017"><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-717"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image Word8 -&gt; PalettedImage)
-&gt; Image Word8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image Word8 -&gt; DynamicImage) -&gt; Image Word8 -&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY8"><span class="hs-identifier hs-var">ImageY8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word8 -&gt; DynamicImage)
-&gt; (Image Word8 -&gt; Image Word8) -&gt; Image Word8 -&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8) -&gt; Image Word8 -&gt; Image Word8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent Word8 -&gt; PixelBaseComponent Word8)
-&gt; Word8 -&gt; Word8
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0x55</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image Word8 -&gt; Either String PalettedImage)
-&gt; Image Word8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack2 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack2
</span><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-var">Pack2</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-719"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image Word8 -&gt; PalettedImage)
-&gt; Image Word8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image Word8 -&gt; DynamicImage) -&gt; Image Word8 -&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY8"><span class="hs-identifier hs-var">ImageY8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word8 -&gt; DynamicImage)
-&gt; (Image Word8 -&gt; Image Word8) -&gt; Image Word8 -&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8) -&gt; Image Word8 -&gt; Image Word8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent Word8 -&gt; PixelBaseComponent Word8)
-&gt; Word8 -&gt; Word8
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0x11</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image Word8 -&gt; Either String PalettedImage)
-&gt; Image Word8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack4 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack4
</span><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-var">Pack4</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-721"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image Word8 -&gt; PalettedImage)
-&gt; Image Word8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image Word8 -&gt; DynamicImage) -&gt; Image Word8 -&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY8"><span class="hs-identifier hs-var">ImageY8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word8 -&gt; Either String PalettedImage)
-&gt; Image Word8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">12</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-723"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image Word16 -&gt; PalettedImage)
-&gt; Image Word16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image Word16 -&gt; DynamicImage) -&gt; Image Word16 -&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY16"><span class="hs-identifier hs-var">ImageY16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word16 -&gt; DynamicImage)
-&gt; (Image Word16 -&gt; Image Word16) -&gt; Image Word16 -&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Word16) -&gt; Image Word16 -&gt; Image Word16
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent Word16 -&gt; PixelBaseComponent Word16)
-&gt; Word16 -&gt; Word16
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="annot"><span class="annottext">PixelBaseComponent Word16 -&gt; PixelBaseComponent Word16
forall a. (Num a, Bits a) =&gt; a -&gt; a
</span><a href="#local-6989586621679208015"><span class="hs-identifier hs-var">expand12to16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image Word16 -&gt; Either String PalettedImage)
-&gt; Image Word16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack12 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word16
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack12
</span><a href="Codec.Picture.Tiff.html#Pack12"><span class="hs-identifier hs-var">Pack12</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-724"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-725"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image Word16 -&gt; PalettedImage)
-&gt; Image Word16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image Word16 -&gt; DynamicImage) -&gt; Image Word16 -&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image Word16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY16"><span class="hs-identifier hs-var">ImageY16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word16 -&gt; Either String PalettedImage)
-&gt; Image Word16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word16
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-727"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208014"><span class="annot"><span class="annottext">img :: Image Word32
</span><a href="#local-6989586621679208014"><span class="hs-identifier hs-var hs-var">img</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; ByteString -&gt; TiffInfo -&gt; Image Word32
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Pixel32"><span class="hs-identifier hs-type">Pixel32</span></a></span><span>
</span><span id="line-728"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; PalettedImage -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage) -&gt; DynamicImage -&gt; PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image Word32 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageY32"><span class="hs-identifier hs-var">ImageY32</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Word32 -&gt; DynamicImage) -&gt; Image Word32 -&gt; DynamicImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image Word32
</span><a href="#local-6989586621679208014"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFloat"><span class="hs-identifier hs-var">TiffSampleFloat</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-730"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208010"><span class="annot"><span class="annottext">img :: Image Float
</span><a href="#local-6989586621679208010"><span class="hs-identifier hs-var hs-var">img</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; ByteString -&gt; TiffInfo -&gt; Image Float
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelF"><span class="hs-identifier hs-type">PixelF</span></a></span><span>
</span><span id="line-731"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; PalettedImage -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage) -&gt; DynamicImage -&gt; PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image Float -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYF"><span class="hs-identifier hs-var">ImageYF</span></a></span><span> </span><span class="annot"><span class="annottext">(Image Float -&gt; DynamicImage) -&gt; Image Float -&gt; DynamicImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image Float
</span><a href="#local-6989586621679208010"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-732"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String PalettedImage
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Failure to unpack TIFF file, 64-bit samples unsupported.&quot;</span></span><span>
</span><span id="line-733"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-734"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYA8 -&gt; PalettedImage)
-&gt; Image PixelYA8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYA8 -&gt; DynamicImage)
-&gt; Image PixelYA8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYA8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYA8"><span class="hs-identifier hs-var">ImageYA8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYA8 -&gt; DynamicImage)
-&gt; (Image PixelYA8 -&gt; Image PixelYA8)
-&gt; Image PixelYA8
-&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PixelYA8 -&gt; PixelYA8) -&gt; Image PixelYA8 -&gt; Image PixelYA8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent PixelYA8 -&gt; PixelBaseComponent PixelYA8)
-&gt; PixelYA8 -&gt; PixelYA8
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0x55</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image PixelYA8 -&gt; Either String PalettedImage)
-&gt; Image PixelYA8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack2 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelYA8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack2
</span><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-var">Pack2</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-736"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYA8 -&gt; PalettedImage)
-&gt; Image PixelYA8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYA8 -&gt; DynamicImage)
-&gt; Image PixelYA8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYA8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYA8"><span class="hs-identifier hs-var">ImageYA8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYA8 -&gt; DynamicImage)
-&gt; (Image PixelYA8 -&gt; Image PixelYA8)
-&gt; Image PixelYA8
-&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PixelYA8 -&gt; PixelYA8) -&gt; Image PixelYA8 -&gt; Image PixelYA8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent PixelYA8 -&gt; PixelBaseComponent PixelYA8)
-&gt; PixelYA8 -&gt; PixelYA8
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0x11</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image PixelYA8 -&gt; Either String PalettedImage)
-&gt; Image PixelYA8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack4 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelYA8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack4
</span><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-var">Pack4</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-738"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYA8 -&gt; PalettedImage)
-&gt; Image PixelYA8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYA8 -&gt; DynamicImage)
-&gt; Image PixelYA8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYA8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYA8"><span class="hs-identifier hs-var">ImageYA8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYA8 -&gt; Either String PalettedImage)
-&gt; Image PixelYA8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelYA8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">12</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">12</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-740"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYA16 -&gt; PalettedImage)
-&gt; Image PixelYA16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYA16 -&gt; DynamicImage)
-&gt; Image PixelYA16
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYA16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYA16"><span class="hs-identifier hs-var">ImageYA16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYA16 -&gt; DynamicImage)
-&gt; (Image PixelYA16 -&gt; Image PixelYA16)
-&gt; Image PixelYA16
-&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PixelYA16 -&gt; PixelYA16) -&gt; Image PixelYA16 -&gt; Image PixelYA16
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent PixelYA16 -&gt; PixelBaseComponent PixelYA16)
-&gt; PixelYA16 -&gt; PixelYA16
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="annot"><span class="annottext">PixelBaseComponent PixelYA16 -&gt; PixelBaseComponent PixelYA16
forall a. (Num a, Bits a) =&gt; a -&gt; a
</span><a href="#local-6989586621679208015"><span class="hs-identifier hs-var">expand12to16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image PixelYA16 -&gt; Either String PalettedImage)
-&gt; Image PixelYA16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack12 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelYA16
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack12
</span><a href="Codec.Picture.Tiff.html#Pack12"><span class="hs-identifier hs-var">Pack12</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-741"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208018"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-742"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYA16 -&gt; PalettedImage)
-&gt; Image PixelYA16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYA16 -&gt; DynamicImage)
-&gt; Image PixelYA16
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYA16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYA16"><span class="hs-identifier hs-var">ImageYA16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYA16 -&gt; Either String PalettedImage)
-&gt; Image PixelYA16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelYA16
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208020"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208019"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-743"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-744"></span><span>      </span><span id="local-6989586621679208015"><span class="annot"><span class="annottext">expand12to16 :: a -&gt; a
</span><a href="#local-6989586621679208015"><span class="hs-identifier hs-var hs-var">expand12to16</span></a></span></span><span> </span><span id="local-6989586621679208007"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679208007"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679208007"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679208007"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">12</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span id="local-6989586621679208006"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679208006"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679208005"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffYCbCr"><span class="hs-identifier hs-var">TiffYCbCr</span></a></span><span>
</span><span id="line-747"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffBitsPerSample :: TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208003"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208003"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-748"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffPlaneConfiguration :: TiffInfo -&gt; TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.html#tiffPlaneConfiguration"><span class="hs-identifier hs-var">tiffPlaneConfiguration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigContig"><span class="hs-identifier hs-var">PlanarConfigContig</span></a></span><span>
</span><span id="line-749"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleFormat :: TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var">tiffSampleFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679208002"><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208002"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-750"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679208003"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679208002"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-751"></span><span>    </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelYCbCr8 -&gt; PalettedImage)
-&gt; Image PixelYCbCr8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelYCbCr8 -&gt; DynamicImage)
-&gt; Image PixelYCbCr8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelYCbCr8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageYCbCr8"><span class="hs-identifier hs-var">ImageYCbCr8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelYCbCr8 -&gt; Either String PalettedImage)
-&gt; Image PixelYCbCr8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelYCbCr8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">YCbCrSubsampling
</span><a href="#local-6989586621679208000"><span class="hs-identifier hs-var">cbcrConf</span></a></span><span>  </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679208006"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-752"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679207999"><span class="annot"><span class="annottext">defaulting :: p -&gt; p
</span><a href="#local-6989586621679207999"><span class="hs-identifier hs-var hs-var">defaulting</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-753"></span><span>            </span><span class="annot"><a href="#local-6989586621679207999"><span class="hs-identifier hs-var">defaulting</span></a></span><span> </span><span id="local-6989586621679207998"><span class="annot"><span class="annottext">n :: p
</span><a href="#local-6989586621679207998"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679207998"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span>            </span><span id="local-6989586621679207997"><span class="annot"><span class="annottext">w :: Word32
</span><a href="#local-6989586621679207997"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall p. (Eq p, Num p) =&gt; p -&gt; p
</span><a href="#local-6989586621679207999"><span class="hs-identifier hs-var">defaulting</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32) -&gt; Word32 -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffYCbCrSubsampling"><span class="hs-identifier hs-var hs-var">tiffYCbCrSubsampling</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int -&gt; Word32
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-756"></span><span>            </span><span id="local-6989586621679207995"><span class="annot"><span class="annottext">h :: Word32
</span><a href="#local-6989586621679207995"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall p. (Eq p, Num p) =&gt; p -&gt; p
</span><a href="#local-6989586621679207999"><span class="hs-identifier hs-var">defaulting</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32) -&gt; Word32 -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffYCbCrSubsampling"><span class="hs-identifier hs-var hs-var">tiffYCbCrSubsampling</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">nfo</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int -&gt; Word32
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-757"></span><span>            </span><span id="local-6989586621679208000"><span class="annot"><span class="annottext">cbcrConf :: YCbCrSubsampling
</span><a href="#local-6989586621679208000"><span class="hs-identifier hs-var hs-var">cbcrConf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">$WYCbCrSubsampling :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; YCbCrSubsampling
</span><a href="Codec.Picture.Tiff.html#%24WYCbCrSubsampling"><span class="hs-identifier hs-type hs-type">YCbCrSubsampling</span></a></span><span>
</span><span id="line-758"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ycbcrWidth :: Int
</span><a href="Codec.Picture.Tiff.html#ycbcrWidth"><span class="hs-identifier hs-var">ycbcrWidth</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207997"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-759"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ycbcrHeight :: Int
</span><a href="Codec.Picture.Tiff.html#ycbcrHeight"><span class="hs-identifier hs-var">ycbcrHeight</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207995"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-760"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ycbcrImageWidth :: Int
</span><a href="Codec.Picture.Tiff.html#ycbcrImageWidth"><span class="hs-identifier hs-var">ycbcrImageWidth</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int) -&gt; Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffWidth"><span class="hs-identifier hs-var hs-var">tiffWidth</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-761"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ycbcrStripHeight :: Int
</span><a href="Codec.Picture.Tiff.html#ycbcrStripHeight"><span class="hs-identifier hs-var">ycbcrStripHeight</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int) -&gt; Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Word32
</span><a href="Codec.Picture.Tiff.html#tiffRowPerStrip"><span class="hs-identifier hs-var hs-var">tiffRowPerStrip</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679208005"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-762"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span id="local-6989586621679207993"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679207993"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679207992"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679207992"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span><span>
</span><span id="line-765"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffBitsPerSample :: TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679207990"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-766"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleFormat :: TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var">tiffSampleFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679207989"><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-768"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelRGB8 -&gt; PalettedImage)
-&gt; Image PixelRGB8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelRGB8 -&gt; DynamicImage)
-&gt; Image PixelRGB8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageRGB8"><span class="hs-identifier hs-var">ImageRGB8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB8 -&gt; DynamicImage)
-&gt; (Image PixelRGB8 -&gt; Image PixelRGB8)
-&gt; Image PixelRGB8
-&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PixelRGB8 -&gt; PixelRGB8) -&gt; Image PixelRGB8 -&gt; Image PixelRGB8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent PixelRGB8 -&gt; PixelBaseComponent PixelRGB8)
-&gt; PixelRGB8 -&gt; PixelRGB8
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0x55</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB8 -&gt; Either String PalettedImage)
-&gt; Image PixelRGB8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack2 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelRGB8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack2
</span><a href="Codec.Picture.Tiff.html#Pack2"><span class="hs-identifier hs-var">Pack2</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207993"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207992"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-770"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelRGB8 -&gt; PalettedImage)
-&gt; Image PixelRGB8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelRGB8 -&gt; DynamicImage)
-&gt; Image PixelRGB8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageRGB8"><span class="hs-identifier hs-var">ImageRGB8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB8 -&gt; DynamicImage)
-&gt; (Image PixelRGB8 -&gt; Image PixelRGB8)
-&gt; Image PixelRGB8
-&gt; DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PixelRGB8 -&gt; PixelRGB8) -&gt; Image PixelRGB8 -&gt; Image PixelRGB8
forall a b. (Pixel a, Pixel b) =&gt; (a -&gt; b) -&gt; Image a -&gt; Image b
</span><a href="Codec.Picture.Types.html#pixelMap"><span class="hs-identifier hs-var">pixelMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PixelBaseComponent PixelRGB8 -&gt; PixelBaseComponent PixelRGB8)
-&gt; PixelRGB8 -&gt; PixelRGB8
forall a.
Pixel a =&gt;
(PixelBaseComponent a -&gt; PixelBaseComponent a) -&gt; a -&gt; a
</span><a href="Codec.Picture.Types.html#colorMap"><span class="hs-identifier hs-var">colorMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0x11</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB8 -&gt; Either String PalettedImage)
-&gt; Image PixelRGB8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pack4 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelRGB8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="annot"><span class="annottext">Pack4
</span><a href="Codec.Picture.Tiff.html#Pack4"><span class="hs-identifier hs-var">Pack4</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207993"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207992"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-771"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-772"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelRGB8 -&gt; PalettedImage)
-&gt; Image PixelRGB8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelRGB8 -&gt; DynamicImage)
-&gt; Image PixelRGB8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageRGB8"><span class="hs-identifier hs-var">ImageRGB8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB8 -&gt; Either String PalettedImage)
-&gt; Image PixelRGB8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelRGB8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207993"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207992"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-774"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelRGBA8 -&gt; PalettedImage)
-&gt; Image PixelRGBA8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelRGBA8 -&gt; DynamicImage)
-&gt; Image PixelRGBA8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageRGBA8"><span class="hs-identifier hs-var">ImageRGBA8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGBA8 -&gt; Either String PalettedImage)
-&gt; Image PixelRGBA8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelRGBA8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207993"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207992"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-776"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelRGB16 -&gt; PalettedImage)
-&gt; Image PixelRGB16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelRGB16 -&gt; DynamicImage)
-&gt; Image PixelRGB16
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageRGB16"><span class="hs-identifier hs-var">ImageRGB16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB16 -&gt; Either String PalettedImage)
-&gt; Image PixelRGB16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelRGB16
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207993"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207992"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-777"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207990"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207989"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelRGBA16 -&gt; PalettedImage)
-&gt; Image PixelRGBA16
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelRGBA16 -&gt; DynamicImage)
-&gt; Image PixelRGBA16
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA16 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageRGBA16"><span class="hs-identifier hs-var">ImageRGBA16</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGBA16 -&gt; Either String PalettedImage)
-&gt; Image PixelRGBA16 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelRGBA16
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207993"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207992"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-779"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span id="local-6989586621679207984"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679207984"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679207983"><span class="annot"><span class="annottext">nfo :: TiffInfo
</span><a href="#local-6989586621679207983"><span class="hs-identifier hs-var">nfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type">TiffInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffInfo -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-780"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffBitsPerSample :: TiffInfo -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var">tiffBitsPerSample</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679207982"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207982"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-781"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleFormat :: TiffInfo -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var">tiffSampleFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679207981"><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207981"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-comment">-- some files are a little bit borked...</span><span>
</span><span id="line-783"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679207982"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Vector Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Word32] -&gt; Vector Word32
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TiffSampleFormat -&gt; Bool) -&gt; [TiffSampleFormat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TiffSampleFormat]
</span><a href="#local-6989586621679207981"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-784"></span><span>        </span><span class="annot"><span class="annottext">PalettedImage -&gt; Either String PalettedImage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; Either String PalettedImage)
-&gt; (Image PixelRGB8 -&gt; PalettedImage)
-&gt; Image PixelRGB8
-&gt; Either String PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DynamicImage -&gt; PalettedImage
</span><a href="Codec.Picture.Types.html#TrueColorImage"><span class="hs-identifier hs-var">TrueColorImage</span></a></span><span> </span><span class="annot"><span class="annottext">(DynamicImage -&gt; PalettedImage)
-&gt; (Image PixelRGB8 -&gt; DynamicImage)
-&gt; Image PixelRGB8
-&gt; PalettedImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGB8 -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#ImageRGB8"><span class="hs-identifier hs-var">ImageRGB8</span></a></span><span> </span><span class="annot"><span class="annottext">(Image PixelRGB8 -&gt; Either String PalettedImage)
-&gt; Image PixelRGB8 -&gt; Either String PalettedImage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; TiffInfo -&gt; Image PixelRGB8
forall comp pixel.
(Unpackable comp, Pixel pixel,
 StorageType comp ~ PixelBaseComponent pixel) =&gt;
comp -&gt; ByteString -&gt; TiffInfo -&gt; Image pixel
</span><a href="Codec.Picture.Tiff.html#gatherStrips"><span class="hs-identifier hs-var">gatherStrips</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207984"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207983"><span class="hs-identifier hs-var">nfo</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="annot"><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String PalettedImage
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Failure to unpack TIFF file&quot;</span></span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="hs-comment">-- | Decode a tiff encoded image while preserving the underlying</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- pixel type (except for Y32 which is truncated to 16 bits).</span><span>
</span><span id="line-790"></span><span class="hs-comment">--</span><span>
</span><span id="line-791"></span><span class="hs-comment">-- This function can output the following images:</span><span>
</span><span id="line-792"></span><span class="hs-comment">--</span><span>
</span><span id="line-793"></span><span class="hs-comment">--  * 'ImageY8'</span><span>
</span><span id="line-794"></span><span class="hs-comment">--</span><span>
</span><span id="line-795"></span><span class="hs-comment">--  * 'ImageY16'</span><span>
</span><span id="line-796"></span><span class="hs-comment">--</span><span>
</span><span id="line-797"></span><span class="hs-comment">--  * 'ImageY32'</span><span>
</span><span id="line-798"></span><span class="hs-comment">--</span><span>
</span><span id="line-799"></span><span class="hs-comment">--  * 'ImageYF'</span><span>
</span><span id="line-800"></span><span class="hs-comment">--</span><span>
</span><span id="line-801"></span><span class="hs-comment">--  * 'ImageYA8'</span><span>
</span><span id="line-802"></span><span class="hs-comment">--</span><span>
</span><span id="line-803"></span><span class="hs-comment">--  * 'ImageYA16'</span><span>
</span><span id="line-804"></span><span class="hs-comment">--</span><span>
</span><span id="line-805"></span><span class="hs-comment">--  * 'ImageRGB8'</span><span>
</span><span id="line-806"></span><span class="hs-comment">--</span><span>
</span><span id="line-807"></span><span class="hs-comment">--  * 'ImageRGB16'</span><span>
</span><span id="line-808"></span><span class="hs-comment">--</span><span>
</span><span id="line-809"></span><span class="hs-comment">--  * 'ImageRGBA8'</span><span>
</span><span id="line-810"></span><span class="hs-comment">--</span><span>
</span><span id="line-811"></span><span class="hs-comment">--  * 'ImageRGBA16'</span><span>
</span><span id="line-812"></span><span class="hs-comment">--</span><span>
</span><span id="line-813"></span><span class="hs-comment">--  * 'ImageCMYK8'</span><span>
</span><span id="line-814"></span><span class="hs-comment">--</span><span>
</span><span id="line-815"></span><span class="hs-comment">--  * 'ImageCMYK16'</span><span>
</span><span id="line-816"></span><span class="hs-comment">--</span><span>
</span><span id="line-817"></span><span class="annot"><a href="Codec.Picture.Tiff.html#decodeTiff"><span class="hs-identifier hs-type">decodeTiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#DynamicImage"><span class="hs-identifier hs-type">DynamicImage</span></a></span><span>
</span><span id="line-818"></span><span id="decodeTiff"><span class="annot"><span class="annottext">decodeTiff :: ByteString -&gt; Either String DynamicImage
</span><a href="Codec.Picture.Tiff.html#decodeTiff"><span class="hs-identifier hs-var hs-var">decodeTiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DynamicImage, Metadatas) -&gt; DynamicImage)
-&gt; Either String (DynamicImage, Metadatas)
-&gt; Either String DynamicImage
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(DynamicImage, Metadatas) -&gt; DynamicImage
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Either String (DynamicImage, Metadatas)
 -&gt; Either String DynamicImage)
-&gt; (ByteString -&gt; Either String (DynamicImage, Metadatas))
-&gt; ByteString
-&gt; Either String DynamicImage
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String (DynamicImage, Metadatas)
</span><a href="Codec.Picture.Tiff.html#decodeTiffWithMetadata"><span class="hs-identifier hs-var">decodeTiffWithMetadata</span></a></span><span> </span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="hs-comment">-- | Like 'decodeTiff' but also provides some metdata present</span><span>
</span><span id="line-821"></span><span class="hs-comment">-- in the Tiff file.</span><span>
</span><span id="line-822"></span><span class="hs-comment">--</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- The metadata extracted are the 'Codec.Picture.Metadata.DpiX' &amp;</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- 'Codec.Picture.Metadata.DpiY' information alongside the EXIF informations.</span><span>
</span><span id="line-825"></span><span class="annot"><a href="Codec.Picture.Tiff.html#decodeTiffWithMetadata"><span class="hs-identifier hs-type">decodeTiffWithMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#DynamicImage"><span class="hs-identifier hs-type">DynamicImage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.html#Metadatas"><span class="hs-identifier hs-type">Metadatas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span id="decodeTiffWithMetadata"><span class="annot"><span class="annottext">decodeTiffWithMetadata :: ByteString -&gt; Either String (DynamicImage, Metadatas)
</span><a href="Codec.Picture.Tiff.html#decodeTiffWithMetadata"><span class="hs-identifier hs-var hs-var">decodeTiffWithMetadata</span></a></span></span><span> </span><span id="local-6989586621679207980"><span class="annot"><span class="annottext">str :: ByteString
</span><a href="#local-6989586621679207980"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; DynamicImage)
-&gt; (PalettedImage, Metadatas) -&gt; (DynamicImage, Metadatas)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">PalettedImage -&gt; DynamicImage
</span><a href="Codec.Picture.Types.html#palettedToTrueColor"><span class="hs-identifier hs-var">palettedToTrueColor</span></a></span><span> </span><span class="annot"><span class="annottext">((PalettedImage, Metadatas) -&gt; (DynamicImage, Metadatas))
-&gt; Either String (PalettedImage, Metadatas)
-&gt; Either String (DynamicImage, Metadatas)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String (PalettedImage, Metadatas)
</span><a href="Codec.Picture.Tiff.html#decodeTiffWithPaletteAndMetadata"><span class="hs-identifier hs-var">decodeTiffWithPaletteAndMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207980"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span class="hs-comment">-- | Decode TIFF and provide separated palette and metadata</span><span>
</span><span id="line-829"></span><span class="annot"><a href="Codec.Picture.Tiff.html#decodeTiffWithPaletteAndMetadata"><span class="hs-identifier hs-type">decodeTiffWithPaletteAndMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#PalettedImage"><span class="hs-identifier hs-type">PalettedImage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.html#Metadatas"><span class="hs-identifier hs-type">Metadatas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span id="decodeTiffWithPaletteAndMetadata"><span class="annot"><span class="annottext">decodeTiffWithPaletteAndMetadata :: ByteString -&gt; Either String (PalettedImage, Metadatas)
</span><a href="Codec.Picture.Tiff.html#decodeTiffWithPaletteAndMetadata"><span class="hs-identifier hs-var hs-var">decodeTiffWithPaletteAndMetadata</span></a></span></span><span> </span><span id="local-6989586621679207978"><span class="annot"><span class="annottext">file :: ByteString
</span><a href="#local-6989586621679207978"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get TiffInfo -&gt; ByteString -&gt; Either String TiffInfo
forall a. Get a -&gt; ByteString -&gt; Either String a
</span><a href="Codec.Picture.InternalHelper.html#runGetStrict"><span class="hs-identifier hs-var">runGetStrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Get TiffInfo
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207978"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207978"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">Either String TiffInfo
-&gt; (TiffInfo -&gt; Either String (PalettedImage, Metadatas))
-&gt; Either String (PalettedImage, Metadatas)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Either String (PalettedImage, Metadatas)
</span><a href="#local-6989586621679207976"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-831"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-832"></span><span>    </span><span id="local-6989586621679207976"><span class="annot"><span class="annottext">go :: TiffInfo -&gt; Either String (PalettedImage, Metadatas)
</span><a href="#local-6989586621679207976"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679207975"><span class="annot"><span class="annottext">tinfo :: TiffInfo
</span><a href="#local-6989586621679207975"><span class="hs-identifier hs-var">tinfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">TiffInfo -&gt; Metadatas
</span><a href="Codec.Picture.Tiff.html#tiffMetadatas"><span class="hs-identifier hs-var hs-var">tiffMetadatas</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207975"><span class="hs-identifier hs-var">tinfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PalettedImage -&gt; (PalettedImage, Metadatas))
-&gt; Either String PalettedImage
-&gt; Either String (PalettedImage, Metadatas)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; TiffInfo -&gt; Either String PalettedImage
</span><a href="Codec.Picture.Tiff.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207978"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207975"><span class="hs-identifier hs-var">tinfo</span></a></span><span>
</span><span id="line-833"></span><span>    </span><span>
</span><span id="line-834"></span><span>
</span><span id="line-835"></span><span class="hs-comment">-- | Class defining which pixel types can be serialized in a</span><span>
</span><span id="line-836"></span><span class="hs-comment">-- Tiff file.</span><span>
</span><span id="line-837"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Types.html#Pixel"><span class="hs-identifier hs-type">Pixel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208655"><span class="hs-identifier hs-type">px</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="TiffSaveable"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-var">TiffSaveable</span></a></span></span><span> </span><span id="local-6989586621679208655"><span class="annot"><a href="#local-6989586621679208655"><span class="hs-identifier hs-type">px</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-838"></span><span>  </span><span id="colorSpaceOfPixel"><span class="annot"><a href="Codec.Picture.Tiff.html#colorSpaceOfPixel"><span class="hs-identifier hs-type">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208655"><span class="hs-identifier hs-type">px</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffColorspace"><span class="hs-identifier hs-type">TiffColorspace</span></a></span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span>  </span><span id="extraSampleCodeOfPixel"><span class="annot"><a href="Codec.Picture.Tiff.html#extraSampleCodeOfPixel"><span class="hs-identifier hs-type">extraSampleCodeOfPixel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208655"><span class="hs-identifier hs-type">px</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSample"><span class="hs-identifier hs-type">ExtraSample</span></a></span><span>
</span><span id="line-841"></span><span>  </span><span id="local-6989586621679207972"><span class="annot"><a href="Codec.Picture.Tiff.html#extraSampleCodeOfPixel"><span class="hs-identifier hs-var hs-var">extraSampleCodeOfPixel</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ExtraSample
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span>  </span><span id="subSamplingInfo"><span class="annot"><a href="Codec.Picture.Tiff.html#subSamplingInfo"><span class="hs-identifier hs-type">subSamplingInfo</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208655"><span class="hs-identifier hs-type">px</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-844"></span><span>  </span><span id="local-6989586621679207970"><span class="annot"><a href="Codec.Picture.Tiff.html#subSamplingInfo"><span class="hs-identifier hs-var hs-var">subSamplingInfo</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Word32
forall a. Vector a
</span><span class="hs-identifier hs-var">V.empty</span></span></span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span>  </span><span id="sampleFormat"><span class="annot"><a href="Codec.Picture.Tiff.html#sampleFormat"><span class="hs-identifier hs-type">sampleFormat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208655"><span class="hs-identifier hs-type">px</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFormat"><span class="hs-identifier hs-type">TiffSampleFormat</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-847"></span><span>  </span><span id="local-6989586621679207967"><span class="annot"><a href="Codec.Picture.Tiff.html#sampleFormat"><span class="hs-identifier hs-var hs-var">sampleFormat</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-848"></span><span>
</span><span id="line-849"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207959"><span id="local-6989586621679207961"><span id="local-6989586621679207963"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Pixel8"><span class="hs-identifier hs-type">Pixel8</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-850"></span><span>  </span><span id="local-6989586621679207956"><span class="annot"><span class="annottext">colorSpaceOfPixel :: Word8 -&gt; TiffColorspace
</span><a href="#local-6989586621679207956"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207948"><span id="local-6989586621679207950"><span id="local-6989586621679207952"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Pixel16"><span class="hs-identifier hs-type">Pixel16</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-853"></span><span>  </span><span id="local-6989586621679207946"><span class="annot"><span class="annottext">colorSpaceOfPixel :: Word16 -&gt; TiffColorspace
</span><a href="#local-6989586621679207946"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207938"><span id="local-6989586621679207940"><span id="local-6989586621679207942"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Pixel32"><span class="hs-identifier hs-type">Pixel32</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-856"></span><span>  </span><span id="local-6989586621679207937"><span class="annot"><span class="annottext">colorSpaceOfPixel :: Word32 -&gt; TiffColorspace
</span><a href="#local-6989586621679207937"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207931"><span id="local-6989586621679207933"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelF"><span class="hs-identifier hs-type">PixelF</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-859"></span><span>  </span><span id="local-6989586621679207929"><span class="annot"><span class="annottext">colorSpaceOfPixel :: Float -&gt; TiffColorspace
</span><a href="#local-6989586621679207929"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-860"></span><span>  </span><span id="local-6989586621679207928"><span class="annot"><span class="annottext">sampleFormat :: Float -&gt; [TiffSampleFormat]
</span><a href="#local-6989586621679207928"><span class="hs-identifier hs-var hs-var hs-var hs-var">sampleFormat</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFloat"><span class="hs-identifier hs-var">TiffSampleFloat</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207921"><span id="local-6989586621679207923"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelYA8"><span class="hs-identifier hs-type">PixelYA8</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-863"></span><span>  </span><span id="local-6989586621679207920"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelYA8 -&gt; TiffColorspace
</span><a href="#local-6989586621679207920"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-864"></span><span>  </span><span id="local-6989586621679207919"><span class="annot"><span class="annottext">extraSampleCodeOfPixel :: PixelYA8 -&gt; Maybe ExtraSample
</span><a href="#local-6989586621679207919"><span class="hs-identifier hs-var hs-var hs-var hs-var">extraSampleCodeOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtraSample -&gt; Maybe ExtraSample
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnassociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleUnassociatedAlpha</span></a></span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207911"><span id="local-6989586621679207913"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelYA16"><span class="hs-identifier hs-type">PixelYA16</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-867"></span><span>  </span><span id="local-6989586621679207910"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelYA16 -&gt; TiffColorspace
</span><a href="#local-6989586621679207910"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-868"></span><span>  </span><span id="local-6989586621679207909"><span class="annot"><span class="annottext">extraSampleCodeOfPixel :: PixelYA16 -&gt; Maybe ExtraSample
</span><a href="#local-6989586621679207909"><span class="hs-identifier hs-var hs-var hs-var hs-var">extraSampleCodeOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtraSample -&gt; Maybe ExtraSample
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnassociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleUnassociatedAlpha</span></a></span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207901"><span id="local-6989586621679207903"><span id="local-6989586621679207905"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelCMYK8"><span class="hs-identifier hs-type">PixelCMYK8</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-871"></span><span>  </span><span id="local-6989586621679207900"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelCMYK8 -&gt; TiffColorspace
</span><a href="#local-6989586621679207900"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCMYK"><span class="hs-identifier hs-var">TiffCMYK</span></a></span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207892"><span id="local-6989586621679207894"><span id="local-6989586621679207896"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelCMYK16"><span class="hs-identifier hs-type">PixelCMYK16</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-874"></span><span>  </span><span id="local-6989586621679207891"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelCMYK16 -&gt; TiffColorspace
</span><a href="#local-6989586621679207891"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCMYK"><span class="hs-identifier hs-var">TiffCMYK</span></a></span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207883"><span id="local-6989586621679207885"><span id="local-6989586621679207887"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGB8"><span class="hs-identifier hs-type">PixelRGB8</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-877"></span><span>  </span><span id="local-6989586621679207882"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelRGB8 -&gt; TiffColorspace
</span><a href="#local-6989586621679207882"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207874"><span id="local-6989586621679207876"><span id="local-6989586621679207878"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGB16"><span class="hs-identifier hs-type">PixelRGB16</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-880"></span><span>  </span><span id="local-6989586621679207873"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelRGB16 -&gt; TiffColorspace
</span><a href="#local-6989586621679207873"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207866"><span id="local-6989586621679207868"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGBA8"><span class="hs-identifier hs-type">PixelRGBA8</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-883"></span><span>  </span><span id="local-6989586621679207865"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelRGBA8 -&gt; TiffColorspace
</span><a href="#local-6989586621679207865"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span><span>
</span><span id="line-884"></span><span>  </span><span id="local-6989586621679207864"><span class="annot"><span class="annottext">extraSampleCodeOfPixel :: PixelRGBA8 -&gt; Maybe ExtraSample
</span><a href="#local-6989586621679207864"><span class="hs-identifier hs-var hs-var hs-var hs-var">extraSampleCodeOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtraSample -&gt; Maybe ExtraSample
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnassociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleUnassociatedAlpha</span></a></span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207857"><span id="local-6989586621679207859"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelRGBA16"><span class="hs-identifier hs-type">PixelRGBA16</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-887"></span><span>  </span><span id="local-6989586621679207856"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelRGBA16 -&gt; TiffColorspace
</span><a href="#local-6989586621679207856"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span><span>
</span><span id="line-888"></span><span>  </span><span id="local-6989586621679207855"><span class="annot"><span class="annottext">extraSampleCodeOfPixel :: PixelRGBA16 -&gt; Maybe ExtraSample
</span><a href="#local-6989586621679207855"><span class="hs-identifier hs-var hs-var hs-var hs-var">extraSampleCodeOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtraSample -&gt; Maybe ExtraSample
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnassociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleUnassociatedAlpha</span></a></span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679207848"><span id="local-6989586621679207851"><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelYCbCr8"><span class="hs-identifier hs-type">PixelYCbCr8</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-891"></span><span>  </span><span id="local-6989586621679207847"><span class="annot"><span class="annottext">colorSpaceOfPixel :: PixelYCbCr8 -&gt; TiffColorspace
</span><a href="#local-6989586621679207847"><span class="hs-identifier hs-var hs-var hs-var hs-var">colorSpaceOfPixel</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffYCbCr"><span class="hs-identifier hs-var">TiffYCbCr</span></a></span><span>
</span><span id="line-892"></span><span>  </span><span id="local-6989586621679207846"><span class="annot"><span class="annottext">subSamplingInfo :: PixelYCbCr8 -&gt; Vector Word32
</span><a href="#local-6989586621679207846"><span class="hs-identifier hs-var hs-var hs-var hs-var">subSamplingInfo</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word32] -&gt; Vector Word32
forall a. Int -&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromListN</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="hs-comment">-- | Transform an image into a Tiff encoded bytestring, ready to be</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- written as a file.</span><span>
</span><span id="line-896"></span><span class="annot"><a href="Codec.Picture.Tiff.html#encodeTiff"><span class="hs-identifier hs-type">encodeTiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679208645"><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lb.ByteString</span></span><span>
</span><span id="line-897"></span><span id="encodeTiff"><span class="annot"><span class="annottext">encodeTiff :: Image px -&gt; ByteString
</span><a href="Codec.Picture.Tiff.html#encodeTiff"><span class="hs-identifier hs-var hs-var">encodeTiff</span></a></span></span><span> </span><span id="local-6989586621679207844"><span class="annot"><span class="annottext">img :: Image px
</span><a href="#local-6989586621679207844"><span class="hs-identifier hs-var">img</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; TiffInfo -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679207843"><span class="hs-identifier hs-var">rawPixelData</span></a></span><span> </span><span class="annot"><span class="annottext">TiffInfo
</span><a href="#local-6989586621679207842"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679207841"><span class="annot"><span class="annottext">intSampleCount :: Int
</span><a href="#local-6989586621679207841"><span class="hs-identifier hs-var hs-var">intSampleCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">px -&gt; Int
forall a. Pixel a =&gt; a -&gt; Int
</span><a href="Codec.Picture.Types.html#componentCount"><span class="hs-identifier hs-var">componentCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">px
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>        </span><span id="local-6989586621679207839"><span class="annot"><span class="annottext">sampleCount :: Word32
</span><a href="#local-6989586621679207839"><span class="hs-identifier hs-var hs-var">sampleCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207841"><span class="hs-identifier hs-var">intSampleCount</span></a></span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span>        </span><span id="local-6989586621679207838"><span class="annot"><span class="annottext">sampleType :: PixelBaseComponent px
</span><a href="#local-6989586621679207838"><span class="hs-identifier hs-var hs-var">sampleType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PixelBaseComponent px
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#PixelBaseComponent"><span class="hs-identifier hs-type">PixelBaseComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span>
</span><span id="line-902"></span><span>        </span><span id="local-6989586621679207837"><span class="annot"><span class="annottext">pixelData :: Vector (PixelBaseComponent px)
</span><a href="#local-6989586621679207837"><span class="hs-identifier hs-var hs-var">pixelData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image px -&gt; Vector (PixelBaseComponent px)
forall a. Image a -&gt; Vector (PixelBaseComponent a)
</span><a href="Codec.Picture.Types.html#imageData"><span class="hs-identifier hs-var hs-var">imageData</span></a></span><span> </span><span class="annot"><span class="annottext">Image px
</span><a href="#local-6989586621679207844"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span>        </span><span id="local-6989586621679207843"><span class="annot"><span class="annottext">rawPixelData :: ByteString
</span><a href="#local-6989586621679207843"><span class="hs-identifier hs-var hs-var">rawPixelData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (PixelBaseComponent px) -&gt; ByteString
forall a. Storable a =&gt; Vector a -&gt; ByteString
</span><a href="Codec.Picture.VectorByteConversion.html#toByteString"><span class="hs-identifier hs-var">toByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (PixelBaseComponent px)
</span><a href="#local-6989586621679207837"><span class="hs-identifier hs-var">pixelData</span></a></span><span>
</span><span id="line-905"></span><span>        </span><span id="local-6989586621679207836"><span class="annot"><span class="annottext">width :: Word32
</span><a href="#local-6989586621679207836"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image px -&gt; Int
forall a. Image a -&gt; Int
</span><a href="Codec.Picture.Types.html#imageWidth"><span class="hs-identifier hs-var hs-var">imageWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Image px
</span><a href="#local-6989586621679207844"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-906"></span><span>        </span><span id="local-6989586621679207835"><span class="annot"><span class="annottext">height :: Word32
</span><a href="#local-6989586621679207835"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image px -&gt; Int
forall a. Image a -&gt; Int
</span><a href="Codec.Picture.Types.html#imageHeight"><span class="hs-identifier hs-var hs-var">imageHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Image px
</span><a href="#local-6989586621679207844"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-907"></span><span>        </span><span id="local-6989586621679207833"><span class="annot"><span class="annottext">intSampleSize :: Int
</span><a href="#local-6989586621679207833"><span class="hs-identifier hs-var hs-var">intSampleSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PixelBaseComponent px -&gt; Int
forall a. Storable a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">sizeOf</span></span><span> </span><span class="annot"><span class="annottext">PixelBaseComponent px
</span><a href="#local-6989586621679207838"><span class="hs-identifier hs-var">sampleType</span></a></span><span>
</span><span id="line-908"></span><span>        </span><span id="local-6989586621679207832"><span class="annot"><span class="annottext">sampleSize :: Word32
</span><a href="#local-6989586621679207832"><span class="hs-identifier hs-var hs-var">sampleSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207833"><span class="hs-identifier hs-var">intSampleSize</span></a></span><span>
</span><span id="line-909"></span><span>        </span><span id="local-6989586621679207831"><span class="annot"><span class="annottext">bitPerSample :: Word32
</span><a href="#local-6989586621679207831"><span class="hs-identifier hs-var hs-var">bitPerSample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207832"><span class="hs-identifier hs-var">sampleSize</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-910"></span><span>        </span><span id="local-6989586621679207830"><span class="annot"><span class="annottext">imageSize :: Word32
</span><a href="#local-6989586621679207830"><span class="hs-identifier hs-var hs-var">imageSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207836"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207835"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207839"><span class="hs-identifier hs-var">sampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207832"><span class="hs-identifier hs-var">sampleSize</span></a></span><span>
</span><span id="line-911"></span><span>        </span><span id="local-6989586621679207829"><span class="annot"><span class="annottext">headerSize :: Word32
</span><a href="#local-6989586621679207829"><span class="hs-identifier hs-var hs-var">headerSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span>        </span><span id="local-6989586621679207842"><span class="annot"><span class="annottext">hdr :: TiffInfo
</span><a href="#local-6989586621679207842"><span class="hs-identifier hs-var hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffInfo :: TiffHeader
-&gt; Word32
-&gt; Word32
-&gt; TiffColorspace
-&gt; Word32
-&gt; Word32
-&gt; TiffPlanarConfiguration
-&gt; [TiffSampleFormat]
-&gt; Vector Word32
-&gt; TiffCompression
-&gt; Vector Word32
-&gt; Vector Word32
-&gt; Maybe (Image PixelRGB16)
-&gt; Vector Word32
-&gt; Maybe ExtraSample
-&gt; Predictor
-&gt; Metadatas
-&gt; TiffInfo
</span><a href="Codec.Picture.Tiff.html#TiffInfo"><span class="hs-identifier hs-type hs-type">TiffInfo</span></a></span><span>
</span><span id="line-914"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiffHeader :: TiffHeader
</span><a href="Codec.Picture.Tiff.html#tiffHeader"><span class="hs-identifier hs-var">tiffHeader</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">$WTiffHeader :: Endianness -&gt; Word32 -&gt; TiffHeader
</span><a href="Codec.Picture.Tiff.Internal.Types.html#%24WTiffHeader"><span class="hs-identifier hs-type hs-type">TiffHeader</span></a></span><span>
</span><span id="line-915"></span><span>                                            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hdrEndianness :: Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrEndianness"><span class="hs-identifier hs-var">hdrEndianness</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span>
</span><span id="line-916"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hdrOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrOffset"><span class="hs-identifier hs-var">hdrOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207829"><span class="hs-identifier hs-var">headerSize</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207830"><span class="hs-identifier hs-var">imageSize</span></a></span><span>
</span><span id="line-917"></span><span>                                            </span><span class="hs-special">}</span><span>
</span><span id="line-918"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffWidth :: Word32
</span><a href="Codec.Picture.Tiff.html#tiffWidth"><span class="hs-identifier hs-var">tiffWidth</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207836"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-919"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffHeight :: Word32
</span><a href="Codec.Picture.Tiff.html#tiffHeight"><span class="hs-identifier hs-var">tiffHeight</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207835"><span class="hs-identifier hs-var">height</span></a></span><span>
</span><span id="line-920"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffColorspace :: TiffColorspace
</span><a href="Codec.Picture.Tiff.html#tiffColorspace"><span class="hs-identifier hs-var">tiffColorspace</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">px -&gt; TiffColorspace
forall px. TiffSaveable px =&gt; px -&gt; TiffColorspace
</span><a href="Codec.Picture.Tiff.html#colorSpaceOfPixel"><span class="hs-identifier hs-var">colorSpaceOfPixel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">px
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleCount :: Word32
</span><a href="Codec.Picture.Tiff.html#tiffSampleCount"><span class="hs-identifier hs-var">tiffSampleCount</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207839"><span class="hs-identifier hs-var">sampleCount</span></a></span><span>
</span><span id="line-922"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffRowPerStrip :: Word32
</span><a href="Codec.Picture.Tiff.html#tiffRowPerStrip"><span class="hs-identifier hs-var">tiffRowPerStrip</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image px -&gt; Int
forall a. Image a -&gt; Int
</span><a href="Codec.Picture.Types.html#imageHeight"><span class="hs-identifier hs-var hs-var">imageHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Image px
</span><a href="#local-6989586621679207844"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-923"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffPlaneConfiguration :: TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.html#tiffPlaneConfiguration"><span class="hs-identifier hs-var">tiffPlaneConfiguration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigContig"><span class="hs-identifier hs-var">PlanarConfigContig</span></a></span><span>
</span><span id="line-924"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffSampleFormat :: [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#tiffSampleFormat"><span class="hs-identifier hs-var">tiffSampleFormat</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">px -&gt; [TiffSampleFormat]
forall px. TiffSaveable px =&gt; px -&gt; [TiffSampleFormat]
</span><a href="Codec.Picture.Tiff.html#sampleFormat"><span class="hs-identifier hs-var">sampleFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">px
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffBitsPerSample :: Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffBitsPerSample"><span class="hs-identifier hs-var">tiffBitsPerSample</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32 -&gt; Vector Word32
forall a. Int -&gt; a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679207841"><span class="hs-identifier hs-var">intSampleCount</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207831"><span class="hs-identifier hs-var">bitPerSample</span></a></span><span>
</span><span id="line-926"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffCompression :: TiffCompression
</span><a href="Codec.Picture.Tiff.html#tiffCompression"><span class="hs-identifier hs-var">tiffCompression</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionNone"><span class="hs-identifier hs-var">CompressionNone</span></a></span><span>
</span><span id="line-927"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffStripSize :: Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffStripSize"><span class="hs-identifier hs-var">tiffStripSize</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207830"><span class="hs-identifier hs-var">imageSize</span></a></span><span>
</span><span id="line-928"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffOffsets :: Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffOffsets"><span class="hs-identifier hs-var">tiffOffsets</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Vector Word32
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679207829"><span class="hs-identifier hs-var">headerSize</span></a></span><span>
</span><span id="line-929"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffPalette :: Maybe (Image PixelRGB16)
</span><a href="Codec.Picture.Tiff.html#tiffPalette"><span class="hs-identifier hs-var">tiffPalette</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Image PixelRGB16)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-930"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffYCbCrSubsampling :: Vector Word32
</span><a href="Codec.Picture.Tiff.html#tiffYCbCrSubsampling"><span class="hs-identifier hs-var">tiffYCbCrSubsampling</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">px -&gt; Vector Word32
forall px. TiffSaveable px =&gt; px -&gt; Vector Word32
</span><a href="Codec.Picture.Tiff.html#subSamplingInfo"><span class="hs-identifier hs-var">subSamplingInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">px
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffExtraSample :: Maybe ExtraSample
</span><a href="Codec.Picture.Tiff.html#tiffExtraSample"><span class="hs-identifier hs-var">tiffExtraSample</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">px -&gt; Maybe ExtraSample
forall px. TiffSaveable px =&gt; px -&gt; Maybe ExtraSample
</span><a href="Codec.Picture.Tiff.html#extraSampleCodeOfPixel"><span class="hs-identifier hs-var">extraSampleCodeOfPixel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">px
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679208645"><span class="hs-identifier hs-type">px</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffPredictor :: Predictor
</span><a href="Codec.Picture.Tiff.html#tiffPredictor"><span class="hs-identifier hs-var">tiffPredictor</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predictor
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PredictorNone"><span class="hs-identifier hs-var">PredictorNone</span></a></span><span> </span><span class="hs-comment">-- not used when writing</span><span>
</span><span id="line-933"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiffMetadatas :: Metadatas
</span><a href="Codec.Picture.Tiff.html#tiffMetadatas"><span class="hs-identifier hs-var">tiffMetadatas</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Metadatas
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-934"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span class="hs-comment">-- | Helper function to directly write an image as a tiff on disk.</span><span>
</span><span id="line-937"></span><span id="local-6989586621679207822"><span class="annot"><a href="Codec.Picture.Tiff.html#writeTiff"><span class="hs-identifier hs-type">writeTiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.html#TiffSaveable"><span class="hs-identifier hs-type">TiffSaveable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679207822"><span class="hs-identifier hs-type">pixel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Types.html#Image"><span class="hs-identifier hs-type">Image</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679207822"><span class="hs-identifier hs-type">pixel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-938"></span><span id="writeTiff"><span class="annot"><span class="annottext">writeTiff :: String -&gt; Image pixel -&gt; IO ()
</span><a href="Codec.Picture.Tiff.html#writeTiff"><span class="hs-identifier hs-var hs-var">writeTiff</span></a></span></span><span> </span><span id="local-6989586621679207820"><span class="annot"><span class="annottext">path :: String
</span><a href="#local-6989586621679207820"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679207819"><span class="annot"><span class="annottext">img :: Image pixel
</span><a href="#local-6989586621679207819"><span class="hs-identifier hs-var">img</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">Lb.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679207820"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; ByteString -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Image pixel -&gt; ByteString
forall px. TiffSaveable px =&gt; Image px -&gt; ByteString
</span><a href="Codec.Picture.Tiff.html#encodeTiff"><span class="hs-identifier hs-var">encodeTiff</span></a></span><span> </span><span class="annot"><span class="annottext">Image pixel
</span><a href="#local-6989586621679207819"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="hs-pragma">{-# ANN</span><span> </span><span class="hs-pragma">module</span><span> </span><span class="annot"><span class="hs-pragma">&quot;HLint: ignore Reduce duplication&quot;</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-941"></span><span>
</span><span id="line-942"></span></pre></body></html>